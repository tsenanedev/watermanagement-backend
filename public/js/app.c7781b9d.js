(function(t){function e(e){for(var r,n,o=e[0],c=e[1],l=e[2],u=0,d=[];u<o.length;u++)n=o[u],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&d.push(s[n][0]),s[n]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);m&&m(e);while(d.length)d.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,n=1;n<a.length;n++){var o=a[n];0!==s[o]&&(r=!1)}r&&(i.splice(e--,1),t=c(c.s=a[0]))}return t}var r={},n={app:0},s={app:0},i=[];function o(t){return c.p+"js/"+({register:"register"}[t]||t)+"."+{register:"7677058c"}[t]+".js"}function c(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.e=function(t){var e=[],a={register:1};n[t]?e.push(n[t]):0!==n[t]&&a[t]&&e.push(n[t]=new Promise((function(e,a){for(var r="css/"+({register:"register"}[t]||t)+"."+{register:"631db4f0"}[t]+".css",s=c.p+r,i=document.getElementsByTagName("link"),o=0;o<i.length;o++){var l=i[o],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===r||u===s))return e()}var d=document.getElementsByTagName("style");for(o=0;o<d.length;o++){l=d[o],u=l.getAttribute("data-href");if(u===r||u===s)return e()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=e,m.onerror=function(e){var r=e&&e.target&&e.target.src||s,i=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=r,delete n[t],m.parentNode.removeChild(m),a(i)},m.href=s;var p=document.getElementsByTagName("head")[0];p.appendChild(m)})).then((function(){n[t]=0})));var r=s[t];if(0!==r)if(r)e.push(r[2]);else{var i=new Promise((function(e,a){r=s[t]=[e,a]}));e.push(r[2]=i);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=o(t);var d=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(m);var a=s[t];if(0!==a){if(a){var r=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+n+")",d.name="ChunkLoadError",d.type=r,d.request=n,a[1](d)}s[t]=void 0}};var m=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(e)},c.m=t,c.c=r,c.d=function(t,e,a){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(a,r,function(e){return t[e]}.bind(null,r));return a},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/",c.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=e,l=l.slice();for(var d=0;d<l.length;d++)e(l[d]);var m=u;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0187":function(t,e,a){},"07ab":function(t,e,a){"use strict";a("67a0")},1664:function(t,e,a){},"1b91":function(t,e,a){},"2a88":function(t,e,a){"use strict";a("85c0")},"2cfc":function(t,e,a){},3273:function(t,e,a){"use strict";a("cee2")},"3f39":function(t,e,a){},"3fe1":function(t,e,a){},4678:function(t,e,a){var r={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf755","./tlh.js":"cf755","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=s(t);return a(e)}function s(t){if(!a.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}n.keys=function(){return Object.keys(r)},n.resolve=s,t.exports=n,n.id="4678"},"47bf":function(t,e,a){"use strict";a("3f39")},"512f":function(t,e,a){"use strict";a("2cfc")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("e792"),a("0cdd");var r=a("2b0e"),n=a("5f5b"),s=a("b1e0");a("ab8b"),a("2dd8");r["default"].use(n["a"]),r["default"].use(s["a"]);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},o=[],c={components:{},created:function(){}},l=c,u=(a("5c0b"),a("2877")),d=Object(u["a"])(l,i,o,!1,null,null,null),m=d.exports,p=(a("d3b7"),a("3ca3"),a("ddb0"),a("8c4f")),f=a("2f62");r["default"].use(f["a"]);var b=new f["a"].Store({state:{user:[],token:"",companyStaff:[],company:[],currentUser:[],branches:[],provinces:[],districts:[],currentBranch:{},currentCustomer:{},currentBill:[],currentTarif:{},tariffs:[],currentMissingBill:{},availableCustomerBalance:0,customerTransaction:[],customerReadings:[],customerPastDues:[],currentBranchUserList:[],meters:[],notifications:[],proformas:[]},mutations:{initializeStore:function(t){var e=localStorage.getItem("MatiAppTokenJwt");t.token=null!=e?e:""},updateUser:function(t,e){t.user=e},updateToken:function(t,e){localStorage.setItem("MatiAppTokenJwt",e),t.token=e},SET_CURRENT_USER:function(t,e){t.currentUser=e},SET_BRANCHES:function(t,e){t.branches=e},SET_COMPANY_STAFF:function(t,e){t.companyStaff=e},SET_PROVINCES:function(t,e){t.provinces=e},SET_DISTRICTS:function(t,e){t.districts=e},SET_CURRENT_BRANCH:function(t,e){t.currentBranch=e},SET_CURRENT_CUSTOMER:function(t,e){t.currentCustomer=e},SET_CURRENT_BILL:function(t,e){t.currentBill=e},SET_CURRENT_TARIF:function(t,e){t.currentTarif=e},SET_CLEAR_CURRENT_VENDING:function(t){t.currentTarif={},t.currentBill=[],t.currentCustomer={}},SET_CLEAR_CURRENT_MISSING_BILL:function(t,e){t.currentMissingBill=e},SET_CUSTOMER_BALANCE:function(t,e){t.availableCustomerBalance=e},SET_CUSTOMER_TRANSACTIONS:function(t,e){t.customerTransaction=e},SET_CUSTOMER_READINGS:function(t,e){t.customerReadings=e},SET_CUSTOMER_PAST_DUES:function(t,e){t.customerPastDues=e},SET_CURRENT_BRANCH_USER_LIST:function(t,e){t.currentBranchUserList=e},SET_TARIFFS:function(t,e){t.tariffs=e},SET_METERS:function(t,e){t.meters=e},SET_COMPANY:function(t,e){t.company=e},SET_NOTIFICATIONS:function(t,e){t.notifications=e},SET_PROFORMAS:function(t,e){t.proformas=e}},getters:{user:function(t){return t.user},token:function(t){return t.token},currentUser:function(t){return t.currentUser},branches:function(t){return t.branches},companyStaff:function(t){return t.companyStaff},provinces:function(t){return t.provinces},districts:function(t){return t.districts},currentBranch:function(t){return t.currentBranch},currentCustomer:function(t){return t.currentCustomer},currentBill:function(t){return t.currentBill},currentTarif:function(t){return t.currentTarif},currentMissingBill:function(t){return t.currentMissingBill},availableCustomerBalance:function(t){return t.availableCustomerBalance},customerTransaction:function(t){return t.customerTransaction},customerReadings:function(t){return t.customerReadings},customerPastDues:function(t){return t.customerPastDues},currentBranchUserList:function(t){return t.currentBranchUserList},tariffs:function(t){return t.tariffs},meters:function(t){return t.meters},company:function(t){return t.company},notifications:function(t){return t.notifications},proformas:function(t){return t.proformas}},actions:{},modules:{}}),v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login-body"},[a("login-navbar",{on:{"login-user":function(e){return t.opnenLoginModal()}}}),a("b-modal",{ref:"user-login",attrs:{"hide-footer":"",title:t.$t("authentication")}},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[t.message?a("b-alert",{staticClass:"text-center text-white",class:{"bg-success":1==t.loading,"bg-danger":0==t.loading},attrs:{show:"",dismissible:""}},[t._v(t._s(t.message))]):t._e(),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{disabled:t.loading,required:"",type:"text",placeholder:"E-mail"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{disabled:t.loading,required:"",type:"password",placeholder:t.$t("password")},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),a("b-row",[a("b-col",[a("p",{staticClass:"btn btn-success btn-sm w-100",on:{click:function(e){return t.customerLogin()}}},[t.loading?[t._v(" "+t._s(t.$t("processing"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("customer-login")))]],2)]),a("b-col",[a("button",{staticClass:"btn btn-secondary btn-sm w-100",attrs:{disabled:t.loading},on:{click:function(e){return t.loginUser()}}},[t.loading?[t._v(" "+t._s(t.$t("processing"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("login")))]],2)])],1)],1)])]),a("b-row",{staticClass:"footer text-secondary"},[a("b-col",[t._v("Copyright ©2021 TSENANE, LDA. All rights reserved.")])],1),a("b-modal",{ref:"recover-password",attrs:{"hide-footer":"",title:t.$t("forgot-password")}},[a("p",[t._v(t._s(t.$t("registered_email")))]),a("b-form-group",{attrs:{id:"email","label-for":"email"}},[a("b-form-input",{attrs:{id:"email",type:"text",required:"",min:"1",size:"sm",placeholder:t.$t("email")},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),a("b-button",{staticClass:"mt-3 sm",attrs:{variant:"secondary",disabled:t.loading,block:"",size:"sm"},on:{click:function(e){return t.recover()}}},[t.loading?[t._v(" "+t._s(t.$t("submiting"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("send_email_link")))]],2)],1)],1)},h=[],g=a("1da1"),_=a("5530"),y=(a("96cf"),a("ac1f"),a("5319"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-navbar",{staticClass:"navbar",attrs:{toggleable:"lg",type:"dark",variant:"dark"}},[r("b-navbar-brand",{attrs:{to:"/"}},[r("img",{staticStyle:{"border-radius":"40%"},attrs:{src:a("c6f3"),alt:"AquaMoz",width:"40"}}),t._v("  "),r("span",[t._v("TSENANE")])]),r("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),r("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[r("b-navbar-nav",[r("b-nav-item",{attrs:{to:"/simulator"}},[t._v(t._s(t.$t("simulate")))])],1),r("b-navbar-nav",{staticClass:"ml-auto"},[r("b-nav-item",{on:{click:function(e){return t.loginUser()}}},[t._v(t._s(t.$t("authentication")))]),r("b-nav-item-dropdown",{attrs:{text:t.$t("lang"),right:""}},t._l(t.languages,(function(e){return r("b-dropdown-item",{key:e.title,on:{click:function(a){return t.changeLocale(e.language)}}},[r("flag",{attrs:{iso:e.flag,squared:!1}}),t._v("   "),r("small",[t._v(t._s(e.title))])],1)})),1)],1)],1)],1)],1)}),x=[],w=a("a925");r["default"].use(w["a"]);var C={pt:{profile:"Perfil","customer-login":"Entrar como cliente",report:"Relatórios",payments:"Relatório de Venda",logout:"Sair",lang:"PT",tarrif:"Tarifas",settings:"Gestão",zones:"Clientes",neighbor:"Bairro",staff:"Funcionários",zonesManagement:"Gestão de Clientes",new:"Novo",add_new_meter:"Novo Contador",new_store:"Nova Loja",search_customer:"Pesquisar clientes",search_neighborhoods:"Pesquisar Bairros",staff_management:"Gestão de Funcionários",update_profile:"Trocar palavra passe",name:"Nome completo",staff_name:"Nome do Operador",phone:"Telefone",update:"Actualisar",updating:"Por favor aguarde...",edit:"Editar",actions:"Acções",meter_id:"Número de contador",address:"Endereço",email:"E-mail",nuit:"NUIT",active:"Activo",inactive:"Inactivo",submit:"Submeter",tarrif_type:"Tipo de Tarifa",post_paid:"Pós pago",pre_paid:"Pré pago",bar_code:"Número de contador",customer_type:"Tipo de contador",level:"Nível",created_at:"Data de cadastro",code:"Código da Recarga",customers:"Clientes",vending:"Vendas",error:"Sem nenhum resultado.",last_payments:"Últimos pagamentos",notifications:"Notificações",meter:"Contadores",under_dev:"Em desenvolvimento...",price:"Preço",tariff_management:"Gestão de Tarifas",price_per_m_3:"Preço por m",new_tariff:"Nova tarifa",last_reading:"Anterior",last:"Anterior",current:"Actual",current_reading:"Actual",consumption:"Consumo",fixed_tax:"Taxa de disponibilidade de serviços",vending_option:"Opção de Compra",by_value:"Por Valor",by_unit:"Por Unidade",font:"Fontenária",domestic:"Doméstica",munic:"Municipal",pub_com:"Pública e Commercial",industrial:"Industrial",amount:"Montante",quantity:"Quantidade em",minimum_qty:"Quantidade mínima",last_purchases:"Facturas",totals_2_pay:"TOTAL",generate:"Gerar recarga",cancel:"Cancelar",new_purchase:"Nova compra",details:"Detalhes",description:"Descrição",price_per_unit:"Preço por ",subtotal:"Sub Total",quantity_:"Consumo Facturado",minimum_consuption:"Escalão social (5)",vat:"IVA (12.75%)",total_without_vat:"Total Sem IVA",first_five:"1º escalão (0 - 5)",first_seven:"2º escalão (0 - 7)",above_seven:"3º escalão - Superior a 7",first_fifteen:"1º escalão (0 - 15)",above_fifteen:"2º escalão Superior a 15",province:"Província",district:"Distrito",decide_delete:"Deseja deletar permanentimente este item?",delete:"Deletar",auth_code:"Código de autenticação",user_role:"Tipo de usuário",admin:"Administrador",normal:"Normal",select:"Seleccionar",print:"Imprimir",voucher:"Código",reading_error:"A leitura actual deve ser maior ou igual a anterior",meter_management:"Gestão de contadores",diameter:"Diâmetro",id_range:"Número de contador",meeter_id:"BI ou Passaporte",submiting:"Por favor aguarde...",cashier:"Caixa",help_desk:"Atendimento",missing_reading:"Leituras Aguardando Aprovação",validate:"Validar",bill:"Leitura",meter_photo:"Imagem",captured_by:"Carregada por",no_transaction:"Pagamentos indisponíves",generate_statement:"Gerar Extrato",date:"Data de pagamento",issue_date:"Data",transaction_id:"ID",provider:"Método de pagamento",customer_id:"ID do cliente",sms:"Enviar SMS",mail:"Enviar E-mail",reading_history:"Histórico de Consumo",support:"Suporte",value:"Montante",readings_empty:"Leituras indisponíves",generate_excel:"Gerar Excel",generate_pdf:"Resumo de facturação",search_meters:"Pesquisar contadores",add_debts:"Adicionar Dívida",amount_debt:"Montante da Dívida",previous_dues:"Dívidas e multas anteriores",penalty:"Multa",status:"Estado",generated_at:"Gerado aos",saving:"A actualizar...",not_paid:"Não pago",paid:"Pago",meter_type:"Tipo de contador",allocated:"Alocado",not_allocated:"Não alocado",allocated_to:"Alocado a ",click_meter:"Clique sobre cada linha para ver mais detalhes",latitude:"Latitude",longitude:"Longitude",invoice:"Factura",view_invoice:"Ver factura",validated_at:"Validada aos",reference:"Referência",total_payable:"Total a pagar",click_to_validate:"Clique sobre cada linha para validar a leitura",taken_by:"Técnico",processing:"A processar...",login:"Entrar como técnico",simulator:"Simulador",simulate:"Simulador","forgot-password":"Recuperar senha",app_name:"AquaMoz - Sistema de Vendas","confirm-password":"Repetir a senha.",password:"Senha",identification:"Número de BI/Passaporte",water_simulator:"Simulador De Consumo De Água",simulate_bill:"Simular a Factura","simulator-result":"Previsualização",registered_email:"Digite o seu email.",send_email_link:"Enviar um link de recuperação da senha",vending_record:"Relatório de Vendas",receipt:"F/R Nº",customer_number:"Número de cliente",customer_name:"Nome do cliente",total_paid:"Total Pago",total_unities:"Consumo",dues:"Dívidas",payment_date:"Data",first:"Primeiro",prev:"Anterior",last_:"Último",from:"De",to:"Até",searching:"A pesquisar...",search:"Pesquisar",pint_statement:"Imprimir Histórico",add_payment:"Nova compra",purchase_details:"Detalhes da Compra",next_step:"Próximo Passo",edit_details:"Actualizar dados",add_balance:"Recarregar a Conta",balance_value:"Valor a creditar - MZN",current_balance:"Saldo",wire_transfer:"Gerar Referência Bancária",cash:"Numerário",pos:"POS",received_payments:"Relatório de pagamentos",balance:"Saldo",transaction_history:"Extrato de pagamentos",debt:"Débito",credit:"Crédito",under_development:"Em desenvolvimento",finalizing_purchase:"A finalizar a compra, por favor aguarde!",finalize:"Finalizar",no_purchases:"Leituras indisponíveis.",transactio_description:"Detalhes da Transação",pay_now:"Confirmar Pagamento",no_past_dues:"Dívidas indisponíveis.",new_staff:"Novo Usuário",staff_list:"Usuários",no_users:"Usuários indisponíveis.",back_home:"HOME",new_customer:"Novo Cliente",system:"Tipo de Tarifa",sanitation_tax:"Taxa de saneamento",manager:"Gerente da Loja",unavailable_customers:"Clientes indisponíveis",unavailable_meters:"Contadores indisponíveis.",download:"Baixar",select_store:"Seleccionar Loja",unavailable_purchases:"Pagamentos indisponíveis",company_detail:"Dados da Empresa","edit-company-details":"Editar dados da empresa",company:"Nome da empresa","bank-account":"Nº da Conta Bancária",nib:"NIB",preview:"Previsualisar",new_reading:"Nova Leitura",qr_code_print:"Imprimir",list_of:"Imprimir lista de ",go_to_customer_panel:"Ir ao painel do cliente",choose_date:"Data da Leitura",document_id:"BI",current_bill:"Valor da factura",amount_received:"Valor recebido",debit_balance:"Saldo devedor",date_of_payment:"Data de pagamento",payment_method:"Método de pagamento",payment_reference:"Referência/Banco",customer_details:"Detalhes do cliente",update_details:"Actualização de dados",total_to_pay:"Total a Pagar",pay:"Pagar",month_consumption:"Mês de Consumo",category:"Categoria",current_forfeit:"Multa actual",bill_receipt_number:"Factura/Recibo número",close_cashier:"Feichar Caixa",invalidate_forfeit:"Invalidar Multa",products_services:"Taxas & Outros Encargos",product_name:"Produto ou Serviço",product_price:"Preço por unidade",product_description:"Descrição do produto",save_product:"Cadastrar Produto",new_product:"Salvar novo produto",taxa_deposito_garantia:"Taxa Depósito de Garantia",taxa_vistoria_sem_transporte:"Taxa de Vistoria S/ Transporte",taxa_vistoria_com_transporte:"Taxa de Vistoria C/ Transporte",taxa_subscricao_contrato:"Taxa de Subscrição de Contrarto",taxa_corte_religacao:"Taxa de Corte e Religação",taxa_afericao_contador:"Taxa de Aferição do Contador",taxa_encargo_contador_danificado:"Taxa de Encargo de Contador Danificado",taxa_encargo_violacao_instalacao:"Taxa de Encargo de Violação de Instalação",taxa_aluguer_contador:"Taxa de Aluguer de Contador",pending_bills:"Dívida",type_customer_barcode:"Número de contador",new_password:"Digite a nova senha",confirm_password:"Confirmar a nova senha",old_password:"Senha antiga",generate_general_report:"Baixar Relatório Geral",consumption_period:"Mês-Ano",authentication:"Autenticação"},en:{profile:"Profile","customer-login":"Customer sign in",report:"Download Reports",payments:"Vending Report",logout:"Logout",lang:"EN",tarrif:"Tariffs",settings:"Management",zones:"Customers",neighbor:"Store",staff:"Staff",new_staff:"New User",new_store:"New Store",zonesManagement:"Customer Management",new:"New",add_new_meter:"New Meter",search_customer:"Search customers",search_neighborhoods:"Search Stores",staff_management:"Staff Management",update_profile:"Change password",name:"Full name",staff_name:"Operator Name",phone:"Phone number",update:"Update",updating:"Updating, please wait...",edit:"Edit",actions:"Actions",meter_id:"Meter number",address:"Address",email:"E-mail",nuit:"NUIT",active:"Active",inactive:"Inactive",submit:"Submit",submiting:"Please wait",tarrif_type:"Tariff Type",post_paid:"Post paid",pre_paid:"Pre paid",bar_code:"Meter number",customer_type:"Meter type",level:"Role",created_at:"Created At",code:"Token",customers:"Customers",vending:"Vending",error:"No results.",last_payments:"Last payments",notifications:"Notifications",meter:"Meters",under_dev:"Under Development...",price:"Price",tariff_management:"Tarif Management",price_per_m_3:"Price per m",new_tariff:"New Tariff",last_reading:"Last",last:"Last",current:"Current",current_reading:"Current",consumption:"Consumption",fixed_tax:"Service availability fee",vending_option:"Vending Option",by_value:"By Valor",by_unit:"By Unit",font:"Fountain",domestic:"Domestic",munic:"Municipal",pub_com:"Public & Commercial",industrial:"Industrial",amount:"Amount (MZN)",quantity:"Quantity in",minimum_of:"(Mínimo de 5)",minimum_qty:"Minimum purchase quantity: ",last_purchases:"Bills statements",totals_2_pay:"TOTAL",generate:"Generate voucher",cancel:"Cancel",new_purchase:"New Purchase",details:"Details",description:"Description",price_per_unit:"Price per ",subtotal:"Sub Total",quantity_:"Quantity",minimum_consuption:"Escalão social 5",vat:"VAT (12.75%)",total_without_vat:"Total without VAT",first_five:"1º escalão (0 - 5)",first_seven:"2º escalão (0 - 7)",above_seven:"3º escalão - Superior a 7",first_fifteen:"1º escalão (0 - 15)",above_fifteen:"2º escalão - Superior a 15",province:"Province",district:"District",decide_delete:"Are you sure you want to delete this record permanently?",delete:"Delete",auth_code:"Authentication code",user_role:"User role",admin:"Admin",normal:"Normal user",select:"Select",print:"Print",voucher:"Voucher",reading_error:"The current reading must be greater or equal than the last one.",meter_management:"Meter management",diameter:"Diameter",id_range:"Meter number",meeter_id:"ID or Passaporte",cashier:"Cashier",help_desk:"Help Desk",missing_reading:"Bills Pending Approval",validate:"Validate",bill:"Bill",meter_photo:"Image",captured_by:"Uploaded by",no_transaction:"Unavailable payments!",generate_statement:"Generate Statement",date:"Payment date",issue_date:"Date",transaction_id:"Transaction ID",provider:"Payment Method",customer_id:"Customer ID",sms:"Send SMS",mail:"Send E-mail",reading_history:"History of consumption",support:"Support",value:"Amount",readings_empty:"Bills not available",generate_excel:"Generate Excel",generate_pdf:"Generate PDF",search_meters:"Search meters",add_debts:"Add Dues",amount_debt:"Amount of Dues",previous_dues:"Past dues and fines",penalty:"Fine",status:"Status",generated_at:"Generated at",saving:"Updating...",not_paid:"Not paid",paid:"Paid",meter_type:"Meter type",allocated:"Allocated",not_allocated:"Not allocated",allocated_to:"Allocated to ",click_meter:"Click over each row to see more details",latitude:"Latitude",longitude:"Longitude",invoice:"Invoice",view_invoice:"View invoice",validated_at:"Validated at",reference:"Reference",total_payable:"Total Due",click_to_validate:"Click over each row to validate the Bill",taken_by:"Staff",processing:"Loading, please wait...",login:"Staff sign in",simulator:"Simulator",simulate:"Simulator","forgot-password":"Recover password.","confirm-password":"Repeat password.",app_name:"AquaMoz - Vending System",password:"Password",identification:"ID/Passport Number",water_simulator:"Water Billing Simulator",simulate_bill:"Preview","simulator-result":"Simulation result",registered_email:"Provide your email address",send_email_link:"Send me the password recover link",vending_record:"Vending Record",receipt:"F/R #",customer_number:"Customer number",customer_name:"Customer name",total_paid:"Total Paid",total_unities:"Unities",dues:"Debts",payment_date:"Date",first:"First",prev:"Prev",last_:"Last",from:"From",to:"To",searching:"Searching...",search:"Search",pint_statement:"Print History",add_payment:"New Purchase",purchase_details:"Purchase Details",next_step:"Next Step",edit_details:"Update details",add_balance:"Reload Balance",balance_value:"Amount - MZN",current_balance:"Balance",wire_transfer:"Generate reference",cash:"CASH",pos:"POS",received_payments:"Payments report",balance:"Balance",transaction_history:"Payment statement",debt:"Debt",credit:"Credit",under_development:"Under development",finalizing_purchase:"Finalizing the purchase, please wait!",finalize:"Finalize",no_purchases:"Readings not available",transactio_description:"Transaction Detalis",pay_now:"Confirm Payment",no_past_dues:"Unavailable debts.",staff_list:"Users",no_users:"Unavailable Users.",back_home:"HOME",new_customer:"New Customer",system:"Tariff Type",sanitation_tax:"Sanitation Tax",manager:"Store Manager",unavailable_customers:"Customers not available",unavailable_meters:"Meters not available.",download:"Download",select_store:"Select Store",unavailable_purchases:"Payments not avaiable.",company_detail:"Company Details","edit-company-details":"Edit Company Details",company:"Company name","bank-account":"Bank Account Nº",nib:"NIB",preview:"Preview",new_reading:"New Reading",qr_code_print:"Imprimir",list_of:"Print list of ",go_to_customer_panel:"Go to customer dashboard",choose_date:"Reading Date",document_id:"ID",current_bill:"Bill Value",amount_received:"Amount Received",debit_balance:"Debit Balance",date_of_payment:"Date of payment",payment_method:"Payment method",payment_reference:"Bank/Reference",customer_details:"Customer details",update_details:"Update data",total_to_pay:"Total Due",pay:"Pay now",month_consumption:"Month",category:"Category",current_forfeit:"Current fine",bill_receipt_number:"Bill/Receipt number",close_cashier:"Feichar Caixa",invalidate_forfeit:"Invalidate Fine",products_services:"Fees & Other Charges",product_name:"Product Or Service",product_price:"Product Price",product_description:"Product Description",save_product:"Save Product",new_product:"Add new product",taxa_deposito_garantia:"Taxa Depósito de Garantia",taxa_vistoria_sem_transporte:"Taxa de Vistoria S/ Transporte",taxa_vistoria_com_transporte:"Taxa de Vistoria C/ Transporte",taxa_subscricao_contrato:"Taxa de Subscrição de Contrarto",taxa_corte_religacao:"Taxa de Corte e Religação",taxa_afericao_contador:"Taxa de Aferição do Contador",taxa_encargo_contador_danificado:"Taxa de Encargo de Contador Danificado",taxa_encargo_violacao_instalacao:"Taxa de Encargo de Violação de Instalação",taxa_aluguer_contador:"Taxa de Aluguer de Contador",pending_bills:"Total Due",type_customer_barcode:"Número de contador",new_password:"New password",confirm_password:"Confirm new password",old_password:"Old password",generate_general_report:"Download General Report",consumption_period:"Month-Year",authentication:"Autenthentication"}},k=new w["a"]({locale:"pt",fallbackLocale:"en",messages:C}),T=k,R={name:"Navbar",data:function(){return{languages:[{flag:"mz",language:"pt",title:"PT"},{flag:"gb",language:"en",title:"EN"}]}},methods:{changeLocale:function(t){T.locale=t},loginUser:function(){this.$emit("login-user")}}},P=R,S=Object(u["a"])(P,y,x,!1,null,null,null),D=S.exports,$=a("d4ec"),A=a("bee2"),I=a("bc3a"),O=a.n(I),N="api/userLogin",M=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"userLogin",value:function(t){return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(a,r){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(N,t);case 3:n=e.sent,s=n.data,a(s),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),r(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"updatePassword",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put(N,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),z=M,B="api/login-master",j=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getApiKey",value:function(t){return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(a,r){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(B,{uid:t});case 3:n=e.sent,s=n.data,a(s),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),r(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),E=j,L="api/province",V=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getProvinces",value:function(){return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(e,a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(L);case 3:r=t.sent,n=r.data,e(n),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),a(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getDistricts",value:function(t){return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(a,r){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(L,"/").concat(t));case 3:n=e.sent,s=n.data,a(s),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),r(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),F=V,U="api/users",q=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getUser",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(U,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getAllUsers",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(U,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertUser",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(U,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),W=q,Y=(a("99af"),"api/branch"),G=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getBranch",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get(Y,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"getAllBranches",value:function(t,e){var a="".concat(Y,"/").concat(t.companyId,"/").concat(t.branchId,"/").concat(t.userRole),r="Bearer "+e;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(e,n){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get("".concat(a),{headers:{Authorization:r}});case 3:s=t.sent,i=s.data,e(i),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"deleteBranch",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(Y,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertOrUpdateBranch",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Y,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),H=G,Q="api/company",Z=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getCompanies",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(Q,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getCompanyDetail",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Q,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertOrUpdateCompanyDetail",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Q,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),J=Z,K="api/customer",X=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getSingleCustomer",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(K,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getCustomerByBranch",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(K,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertOrUpdateCustomer",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(K,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"customerLogin",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put(K,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),tt=X,et=r["default"].extend({computed:Object(_["a"])(Object(_["a"])({},Object(f["b"])(["user","token","currentUser","branches","provinces","districts","tariffs"])),{},{nextRoute:function(){var t;return 1==this.user[0].userRole?t="/dashboard":2==this.user[0].userRole?t="/manager":3==this.user[0].userRole&&(t="/cashier"),t}}),components:{LoginNavbar:D},created:function(){var t=localStorage.getItem("MatiAppTokenJwt");t?(this.fetchCurrentUser(),this.getProvinces()):this.checkAuth()},data:function(){return{email:"",password:"",error:null,loading:!1,tariff_type:1,current:0,last:0,message:null}},watch:{user:function(t){t&&this.$router.replace(this.nextRoute)}},methods:{recoverPassword:function(){this.$refs["recover-password"].show()},opnenLoginModal:function(){this.$refs["user-login"].show()},customerLogin:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.loading=!0,a={phoneNumber:t.email,password:t.password};try{r=tt.customerLogin(a),1==r.success?t.message="Login efectuado com sucesso.":(t.message=r.message,t.loading=!1)}catch(n){t.loading=!1,t.message=n.message,t.loading=!1,t.password=""}case 3:case"end":return e.stop()}}),e)})))()},loginUser:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,a={email:t.email,password:t.password},e.prev=2,e.next=5,z.userLogin(a);case 5:r=e.sent,t.loading=!1,t.password="",1==r.success?t.checkAuth(r.result):t.message=r.message,e.next=17;break;case 11:e.prev=11,e.t0=e["catch"](2),t.loading=!1,t.message=e.t0.message,t.loading=!1,t.password="";case 17:case"end":return e.stop()}}),e,null,[[2,11]])})))()},checkAuth:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.isLoading=!0,a.prev=1,a.next=4,E.getApiKey(t[0].uid);case 4:r=a.sent,1==r.success?(e.$store.commit("updateToken",r.token),e.fetchCurrentUser()):e.isLoading=!1,a.next=12;break;case 8:a.prev=8,a.t0=a["catch"](1),e.error=a.t0.message,e.isLoading=!1;case 12:case"end":return a.stop()}}),a,null,[[1,8]])})))()},fetchCurrentUser:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W.getUser(t.token);case 3:a=e.sent,1==a.success?(t.$store.commit("updateUser",a.result),t.$store.commit("SET_CURRENT_USER",a.result),t.$store.commit("SET_TARIFFS",a.tariffs),t.getBranches()):t.isLoading=!1,e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),t.error=e.t0.message,t.isLoading=!1;case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getProvinces:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,F.getProvinces();case 4:a=e.sent,1==a.success?(t.$store.commit("SET_PROVINCES",a.result),t.getDistricts()):t.isLoading=!1,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),t.error=e.t0.message,t.isLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getDistricts:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,F.getDistricts(1);case 4:a=e.sent,1==a.success?(t.$store.commit("SET_DISTRICTS",a.result),t.getBranches(),t.isLoading=!1):t.isLoading=!1,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),t.error=e.t0.message,t.isLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getBranches:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={userRole:t.user[0].userRole,branchId:t.user[0].branchId,companyId:t.user[0].companyId},e.prev=1,e.next=4,H.getAllBranches(a,t.token);case 4:r=e.sent,1==r.success?(t.$store.commit("SET_BRANCHES",r.result),t.getCompanyDetails(),t.isLoading=!1):(t.isLoading=!1,t.$bvToast.toast(r.message,{title:"Erro!",variant:"danger",solid:!0})),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](1),t.error=e.t0.message,t.isLoading=!1,t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0});case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getCompanyDetails:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,J.getCompanyDetail(t.user[0].companyId,t.token);case 3:a=e.sent,1==a.success?t.$store.commit("SET_COMPANY",a.result):console.log(a.message),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}}}),at=et,rt=(a("a91a"),Object(u["a"])(at,v,h,!1,null,"2f34deff",null)),nt=rt.exports,st=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),t.isLoading?a("pulse-loader",{staticClass:"text-center m-4"}):a("b-container",{staticClass:"bv-example-row mt-2",attrs:{fluid:""}},[a("b-row",[a("b-col",{attrs:{lg:"3"}},[a("Quotation",{attrs:{pendingRegistrations:t.pendingRegistration,invoiceId:t.invoiceId},on:{"update-quotation":function(e){return t.getPreRegistrations()}}})],1),a("b-col",[a("PendingReadings")],1),a("b-col",{attrs:{lg:"3"}},[a("b-row",[a("b-col",[a("b-input-group",{staticClass:"mb-2",attrs:{size:"md"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"search"}})],1),a("b-form-input",{attrs:{type:"text",size:"md",placeholder:t.$t("search_customer")},on:{keyup:function(e){return t.searchCustomer()}},model:{value:t.searchValues,callback:function(e){t.searchValues=e},expression:"searchValues"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-overlay",{staticClass:"mt-2 mb-2 bg-white",attrs:{show:t.show,rounded:"sm"}},[t.customers.length>0?a("b-list-group",t._l(t.customers,(function(e){return a("b-list-group-item",{key:e.id,staticClass:"flex-column align-items-start",staticStyle:{cursor:"pointer","font-size":"10pt"},on:{click:function(a){return t.openVendingPanel(e)}}},[a("div",{staticClass:"d-flex w-100 justify-content-between"},[a("h2",{staticClass:"mb-0",staticStyle:{"font-size":"small"}},[1==e.status?a("b-icon",{staticClass:"text-muted",attrs:{icon:"person-check-fill"}}):a("b-icon",{attrs:{icon:"person-dash-fill",variant:"danger"}}),t._v("       "),a("small",[t._v(t._s(e.name))])],1),a("small",{staticClass:"text-muted"},[a("em",[t._v(t._s(t.tariffId(e.tarrifTypeId)))])])]),a("p",{staticClass:"mb-0"},[a("small",{staticClass:"text-muted"},[a("em",[t._v(t._s(e.address)+" - "+t._s(e.barcode))])])])])})),1):t._e(),t.error?a("b-list-group",{staticClass:"text-danger"},[a("b-list-group-item",{staticClass:"text-center text-danger"},[a("h5",[t._v(t._s(t.$t("error")))])])],1):t._e()],1)],1)],1)],1)],1)],1)],1)},it=[],ot=a("8a5d"),ct=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-navbar",{staticClass:"navbar",attrs:{toggleable:"lg",type:"dark",variant:"dark"}},[r("b-navbar-brand",{attrs:{to:"/dashboard"}},[r("img",{staticStyle:{"border-radius":"40%"},attrs:{src:a("c6f3"),alt:"APP LOGO",width:"40"}}),t._v("  "),t.company[0]?r("span",[t._v(t._s(t.company[0].name))]):t._e()]),r("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),r("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[r("b-navbar-nav",{staticStyle:{"font-size":"10pt"}},[r("b-nav-item",{attrs:{to:"/branch"}},[r("b-icon",{attrs:{icon:"people-fill"}}),t._v(" "+t._s(t.$t("zones").toUpperCase()))],1),r("b-nav-item",{attrs:{to:"/settings"}},[r("b-icon",{attrs:{icon:"tools"}}),t._v(" "+t._s(t.$t("settings").toUpperCase()))],1),r("b-nav-item",{attrs:{to:"/relatorios"}},[r("b-icon",{attrs:{icon:"bar-chart-steps"}}),t._v(" "+t._s(t.$t("payments").toUpperCase()))],1),r("b-nav-item",{attrs:{to:"/payments"}},[r("b-icon",{attrs:{icon:"pie-chart-fill"}}),t._v(" "+t._s(t.$t("received_payments").toUpperCase()))],1),r("b-nav-item",{attrs:{to:"/proforma"}},[r("b-icon",{attrs:{icon:"file-pdf-fill"}}),t._v(" FACTURAS PROFORMA "),r("sup",{staticClass:"text-danger"},[r("span",{staticClass:"ml-1"},[r("b",{staticStyle:{"font-size":"10pt"}},[t._v(t._s(t.proformas.length))])])])],1)],1),r("b-navbar-nav",{staticClass:"ml-auto"},[r("b-nav-item-dropdown",{attrs:{text:t.$t("lang"),right:""}},t._l(t.languages,(function(e){return r("b-dropdown-item",{key:e.title,on:{click:function(a){return t.changeLocale(e.language)}}},[r("flag",{attrs:{iso:e.flag,squared:!1}}),t._v("   "),r("small",[t._v(t._s(e.title))])],1)})),1),r("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:t._u([t.user?{key:"button-content",fn:function(){return[r("i",{staticClass:"fa fa-user"}),t._v("   "+t._s(t.user[0].name)+" ")]},proxy:!0}:null],null,!0)},[r("b-dropdown-item",{attrs:{to:"/profile"}},[t._v(t._s(t.$t("profile")))]),r("hr"),r("b-dropdown-item",{on:{click:function(e){return t.logout()}}},[t._v(t._s(t.$t("logout")))])],1)],1)],1)],1)],1)},lt=[],ut={name:"Navbar",computed:Object(_["a"])({},Object(f["b"])(["user","branches","token","currentUser","company","proformas"])),created:function(){},data:function(){return{languages:[{flag:"mz",language:"pt",title:"PT"},{flag:"gb",language:"en",title:"EN"}]}},methods:{gotToCustomersPanel:function(){this.$store.commit("SET_CURRENT_BRANCH",this.branches[0]),this.$router.push("/branch")},changeLocale:function(t){T.locale=t},logout:function(){localStorage.removeItem("MatiAppTokenJwt"),this.$router.replace("/")}}},dt=ut,mt=Object(u["a"])(dt,ct,lt,!1,null,null,null),pt=mt.exports,ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"quotation"},[a("b-card",{staticClass:"mb-0"},[a("b-row",[a("b-col",{attrs:{cols:"8"}},[a("b",{staticClass:"text-black"},[t._v("Novos clientes")])]),a("b-col",{staticClass:"text-right",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.refreshPreRegistration()}}},[a("b-button",{attrs:{pill:"",variant:"success",size:"sm"}},[a("b-icon",{attrs:{variant:"light",icon:"arrow-clockwise"}})],1)],1)],1),a("hr",{staticClass:"bg-primary mt-1 mb-1 w-1"}),t.pendingRegistrations.length>0?a("table",{staticClass:"table table-sm table-hover mt-0",staticStyle:{width:"100%"}},[a("tbody",t._l(t.pendingRegistrations,(function(e){return a("tr",{key:e.id,staticStyle:{"font-size":"9pt",cursor:"pointer"}},[a("td",[t._v(t._s(e.name))]),a("td",[a("b-row",[a("b-col",{staticClass:"text-center cursor-pointer",on:{click:function(a){return t.deletePreregistration(e)}}},[a("b-icon",{attrs:{variant:"danger",size:"lg",icon:"trash"}})],1),a("b-col",{staticClass:"text-center",on:{click:function(a){return t.opendQuotationForm(e)}}},[a("b-icon",{attrs:{variant:"primary",size:"lg",icon:"eye"}})],1)],1)],1)])})),0)]):t._e()],1),a("b-modal",{ref:"quotation",attrs:{"hide-footer":"",size:"xl",title:"Factura Proforma Nº: "+t.invoiceId+"/SAAF/"+(new Date).getFullYear()}},[a("b-overlay",{attrs:{show:t.isLoading,rounded:"sm"}},[a("b-row",[a("b-col",{attrs:{lg:"4"}},[a("small",[a("b",[t._v("Nome do cliente")])]),a("b-form-group",{attrs:{"label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text",disabled:t.isLoading,required:"",size:"sm",placeholder:"Nome do cliente"},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}})],1),a("small",[a("b",[t._v("Endereço")])]),a("b-form-group",{attrs:{"label-for":"address"}},[a("b-form-input",{attrs:{id:"address",type:"text",disabled:t.isLoading,required:"",size:"sm",placeholder:"Endereço"},model:{value:t.customerAddress,callback:function(e){t.customerAddress=e},expression:"customerAddress"}})],1),a("small",[a("b",[t._v("Telemóvel")])]),a("b-form-group",{attrs:{"label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"number",disabled:t.isLoading,required:"",size:"sm",placeholder:"Telemóvel"},model:{value:t.customerPhoneNumber,callback:function(e){t.customerPhoneNumber=e},expression:"customerPhoneNumber"}})],1),a("small",[a("b",[t._v("NUIT")])]),a("b-form-group",{attrs:{"label-for":"nuit"}},[a("b-form-input",{attrs:{id:"nuit",type:"number",disabled:t.isLoading,required:"",size:"sm",placeholder:"NUIT"},model:{value:t.customerNuit,callback:function(e){t.customerNuit=e},expression:"customerNuit"}})],1),a("small",[a("b",[t._v("DETALHES DA COMPRA")])]),a("hr",{staticClass:"bg-primary"}),a("b-form-select",{attrs:{size:"sm",options:t.productList},model:{value:t.productName,callback:function(e){t.productName=e},expression:"productName"}}),a("small",[a("b",[t._v("Preço")])]),a("b-form-group",{attrs:{"label-for":"price"}},[a("b-form-input",{attrs:{id:"price",type:"number",step:"any",min:"1",disabled:t.isLoading,required:"",size:"sm",placeholder:"Item"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),a("small",[a("b",[t._v("Quantidade")])]),a("b-form-group",{attrs:{"label-for":"quantity"}},[a("b-form-input",{attrs:{id:"quantity",type:"number",min:"1",disabled:t.isLoading,required:"",size:"sm",placeholder:"Item"},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}})],1),a("b-button",{attrs:{disabled:t.isLoading,block:"",size:"sm"},on:{click:function(e){return t.addProdutToCart()}}},[a("b-icon",{attrs:{icon:"cart-plus-fill"}}),t._v(" Adicionar ao carrinho ")],1)],1),a("b-col",[a("b-row",[a("b-col",[a("b",[t._v("Previsualização")])]),a("b-col",{staticClass:"text-right"},[a("b",[t._v("Data de emissão: "+t._s(t.dateOfQuote))])])],1),a("hr",{staticClass:"bg-primary mt-1 mb-1"}),a("table",{staticClass:"table table-sm table-hover"},[a("thead",[a("tr",{staticStyle:{"font-size":"9pt"}},[a("th",{staticClass:"text-center"},[t._v("Deletar")]),a("th",{attrs:{colspan:"2"}},[t._v("Descrição do Produto")]),a("th",[t._v("Preço Unitário")]),a("th",[t._v("Quantidade")]),a("th",{staticClass:"text-right"},[t._v("Subtotal")])]),t._l(t.products,(function(e,r){return a("tr",{key:r,staticStyle:{"font-size":"8pt"}},[a("td",{staticClass:"text-center",on:{click:function(a){return t.deleteItemInCart(e)}}},[a("b-icon",{attrs:{variant:"danger",icon:"trash-fill"}})],1),a("td",{attrs:{colspan:"2"}},[t._v(t._s(e.item))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:e.price,expression:"item.price"}]}),a("td",[t._v(t._s(e.quantity))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:e.price*e.quantity,expression:"item.price * item.quantity"}],staticClass:"text-right"})])}))],2),a("tbody",[a("tr",[a("td",{attrs:{colspan:"6"}},[a("br"),a("br")])]),a("tr",{staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"3"}},[t._v("Subtotal")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.calculateSubTotal(),expression:"calculateSubTotal()"}],staticClass:"text-right",attrs:{colspan:"3"}})]),a("tr",{staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"3"}},[t._v("IVA - "+t._s(100*t.vat)+"%")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.vat*t.calculateSubTotal(),expression:"vat * calculateSubTotal()"}],staticClass:"text-right",attrs:{colspan:"3"}})]),a("tr",{staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"3"}},[t._v("TOTAL A PAGAR")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.calculateSubTotal()+t.calculateSubTotal()*t.vat,expression:"\n                    calculateSubTotal() + calculateSubTotal() * vat\n                  "}],staticClass:"text-right",attrs:{colspan:"3"}})]),a("tr",[a("td",{attrs:{colspan:"3"}},[a("b-button",{attrs:{block:"",size:"sm",variant:"danger",disabled:t.isLoading},on:{click:function(e){return t.clearInvoice()}}},[a("b-icon",{attrs:{icon:"trash-fill"}}),t._v(" Cancelar ")],1)],1),a("td",{staticClass:"text-right cursor-pointer",attrs:{colspan:"3"}},[a("b-button",{attrs:{disabled:t.isLoading||t.products.length<=0,block:"",size:"sm",variant:"success"},on:{click:function(e){return t.insertProforma()}}},[a("b-icon",{attrs:{icon:"printer-fill"}}),t._v(" Salvar e imprimir ")],1)],1)])])])],1)],1)],1)],1),a("b-modal",{ref:"delete-quotation",attrs:{"hide-footer":"",title:t.$t("delete")}},[a("p",{staticClass:"text-danger text-center"},[t._v(t._s(t.$t("decide_delete")))]),a("b-row",[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.cancelDeletion()}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"danger"},on:{click:function(e){return t.decideToDeleteQuotation()}}},[t._v(t._s(t.$t("delete")))])],1)],1)],1)],1)},bt=[],vt=a("b85c"),ht=(a("4de4"),a("b0c0"),a("13d5"),a("a434"),a("b680"),a("e9c4"),a("c1df")),gt=a.n(ht),_t="api/preRegistration",yt=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllPreRegistrationCustomers",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get(_t+"?status="+t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"deletePreRegistration",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(_t,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"validateRegistration",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post("".concat(_t,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),xt=yt,wt="api/proforma",Ct=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllProforma",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(wt,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getProformaById",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(wt,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"deleteProforma",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(wt,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertProforma",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(wt,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),kt=Ct,Tt=a("e499"),Rt=a.n(Tt),Pt=a("4ebb"),St=a.n(Pt);gt.a.locale("pt-br"),Rt.a.vfs=St.a.pdfMake.vfs;var Dt=r["default"].extend({name:"Quotation",props:["pendingRegistrations","invoiceId"],data:function(){return{isLoading:!1,currentQuotation:{},invalidationQuotationId:0,products:[],productId:0,item:"",productName:0,price:0,quantity:1,total:0,vat:.16,subTotalVat:0,dateOfQuote:gt()(new Date).format("YYYY-MM-DD"),customerName:"",customerPhoneNumber:"",customerAddress:"",customerNuit:"",productList:[{value:0,text:"Seleccione um item",price:0},{value:1,text:"Kit de ligação de água doméstico",price:2852},{value:2,text:"Kit de ligação de água público, comercial e industrial",price:5500},{value:3,text:"Supervisão técnica",price:1165.09},{value:4,text:"Abertura de cabocos e assentamento da tubagem",price:30},{value:5,text:"Tubo copoleno 3/4 barra azul",price:45},{value:6,text:'Tubo copoleno 1" barra azul',price:55},{value:7,text:"Tubo copoleno 50mm barra azul",price:90},{value:8,text:"Tampão de 50mm",price:500},{value:9,text:"Tê de redução de (63/50)mm",price:950},{value:10,text:"Contador pré-pago",price:9623.93}],termsAndConditions:"Todos os materiais e equipamentos fornecidos pela TSENANE, LDA observam os melhores padrões de qualidade, tem garantia de 12 meses contra defeito de fabrico e se a observarem as  recomendações  de Instalação e do transporte."}},created:function(){},watch:{productName:function(){var t=this,e=this.productList.filter((function(e){return e.value==t.productName}));this.item=e[0].text,this.price=e[0].price}},computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","company"])),methods:{opendQuotationForm:function(t){this.currentQuotation=t,this.customerName=t.name,this.customerPhoneNumber=t.phoneNumber,this.customerAddress=t.address,this.customerNuit=t.nuit,this.$refs["quotation"].show()},refreshPreRegistration:function(){this.$emit("update-quotation")},deletePreregistration:function(t){this.invalidationQuotationId=t.id,this.$refs["delete-quotation"].show()},cancelDeletion:function(){this.invalidationQuotationId=0,this.$refs["delete-quotation"].hide()},decideToDeleteQuotation:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,xt.deletePreRegistration(t.invalidationQuotationId,t.token);case 4:a=e.sent,1==a.success?(t.$bvToast.toast("Item excluído com sucesso!",{title:"Sucesso!",variant:"success",solid:!0}),t.$emit("update-quotation")):t.$bvToast.toast(a.message,{title:"Sucesso!",variant:"success",solid:!0}),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0});case 11:t.$refs["delete-quotation"].hide();case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},addProdutToCart:function(){""!=this.item?this.price<10?this.$bvToast.toast("Digite um preço válido!",{title:"Erro!",variant:"danger",solid:!0}):this.quantity<1?this.$bvToast.toast("Digite uma quantidade válida!",{title:"Erro!",variant:"danger",solid:!0}):(this.products.push({id:0==this.productId?1:this.productId++,item:this.item,quantity:this.quantity,price:this.price}),this.item="",this.quantity=1,this.price=0,this.productName=0):this.$bvToast.toast("Digite o nome do produto por favor!",{title:"Erro",variant:"danger",solid:!0})},calculateSubTotal:function(){var t=this.products.reduce((function(t,e){return t+e.quantity*e.price}),0);return this.subTotalVat=t*this.vat,t},clearInvoice:function(){this.products=[],this.$refs["quotation"].hide()},deleteItemInCart:function(t){var e=this.products.indexOf(t);this.products.splice(e,1)},saveProforma:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r,n,s,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=[],r=Object(vt["a"])(t.products);try{for(r.s();!(n=r.n()).done;)s=n.value,i=[],i.push({text:s.item,fontSize:9}),i.push({text:parseFloat(s.price).toFixed(2),fontSize:9,alignment:"right"}),i.push({text:s.quantity,fontSize:9,alignment:"right"}),i.push({text:(parseFloat(s.quantity)*parseFloat(s.price)).toFixed(2),fontSize:9,alignment:"right"}),a.push(i)}catch(c){r.e(c)}finally{r.f()}return e.next=5,t.getBase64ImageFromURL("https://saaf-tsenane.herokuapp.com/img/logo_12.2b7a27d2.jpeg");case 5:e.t0=e.sent,e.t1=[30,0,0,0],e.t2={image:e.t0,width:300,height:200,margin:e.t1},e.t3=[e.t2],e.t4={columns:[{text:"Documento processado por computador",alignment:"left",fontSize:8,margin:[30,0,0,0]},{text:"TSENANE Software",alignment:"right",fontSize:8,margin:[0,0,30,0]}]},e.t5=[{columns:[[{text:"Factura Proforma Nº: "+t.invoiceId+"/SAAF/"+(new Date).getFullYear(),fontSize:10,bold:!0,alignment:"right"},{text:"\nData de emissão: ".concat(gt()().format("DD-MM-YYYY")),fontSize:8,alignment:"right"},{text:"Validade da proposta: 14 dias",fontSize:8,alignment:"right"}]]},{text:"\n\n\n\n\n\n\n\n\n\n"},{text:"Exmo(s) Sr(s): ".concat(t.customerName),bold:!0,fontSize:12},{text:"Endereço: ".concat(t.customerAddress),style:"customerStyle"},{text:"Telefone: ".concat(t.customerPhoneNumber),style:"customerStyle"},{text:"NUIT: ".concat(t.customerNuit),style:"customerStyle"},{text:"E-mail: ".concat(t.currentQuotation.email),style:"customerStyle"},{text:"\n\n"},{table:{widths:["*","auto","auto","auto"],body:[[{text:"Descrição do produto",style:"columnsTitle"},{text:"Preço unitário",style:"columnsTitle",alignment:"center"},{text:"Qtd",style:"columnsTitle",alignment:"center"},{text:"Subtotal",style:"columnsTitle",alignment:"right"}]].concat(a,[[{text:"\n\n\n\n\n\n\n",colSpan:4},{},{},{}],[{text:"Subtotal",colSpan:3,style:"columnsSubTotals"},{},{},{text:t.calculateSubTotal().toFixed(2),style:"columnsSubTotals",alignment:"right"}],[{text:"IVA - 16%",colSpan:3,style:"columnsSubTotals"},{},{},{text:(t.calculateSubTotal()*t.vat).toFixed(2),style:"columnsSubTotals",alignment:"right"}],[{text:"Total a pagar",colSpan:3,style:"columnsTotal"},{},{},{text:(t.calculateSubTotal()*t.vat+t.calculateSubTotal()).toFixed(2)+" MZN",style:"columnsTotal",alignment:"right"}]])},layout:"lightHorizontalLines"},{text:"\n"},{text:"Detalhes sobre meio de pagamentos:\n",style:"paymentMethodStyle"},{ul:[{text:"BANCO: BCI",fontSize:9},{text:"TITULAR: "+t.company[0].name,fontSize:9},{text:t.company[0].bankAccount2,fontSize:9},{text:t.company[0].nib2,fontSize:9}]},{text:"\n"},{text:"Termos comerciais da proposta:\n",style:"paymentMethodStyle"},{ul:[{text:t.termsAndConditions,fontSize:9,italics:"Courier-Oblique"},{text:"A empresa reserva-se o direito de efectuar o débito de juros caso este documento não seja liquidado até ao seu vencimento.",fontSize:9,alignment:"left",italics:"Courier-Oblique"}]}],e.t6={paymentMethodStyle:{bold:!0,fontSize:10},sectionHeader:{bold:!0,fontSize:10,margin:[0,15,0,15]},columnsTitle:{fontSize:10,bold:!0,color:"#000000"},columnsSubTotals:{fontSize:10,bold:!0,color:"#000000"},columnsTotal:{fontSize:12,bold:!0,color:"#000000"},companyDetailsStyle:{fontSize:9,bold:!0,color:"#000000"},customerStyle:{fontSize:10,bold:!1}},o={header:e.t3,footer:e.t4,content:e.t5,styles:e.t6},Rt.a.createPdf(o).open(),t.products=[],t.$emit("update-quotation");case 16:case"end":return e.stop()}}),e)})))()},getBase64ImageFromURL:function(t){return new Promise((function(e,a){var r=new Image;r.setAttribute("crossOrigin","anonymous"),r.onload=function(){var t=document.createElement("canvas");t.width=r.width,t.height=r.height;var a=t.getContext("2d");a.drawImage(r,0,0);var n=t.toDataURL("image/png");e(n)},r.onerror=function(t){a(t)},r.src=t}))},insertProforma:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=t.customerName&&""!=t.customerAddress){e.next=3;break}return t.$bvToast.toast("Digite o nome do cliente e um endereço válido por favor!",{title:"Nome | Endereço",variant:"danger",solid:!0}),e.abrupt("return");case 3:return t.isLoading=!0,a={invoiceId:t.invoiceId,preRegistrationId:t.currentQuotation.id,customerName:t.customerName,customerAddress:t.customerAddress,customerPhoneNumber:t.customerPhoneNumber,customerNuit:t.customerNuit,customerEmail:t.currentQuotation.customerEmail,staffName:t.user[0].name,itemsDetails:JSON.stringify(t.products)},e.prev=5,e.next=8,kt.insertProforma(a,t.token);case 8:r=e.sent,1==r.success?(t.$bvToast.toast(r.message,{title:"Sucesso!",variant:"success",solid:!0}),t.$refs["quotation"].hide(),t.$emit("update-quotation"),t.saveProforma()):(t.$bvToast.toast(r.message,{title:"Erro!",variant:"danger",solid:!0}),t.$refs["quotation"].hide()),e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](5),t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0}),t.$refs["quotation"].hide();case 16:t.isLoading=!1;case 17:case"end":return e.stop()}}),e,null,[[5,12]])})))()}}}),$t=Dt,At=Object(u["a"])($t,ft,bt,!1,null,null,null),It=At.exports,Ot="api/search_customer",Nt=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getCustomers",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get("".concat(Ot,"?prepaid=1"),{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"searchCustomers",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Ot,"/").concat(t,"/1"),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertOrUpdateCustomer",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Ot,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Mt=Nt,zt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pending-readings"},[a("b-card",{staticClass:"mb-0"},[a("b-row",{staticClass:"mb-2"},[a("b-col",{attrs:{cols:"6"}},[a("b",{staticClass:"text-black"},[t._v("Fila de validação de leituras")])]),a("b-col",[a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.branchId,callback:function(e){t.branchId=e},expression:"branchId"}},t._l(t.branches,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),a("b-col",{staticClass:"text-right",staticStyle:{cursor:"pointer"},attrs:{cols:"1"},on:{click:function(e){return t.getPendingReadins()}}},[a("b-button",{attrs:{pill:"",variant:"success",size:"sm"}},[a("b-icon",{attrs:{variant:"light",icon:"arrow-clockwise"}})],1)],1)],1),a("hr",{staticClass:"bg-primary mt-1 mb-1 w-1"}),a("b-overlay",{staticClass:"mt-2 mb-2 bg-white",attrs:{show:t.isLoading,rounded:"sm"}},[t.readings.length>0?a("table",{staticClass:"table table-sm table-hover mt-0",staticStyle:{width:"100%"}},[a("tbody",[a("tr",{staticClass:"bg-dark text-light",staticStyle:{"font-size":"9pt",cursor:"pointer","font-weight":"bold"}},[a("td",[t._v("Data")]),a("td",[t._v("Contador")]),a("td",[t._v("Anterior")]),a("td",[t._v("Actual")]),a("td",[t._v("Consumo")]),a("td",{staticClass:"text-center"},[t._v("Acções")])]),t._l(t.readings,(function(e){return a("tr",{key:e.id,staticStyle:{"font-size":"9pt",cursor:"pointer"}},[a("td",[t._v(t._s(e.createdAt))]),a("td",[t._v(t._s(e.barcode))]),a("td",[t._v(t._s(e.last)+" m "),a("sup",[t._v("3")])]),a("td",[t._v(t._s(e.current)+" m "),a("sup",[t._v("3")])]),a("td",[t._v(t._s(e.consumption)+" m "),a("sup",[t._v("3")])]),a("td",[a("b-row",{staticClass:"text-center",staticStyle:{"font-size":"10pt"}},[a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"primary"},expression:"{ variant: 'primary' }",modifiers:{hover:!0}}],staticClass:"text-primary",attrs:{title:"Validar leitura"},on:{click:function(a){return t.validateReading(e)}}},[a("b-icon",{attrs:{variant:"primary",icon:"eye-fill"}}),t._v(" Validar leitura")],1)],1)],1)])}))],2)]):a("b-alert",{staticClass:"mt-3",attrs:{variant:"danger",show:"",dismissible:""}},[t._v(t._s(t.errorMessage)+" "),a("b",[t._v("⇒")])])],1)],1),a("b-modal",{ref:"update-reading",attrs:{size:"xl","hide-footer":"",title:t.tariffId(t.currentReading.tarrifTypeId)}},[a("b-row",[a("b-col",{attrs:{lg:"4"}},[a("b-img",{staticClass:"mb-2",attrs:{thumbnail:"",fluid:"",src:null!=t.currentReading.waterMeterImageUrl?t.currentReading.waterMeterImageUrl:t.imageTemplate,alt:"Image 1",width:"380"}})],1),a("b-col",[t._v("Reading details")])],1),a("b-row",[a("b-col",[a("b-row",[a("b-col",{staticClass:"text-center"},[a("small",[t._v(t._s(t.$t("last")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"last"}},[a("b-form-input",{attrs:{type:"number",size:"sm",min:t.currentReading.last,disabled:""},model:{value:t.currentReading.last,callback:function(e){t.$set(t.currentReading,"last",e)},expression:"currentReading.last"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("current")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"current"}},[a("b-form-input",{attrs:{type:"number",size:"sm",min:t.currentReading.last},model:{value:t.current,callback:function(e){t.current=e},expression:"current"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("consumption")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"consumption"}},[a("b-form-input",{attrs:{type:"number",size:"sm",disabled:""},model:{value:t.consumption,callback:function(e){t.consumption=e},expression:"consumption"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.setReadingsUpdate(1)}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"warning"},on:{click:function(e){return t.setReadingsUpdate(2)}}},[t._v("Rejeitar")])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"success"},on:{click:function(e){return t.setReadingsUpdate(3)}}},[t._v("Validar")])],1)],1)],1)],1)],1)],1)},Bt=[],jt="api/reading",Et=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getReadings",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(jt,"?branchId=").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"getReadingsByCustomer",value:function(t,e,a){var r="Bearer "+a;return new Promise(function(){var a=Object(g["a"])(regeneratorRuntime.mark((function a(n,s){var i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,O.a.get("".concat(jt,"/").concat(t,"/").concat(e),{headers:{Authorization:r}});case 3:i=a.sent,o=i.data,n(o),a.next=11;break;case 8:a.prev=8,a.t0=a["catch"](0),s(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(t,e){return a.apply(this,arguments)}}())}},{key:"deleteReading",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(jt,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"updateReading",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put(jt,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"validateReading",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.patch(jt,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertReadings",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(jt,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Lt=Et,Vt={name:"pending-readings",data:function(){return{isLoading:!1,readings:[],currentReading:{},waterMeterImageUrl:"",branchId:145,errorMessage:"",consumption:0,current:0,imageTemplate:"https://firebasestorage.googleapis.com/v0/b/tsenane-994c3.appspot.com/o/images%2F20200900627_4029b1a2-530b-49c8-9e4f-c5ba98fd7887?alt=media&token=74344817-5d8f-4deb-94a6-e1d64e8cbd6d"}},computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","company","branches"])),watch:{current:function(){this.current<this.currentReading.last?this.consumption=0:this.consumption=parseFloat(this.current)-parseFloat(this.currentReading.last)}},created:function(){this.getPendingReadins()},methods:{getPendingReadins:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Lt.getReadings(t.branchId,t.token);case 4:a=e.sent,1==a.success?(t.readings=a.result,t.isLoading=!1):(t.readings=[],t.isLoading=!1,t.errorMessage=a.message),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0),t.isLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},validateReading:function(t){this.currentReading=t,this.consumption=t.consumption,this.current=t.current,this.$refs["update-reading"].show()},setReadingsUpdate:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.isLoading=!0,1==t)e.isLoading=!1,e.$refs["update-reading"].hide();else if(t>1){r=2==t?2:0,n={id:e.currentReading.id,status:r,current:e.current,consumption:e.consumption,consumoFacturado:e.consumption};try{s=Lt.validateReading(n,e.token),1==s.success?(e.isLoading=!1,console.log(s.message),e.$refs["update-reading"].hide(),e.getPendingReadins()):(e.isLoading=!1,e.$refs["update-reading"].hide(),console.log(s.message))}catch(i){e.$refs["update-reading"].hide(),e.isLoading=!1,console.log(i)}}case 2:case"end":return a.stop()}}),a)})))()},tariffId:function(t){return 1==t?"Tarifa Fontenária":2==t?"Tarifa Doméstica":3==t?"Tarifa Municipal":4==t?"Tarifa Comercial":5==t?"Tarifa Pública":6==t?"Tarifa Industrial":7==t?"Tarifa Toma de Água":void 0}}},Ft=Vt,Ut=Object(u["a"])(Ft,zt,Bt,!1,null,null,null),qt=Ut.exports,Wt=r["default"].extend({data:function(){return{isLoading:!1,show:!1,showChild:!1,searchValues:"",customers:[],error:!1,pendingRegistration:[],invoiceId:0}},components:{NavBar:pt,PulseLoader:ot["a"],Quotation:It,PendingReadings:qt},created:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.commit("SET_CUSTOMER_READINGS",null),t.getPreRegistrations(),t.getAllProforma();case 3:case"end":return e.stop()}}),e)})))()},computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","branches","provinces","districts","currentCustomer","currentBill","tariffs"])),watch:{},methods:{openVendingPanel:function(t){this.customers=[],this.$store.commit("SET_CURRENT_CUSTOMER",t),this.$router.push("/customerview")},getPreRegistrations:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.showPreReg=!0,a=0,e.prev=2,e.next=5,xt.getAllPreRegistrationCustomers(a,t.token);case 5:r=e.sent,1==r.success?(t.pendingRegistration=r.result,t.invoiceId=r.invoiceId):t.pendingRegistration=[],e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))()},searchCustomer:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.searchValues,t.show=!0,0!==a.length){e.next=7;break}return t.show=!1,t.error=!1,t.customers=[],e.abrupt("return");case 7:return e.prev=7,e.next=10,Mt.searchCustomers(t.searchValues,t.token);case 10:r=e.sent,1==r.success?(t.customers=r.result,t.show=!1,t.error=!1):(t.show=!1,t.customers=[],t.error=!0),e.next=19;break;case 14:e.prev=14,e.t0=e["catch"](7),t.$bvToast.toast(""+e.t0.message,{title:"Erro",variant:"danger",solid:!0}),t.show=!1,t.customers=[];case 19:case"end":return e.stop()}}),e,null,[[7,14]])})))()},tariffId:function(t){return 1==t?(this.quantityMinTariff=0,"Fontenária"):2==t?(this.quantityMinTariff=5,"Doméstica"):3==t?(this.quantityMinTariff=0,"Municipal"):4==t?(this.quantityMinTariff=15,"Comercial"):5==t?(this.quantityMinTariff=15,"Público"):6==t?(this.quantityMinTariff=15,"Industrial"):void 0},getAllProforma:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,kt.getAllProforma(t.token);case 4:a=e.sent,!0===a.success?(t.$store.commit("SET_PROFORMAS",a.result),t.isLoading=!1):(t.$bvToast.toast(a.message,{title:"Error!",variant:"info",solid:!0}),t.isLoading=!1,t.$store.commit("SET_PROFORMAS",[])),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](1),t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0}),t.$store.commit("SET_PROFORMAS",[]),t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))()}}}),Yt=Wt,Gt=(a("47bf"),Object(u["a"])(Yt,st,it,!1,null,"74e1d2fc",null)),Ht=Gt.exports,Qt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[a("div",{staticClass:"container-group"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("b-row",{staticClass:"mt-0"},[a("b-col",{attrs:{lg:"2",md:"4",sm:"12"}},[a("b-row",[a("b-col",{staticClass:"mt-0 text-primary",staticStyle:{cursor:"pointer"},attrs:{lg:"12",sm:"12",md:"12"},on:{click:function(e){return t.selectPanel(1)}}},[a("b-icon",{attrs:{icon:"map"}}),t._v("      Bairros ")],1),a("b-col",{staticClass:"mt-1",attrs:{lg:"12",sm:"12",md:"12"}},[a("router-link",{attrs:{to:"/tarrifs"}},[a("b-icon",{attrs:{icon:"tools"}}),t._v("      "+t._s(t.$t("tarrif")))],1)],1),a("b-col",{staticClass:"mt-1 text-primary",staticStyle:{cursor:"pointer"},attrs:{lg:"12",sm:"12",md:"12"},on:{click:function(e){return t.selectPanel(3)}}},[a("b-icon",{attrs:{icon:"gear-fill","aria-hidden":"true"}}),t._v("      "+t._s(t.$t("company_detail"))+" ")],1)],1)],1),a("b-col",{staticClass:"mt-0",attrs:{lg:"10",md:"8",sm:"12"}},[t.isLoading?a("b-row",[a("pulse-loader",{staticClass:"text-center mt-4"})],1):a("b-row",[2==t.currentPanel?a("b-col",[a("colaborator-table",{on:{"update-users":function(e){return t.getMembers()}}})],1):1==t.currentPanel?a("b-col",[a("branch-table",{on:{"update-branches":function(e){return t.getBranches()}}})],1):3==t.currentPanel?a("b-col",[a("company-table",{on:{"update-company":function(e){return t.getCompanyDetails()}}})],1):t._e()],1)],1)],1)],1)])])])],1)},Zt=[],Jt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-row",[a("b-col",{attrs:{lg:"10"}},[a("h5",{staticClass:"text-white"},[t._v(t._s(t.$t("staff_management")))])]),a("b-col",[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"success",block:"",size:"sm"},on:{click:function(e){return t.openModalUser()}}},[t._v(t._s(t.$t("new_staff"))+"      "),a("b-icon",{attrs:{icon:"person-plus-fill"}})],1)],1)],1),a("hr",{staticClass:"bg-info mt-2"}),a("b-row",[a("b-col",[a("table",{staticClass:"table table-sm table-stripped bg-white mt-1"},[a("thead",[a("tr",{staticClass:"primary"},[a("th",[a("small",[a("b",[t._v("ID")])])]),a("th",[a("small",[a("b",[t._v(t._s(t.$t("name")))])])]),a("th",[a("small",[a("b",[t._v(t._s(t.$t("email")))])])]),a("th",[a("small",[a("b",[t._v(t._s(t.$t("code")))])])]),a("th",[a("small",[a("b",[t._v(t._s(t.$t("phone")))])])]),a("th",[a("small",[a("b",[t._v(t._s(t.$t("neighbor")))])])]),a("th",[a("small",[a("b",[t._v(t._s(t.$t("user_role")))])])]),a("th",{staticClass:"text-center"},[a("small",[a("b",[t._v(t._s(t.$t("actions")))])])])])]),a("thead",t._l(t.companyStaff,(function(e){return a("tr",{key:e.id},[a("td",[a("small",[t._v(t._s(e.id))])]),a("td",[a("small",[t._v(t._s(e.name))])]),a("td",[a("small",[t._v(t._s(e.email))])]),a("td",[a("small",[t._v(t._s(e.code))])]),a("td",[a("small",[t._v(t._s(e.phoneNumber))])]),a("td",[a("small",[t._v(t._s(e.branchId))])]),a("td",[a("small",[t._v(t._s(1==e.userRole?t.$t("admin"):t.$t("normal")))])]),a("td",{staticClass:"text-center"},[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"secondary",size:"sm"},on:{click:function(a){return t.editUser(e)}}},[a("small",[t._v(t._s(t.$t("edit")))])]),t._v("     "),a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{disabled:"",variant:"warning",size:"sm"},on:{click:function(a){return t.deactivateUser(e)}}},[a("small",[t._v(t._s(1==e.status?t.$t("active"):t.$t("inactive")))])])],1)])})),0)])])],1),a("b-modal",{ref:"add-new-user",attrs:{"hide-footer":"",title:t.$t("new_staff")}},[a("small",[t._v(t._s(t.$t("select")+" "+t.$t("neighbor")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.selectedSubBranch,callback:function(e){t.selectedSubBranch=e},expression:"selectedSubBranch"}},t._l(t.branches,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1),a("small",[t._v(t._s(t.$t("staff_name")))]),a("b-form-group",{attrs:{id:"userName","label-for":"userName"}},[a("b-form-input",{attrs:{id:"userName",type:"text",required:"",size:"sm",placeholder:t.$t("staff_name")},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),a("small",[t._v(t._s(t.$t("phone")))]),a("b-form-group",{attrs:{id:"userPhone","label-for":"userPhone"}},[a("b-form-input",{attrs:{id:"userPhone",type:"number",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.userPhoneNumber,callback:function(e){t.userPhoneNumber=e},expression:"userPhoneNumber"}})],1),a("small",[t._v(t._s(t.$t("email")))]),a("b-form-group",{attrs:{id:"email","label-for":"email"}},[a("b-form-input",{attrs:{id:"email",type:"email",required:"",size:"sm",placeholder:t.$t("email")},model:{value:t.emailId,callback:function(e){t.emailId=e},expression:"emailId"}})],1),a("small",[t._v(t._s(t.$t("auth_code")))]),a("b-form-group",{attrs:{id:"userCode","label-for":"userCode"}},[a("b-form-input",{attrs:{id:"userCode",type:"number",size:"sm",disabled:""},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),a("div",[a("small",[t._v(t._s(t.$t("user_role")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.userRole,callback:function(e){t.userRole=e},expression:"userRole"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v(t._s(t.$t("admin")))]),a("b-form-select-option",{attrs:{value:"2"}},[t._v(t._s(t.$t("cashier")))]),a("b-form-select-option",{attrs:{value:"3"}},[t._v(t._s(t.$t("help_desk")))])],1)],1),a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:t.selectedSubBranch<=0||t.userName.length<=0||t.userPhoneNumber.length<9||1==t.isLoading,block:"",size:"sm"},on:{click:function(e){return t.addNewUser()}}},[t.isLoading?[t._v(" "+t._s(t.$t("submiting"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)},Kt=[],Xt={name:"Colaborator",computed:Object(_["a"])({},Object(f["b"])(["user","companyStaff","provinces","districts","branches","currentUser","token"])),created:function(){},data:function(){return{userName:"",userUid:"",userPhoneNumber:"",emailId:"",userRole:2,userStatus:1,selectedSubBranch:"",code:Math.floor(1e6*Math.random())+1,isLoading:!1,isEditing:!1,currentDeletion:""}},methods:{editUser:function(t){this.openModalUser(),this.isEditing=!0,this.userName=t.name,this.code=t.code,this.userRole=t.userRole,this.userPhoneNumber=t.phoneNumber,this.emailId=t.email,this.selectedSubBranch=t.branchId},openModalUser:function(){this.$refs["add-new-user"].show()},addNewUser:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={name:t.userName,phoneNumber:t.userPhoneNumber,email:t.emailId,userRole:t.userRole,status:t.userStatus,branchId:t.selectedSubBranch,companyId:t.currentUser[0].companyId,code:t.code,password:123456},t.isLoading=!0,e.prev=2,e.next=5,W.insertUser(a,t.token);case 5:r=e.sent,t.$bvToast.toast(t.userName+" foi cadastrado com sucesso.",{title:"Sucesso",variant:"success",solid:!0}),t.$refs["add-new-user"].hide(),t.clearFields(),t.isLoading=!1,t.$emit("update-users"),console.log(r),e.next=19;break;case 14:e.prev=14,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1,t.$emit("getMembers");case 19:case"end":return e.stop()}}),e,null,[[2,14]])})))()},clearFields:function(){this.userName="",this.phoneNumber="",this.userRole="",this.userPhoneNumber="",this.selectedSubBranch="",this.emailId="",this.code=Math.floor(1e6*Math.random())+1}}},te=Xt,ee=Object(u["a"])(te,Jt,Kt,!1,null,null,null),ae=ee.exports,re=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("b-row",[a("b-col",{attrs:{lg:"6",sm:"12",md:"12"}},[a("b-card",[a("b-row",[a("b-col",{staticClass:"text-center"},[a("b-form-group",{attrs:{id:"searchBranch","label-for":"searchBranch"}},[a("b-form-input",{attrs:{type:"text",placeholder:t.$t("search_neighborhoods"),disabled:t.user[0].userRole>1,size:"sm"},on:{keyup:function(e){return t.searchBranches()}},model:{value:t.searchBranch,callback:function(e){t.searchBranch=e},expression:"searchBranch"}})],1)],1),a("b-col",{staticClass:"text-primary text-right",staticStyle:{cursor:"pointer"},attrs:{lg:"4",sm:"12",md:"6"},on:{click:function(e){return t.openBranchModal()}}},[a("b-icon",{attrs:{icon:"plus"}}),t._v(" Novo bairro")],1)],1),a("table",{staticClass:"table table-sm table-hover table-stripped bg-white mt-0"},[a("thead",{staticClass:"bg-secondary text-white"},[a("tr",[a("th",[t._v(t._s(t.$t("neighbor"))+" [ "+t._s(t.branches.length)+" ]")]),a("th",[t._v(t._s(t.$t("created_at")))]),a("th",{staticClass:"text-center"},[t._v(t._s(t.$t("actions")))])])]),a("tbody",t._l(t.branchesLocal,(function(e){return a("tr",{key:e.id,staticStyle:{cursor:"pointer"}},[a("td",[a("small",[t._v(t._s(e.name))])]),a("td",[a("small",{directives:[{name:"date-format",rawName:"v-date-format",value:e.createdAt,expression:"branch.createdAt"}]})]),a("td",[a("b-row",[a("b-col",{staticClass:"text-danger",on:{click:function(a){return t.deleteBranch(e)}}},[a("b-icon",{attrs:{icon:"trash"}})],1),a("b-col",{staticClass:"text-primary",on:{click:function(a){return t.editBranch(e)}}},[a("b-icon",{attrs:{icon:"pen"}})],1),a("b-col",{staticClass:"text-primary",on:{click:function(a){return t.checkUsers(e)}}},[a("b-icon",{attrs:{icon:"people-fill"}})],1)],1)],1)])})),0)])],1)],1),a("b-col",[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[a("staff-list-by-store",{on:{"update-users":function(e){return t.checkUsers(t.currentBranch)}}})],1)],1)],1),a("b-modal",{ref:"add-new-branch",attrs:{"hide-footer":"",title:t.$t("new")}},[a("small",[t._v(t._s(t.$t("province")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm",disabled:t.isEditing},model:{value:t.provinceId,callback:function(e){t.provinceId=e},expression:"provinceId"}},t._l(t.provinces,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id,disabled:t.isLoading}},[t._v(t._s(e.name))])})),1),a("small",[t._v(t._s(t.$t("district")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm",disabled:t.isEditing},model:{value:t.districtId,callback:function(e){t.districtId=e},expression:"districtId"}},t._l(t.selectedDistricts,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id,disabled:t.provinceId<=0}},[t._v(t._s(e.name))])})),1),a("small",[t._v(t._s(t.$t("neighbor")))]),a("b-form-group",{attrs:{id:"branchName","label-for":"branchName"}},[a("b-form-input",{attrs:{id:"branchName",type:"text",size:"sm",placeholder:t.$t("neighbor")},model:{value:t.branchName,callback:function(e){t.branchName=e},expression:"branchName"}})],1),t.isEditing?a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:0==t.branchName.length,block:"",size:"sm"},on:{click:function(e){return t.addNewBranch()}}},[t.isLoading?[t._v(" "+t._s(t.$t("saving"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("update")))]],2):a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:0==t.branchName.length||t.provinceId<=0||t.districtId<=0,block:"",size:"sm"},on:{click:function(e){return t.addNewBranch()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1),a("b-modal",{ref:"delete-branch",attrs:{"hide-footer":"",title:t.$t("delete")}},[a("p",{staticClass:"text-danger text-center"},[t._v(t._s(t.$t("decide_delete")))]),a("b-row",[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.cancelDeletion()}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"danger"},on:{click:function(e){return t.decidedToDelete()}}},[t._v(t._s(t.$t("delete")))])],1)],1)],1)],1)},ne=[],se=(a("841c"),"api/search_branch"),ie=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"search",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(se,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),oe=ie,ce=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{name:"staff-list-by-store"}},[a("b-card",{staticClass:"mt-0"},[a("b-row",{staticClass:"mb-1"},[a("b-col",[a("h5",{staticClass:"text-black"},[a("small",[t._v(t._s(t.currentBranch.name)+" [ "),a("small",[t._v(t._s(t.currentBranchUserList.length+" "+t.$t("staff_list")))]),t._v(" ]")])])]),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},attrs:{lg:"4",md:"6",sm:"6"},on:{click:function(e){return t.openModalUser()}}},[a("b-icon",{attrs:{icon:"person-plus-fill"}}),t._v(" "+t._s(t.$t("new_staff")))],1)],1),t.currentBranchUserList.length>0?a("table",{ref:"generate_pdf",staticClass:"table table-sm table-stripped table-hover",attrs:{id:"users-list"}},[a("thead",{staticClass:"bg-secondary text-white"},[a("tr",[a("th",[t._v(t._s(t.$t("name")))]),a("th",[t._v(t._s(t.$t("phone")))]),a("th",[t._v(t._s(t.$t("profile")))]),a("th",[t._v(t._s(t.$t("status")))])])]),a("tbody",t._l(t.currentBranchUserList,(function(e){return a("tr",{key:e.id,class:{active:1==e.status,"bg-secondary":0==e.status},on:{click:function(a){return t.editUser(e)}}},[a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.phoneNumber))]),a("td",[t._v(t._s(t.getUserRole(e.userRole)))]),a("td",[t._v(t._s(1==e.status?t.$t("active"):t.$t("inactive")))])])})),0)]):a("p",{staticClass:"text-danger text-left"},[a("small",[a("em",[t._v(t._s(t.$t("no_users")))])])])],1),a("b-modal",{ref:"add-new-user",attrs:{"hide-footer":"",title:t.currentBranch.name+": "+t.$t("new_staff")}},[a("small",[t._v(t._s(t.$t("staff_name")))]),a("b-form-group",{attrs:{id:"userName","label-for":"userName"}},[a("b-form-input",{attrs:{type:"text",required:"",size:"sm",placeholder:t.$t("staff_name")},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}})],1),a("small",[t._v(t._s(t.$t("phone")))]),a("b-form-group",{attrs:{id:"userPhone","label-for":"userPhone"}},[a("b-form-input",{attrs:{id:"userPhone",type:"number",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.userPhoneNumber,callback:function(e){t.userPhoneNumber=e},expression:"userPhoneNumber"}})],1),a("small",[t._v(t._s(t.$t("email")))]),a("b-form-group",{attrs:{id:"email","label-for":"email"}},[a("b-form-input",{attrs:{id:"email",type:"email",required:"",size:"sm",placeholder:t.$t("email")},model:{value:t.emailId,callback:function(e){t.emailId=e},expression:"emailId"}})],1),t.isEditing?t._e():a("small",[t._v(t._s(t.$t("auth_code")))]),t.isEditing?t._e():a("b-form-group",{attrs:{"label-for":"userCode"}},[a("b-form-input",{attrs:{id:"userCode",type:"number",size:"sm",disabled:""},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("user_role")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.userRole,callback:function(e){t.userRole=e},expression:"userRole"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v(t._s(t.$t("admin")))]),a("b-form-select-option",{attrs:{value:"2"}},[t._v("Atendimento")]),a("b-form-select-option",{attrs:{value:"3"}},[t._v("Caixa")]),a("b-form-select-option",{attrs:{value:"4"}},[t._v("Analista de leituras")])],1)],1),a("b-col",[a("small",[t._v("Status")]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.userStatus,callback:function(e){t.userStatus=e},expression:"userStatus"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v(t._s(t.$t("active")))]),a("b-form-select-option",{attrs:{value:"0"}},[t._v(t._s(t.$t("inactive")))])],1)],1)],1),a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:t.userName.length<=0||t.userPhoneNumber.length<9||1==t.isLoading,block:"",size:"sm"},on:{click:function(e){return t.addNewUser()}}},[t.isLoading?[t._v(" "+t._s(t.$t("submiting"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)},le=[],ue={name:"staff-list",computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","currentBranchUserList","companyStaff","provinces","districts","branches","currentBranch"])),data:function(){return{show:!1,userName:"",userUid:"",userPhoneNumber:"",emailId:"",userRole:1,userStatus:1,id:0,code:Math.floor(1e6*Math.random())+1,isLoading:!1,isEditing:!1,currentDeletion:""}},created:function(){},methods:{getUserRole:function(t){return 1==t?"Administrador":2==t?"Atendimento":3==t?"Caixa":4==t?"Analista de leitura":void 0},editUser:function(t){this.openModalUser(),this.isEditing=!0,this.userName=t.name,this.code=t.code,this.userRole=t.userRole,this.userPhoneNumber=t.phoneNumber,this.emailId=t.email,this.userStatus=t.status,this.id=t.id},openModalUser:function(){this.$refs["add-new-user"].show()},addNewUser:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={name:t.userName,phoneNumber:t.userPhoneNumber,email:t.emailId,userRole:t.userRole,status:t.userStatus,branchId:t.currentBranch.id,companyId:t.currentUser[0].companyId,code:t.code,id:t.id},t.isLoading=!0,e.prev=2,e.next=5,W.insertUser(a,t.token);case 5:r=e.sent,t.$bvToast.toast(r.message,{title:"Sucesso",variant:"success",solid:!0}),t.$refs["add-new-user"].hide(),t.clearFields(),t.isLoading=!1,t.$emit("update-users"),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1,t.$emit("getMembers");case 18:case"end":return e.stop()}}),e,null,[[2,13]])})))()},clearFields:function(){this.userName="",this.phoneNumber="",this.userRole="",this.userPhoneNumber="",this.emailId="",this.id=0,this.code=Math.floor(1e6*Math.random())+1}}},de=ue,me=(a("512f"),Object(u["a"])(de,ce,le,!1,null,"eaf787a4",null)),pe=me.exports,fe={name:"BranchTable",components:{"staff-list-by-store":pe},watch:{provinceId:function(){var t=this;this.selectedDistricts=this.districts.filter((function(e){return e.provinceId===t.provinceId}))}},computed:Object(_["a"])({},Object(f["b"])(["user","companyStaff","provinces","districts","branches","currentUser","token","currentBranch"])),created:function(){this.branchesLocal=this.branches,this.checkUsers(this.branches[0])},data:function(){return{show:!1,saveBranchOrEdit:"Novo Bairro",provinceId:0,districtId:0,id:0,selectedDistricts:"",branchName:"",isLoading:!1,isEditing:!1,branchesLocal:[],currentDeletion:"",searchBranch:""}},methods:{checkUsers:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.show=!0,e.$store.commit("SET_CURRENT_BRANCH",t),a.prev=2,a.next=5,W.getAllUsers(t.id,e.token);case 5:r=a.sent,1==r.success?e.$store.commit("SET_CURRENT_BRANCH_USER_LIST",r.result):e.$store.commit("SET_CURRENT_BRANCH_USER_LIST",[]),e.show=!1,a.next=15;break;case 10:a.prev=10,a.t0=a["catch"](2),e.$store.commit("SET_CURRENT_BRANCH_USER_LIST",[]),console.log(a.t0),e.show=!1;case 15:case"end":return a.stop()}}),a,null,[[2,10]])})))()},searchBranches:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=t.searchBranch&&""!=t.searchBranch){e.next=3;break}return t.branchesLocal=t.branch,e.abrupt("return");case 3:return e.prev=3,e.next=6,oe.search(t.searchBranch,t.token);case 6:a=e.sent,t.branchesLocal=a.result,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](3),t.branchesLocal=t.branch,t.$bvToast.toast(""+e.t0,{title:"Erro",variant:"danger",solid:!0});case 14:case"end":return e.stop()}}),e,null,[[3,10]])})))()},editBranch:function(t){this.openBranchModal(),this.saveBranchOrEdit="Alterar "+t.name,this.isEditing=!0,this.branchName=t.name,this.id=t.id},deleteBranch:function(t){this.$refs["delete-branch"].show(),this.currentDeletion=t.id},cancelDeletion:function(){this.$refs["delete-branch"].hide()},decidedToDelete:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H.deleteBranch(t.currentDeletion,t.token);case 3:a=e.sent,console.log(a),t.$bvToast.toast("Deletado com sucesso!",{title:"Deletado",variant:"success",solid:!0}),t.$refs["delete-branch"].hide(),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),t.$bvToast.toast(""+e.t0,{title:"Erro",variant:"danger",solid:!0}),t.$refs["delete-branch"].hide();case 13:t.$emit("update-branches");case 14:case"end":return e.stop()}}),e,null,[[0,9]])})))()},addNewBranch:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.branchName.length<=3)){e.next=4;break}t.$bvToast.toast("Nome do Bairro deve ter pelo menos 3 caracteres!",{title:"Aviso!",variant:"warning",solid:!0}),e.next=19;break;case 4:return a={id:0==t.id?0:t.id,companyId:t.currentUser[0].companyId,provinceId:t.provinceId,districtId:t.districtId,name:t.branchName},t.isLoading=!0,e.prev=6,e.next=9,H.insertOrUpdateBranch(a,t.token);case 9:r=e.sent,1==r.success?(t.$bvToast.toast(t.branchName+" foi gravado com sucesso.",{title:"Sucesso",variant:"success",solid:!0}),t.$store.commit("SET_BRANCHES",r.result),t.$emit("update-branches"),t.$refs["add-new-branch"].hide(),t.clearFields(),t.isLoading=!1):t.$bvToast.toast(r.message,{title:"Erro",variant:"danger",solid:!0}),e.next=19;break;case 13:e.prev=13,e.t0=e["catch"](6),t.$bvToast.toast(e.t0.message,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1,t.$refs["add-new-branch"].hide(),t.$emit("update-branches");case 19:case"end":return e.stop()}}),e,null,[[6,13]])})))()},openBranchModal:function(){this.isEditing=!1,this.$refs["add-new-branch"].show()},clearFields:function(){this.provinceId=0,this.districtId=0,this.branchName=""}}},be=fe,ve=(a("e8de"),Object(u["a"])(be,re,ne,!1,null,"ae7ae4ee",null)),he=ve.exports,ge=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"company-table"},[r("b-card",{staticClass:"mt-0"},[r("b-row",{staticClass:"mb-1"},[r("b-col",[r("h5",{staticClass:"text-black"},[t._v(" "+t._s(t.company[0].name)+" ")]),r("hr"),t._v(" "+t._s(t.company[0].address)+" "),r("hr"),t._v(" "+t._s(t.company[0].phone)+" "),r("hr"),t._v(" "+t._s(t.company[0].email)+" "),r("hr"),t._v(" NUIT: "+t._s(t.company[0].nuit)+" "),r("hr"),t._v(" "+t._s(t.company[0].bankAccount)+" "),r("hr"),t._v(" "+t._s(t.company[0].nib)+" ")]),r("b-col",{staticClass:"text-center bg-dark p-3",attrs:{lg:"4",md:"6",sm:"6"}},[r("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{block:"",variant:"",size:"sm"},on:{click:function(e){return t.openCompanyModal()}}},[r("i",{staticClass:"fas fa-edit"}),t._v("      "),r("span",[t._v(t._s(t.$t("edit-company-details")))])]),r("br"),r("img",{staticStyle:{"border-radius":"40%"},attrs:{src:a("ac2b"),alt:"TsenaneApp",width:"200"}})],1)],1)],1),r("b-modal",{ref:"edit-company",attrs:{"hide-footer":"",title:t.$t("edit-company-details")}},[r("small",[t._v(t._s(t.$t("company")))]),r("b-form-group",{attrs:{id:"company","label-for":"company"}},[r("b-form-input",{attrs:{type:"text",required:"",size:"sm",placeholder:t.$t("company")},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),r("small",[t._v(t._s(t.$t("phone")))]),r("b-form-group",{attrs:{id:"phone","label-for":"phone"}},[r("b-form-input",{attrs:{type:"text",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),r("small",[t._v(t._s(t.$t("address")))]),r("b-form-group",{attrs:{id:"address","label-for":"address"}},[r("b-form-input",{attrs:{type:"text",required:"",size:"sm",placeholder:t.$t("address")},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1),r("small",[t._v(t._s(t.$t("email")))]),r("b-form-group",{attrs:{id:"email","label-for":"email"}},[r("b-form-input",{attrs:{type:"text",required:"",size:"sm",placeholder:t.$t("email")},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),r("small",[t._v(t._s(t.$t("nuit")))]),r("b-form-group",{attrs:{id:"nuit","label-for":"nuit"}},[r("b-form-input",{attrs:{type:"number",required:"",size:"sm",placeholder:t.$t("nuit")},model:{value:t.nuit,callback:function(e){t.nuit=e},expression:"nuit"}})],1),r("small",[t._v(t._s(t.$t("bank-account")))]),r("b-form-group",{attrs:{id:"bank-account","label-for":"bank-account"}},[r("b-form-input",{attrs:{type:"text",required:"",size:"sm",placeholder:t.$t("bank-account")},model:{value:t.bankAccount,callback:function(e){t.bankAccount=e},expression:"bankAccount"}})],1),r("small",[t._v(t._s(t.$t("nib")))]),r("b-form-group",{attrs:{id:"nib","label-for":"nib"}},[r("b-form-input",{attrs:{type:"text",required:"",size:"sm",placeholder:t.$t("nib")},model:{value:t.nib,callback:function(e){t.nib=e},expression:"nib"}})],1),r("b-button",{staticClass:"mt-3 sm",attrs:{disabled:t.name.length<=3||t.bankAccount.length<5||1==t.isLoading,block:"",size:"sm"},on:{click:function(e){return t.submitCompanyDetails()}}},[t.isLoading?[t._v(" "+t._s(t.$t("submiting"))+" "),r("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)},_e=[],ye={name:"Company",computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","company"])),data:function(){return{isLoading:!1,name:"",phone:"",email:"",nuit:"",bankAccount:"",nib:"",address:""}},created:function(){},methods:{populateCompanyData:function(){this.name=this.company[0].name,this.nuit=this.company[0].nuit,this.phone=this.company[0].phone,this.email=this.company[0].email,this.address=this.company[0].address,this.status=1,this.bankAccount=this.company[0].bankAccount,this.nib=this.company[0].nib},openCompanyModal:function(){this.populateCompanyData(),this.$refs["edit-company"].show()},submitCompanyDetails:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=t.name.length){e.next=4;break}t.$bvToast.toast("O campo Nome é de preenchimento obrigatório",{title:"",variant:"warning",solid:!0}),e.next=38;break;case 4:if(!(t.phone.length<9)){e.next=8;break}t.$bvToast.toast("O campo Telefone é de preenchimento obrigatório",{title:"",variant:"warning",solid:!0}),e.next=38;break;case 8:if(9==t.nuit.length){e.next=12;break}t.$bvToast.toast("O campo NUIT deve conter 9 dígitos.",{title:"",variant:"warning",solid:!0}),e.next=38;break;case 12:if(0!=t.address.length){e.next=16;break}t.$bvToast.toast("O campo Endereço é de preenchimento obrigatório.",{title:"",variant:"warning",solid:!0}),e.next=38;break;case 16:if(0!=t.bankAccount.length){e.next=20;break}t.$bvToast.toast("O campo Conta Bancária é de preenchimento obrigatório.",{title:"",variant:"warning",solid:!0}),e.next=38;break;case 20:if(0!=t.nib.length){e.next=24;break}t.$bvToast.toast("O campo NIB é de preenchimento obrigatório.",{title:"",variant:"warning",solid:!0}),e.next=38;break;case 24:return a={id:t.company[0].id,name:t.name,nuit:t.nuit,phone:t.phone,email:t.email,address:t.address,status:1,bankAccount:t.bankAccount,nib:t.nib},t.isLoading=!0,e.prev=26,e.next=29,J.insertOrUpdateCompanyDetail(a,t.token);case 29:r=e.sent,1==r.success?(t.$bvToast.toast(r.message,{title:"",variant:"success",solid:!0}),t.$store.commit("SET_COMPANY",r.result),t.populateCompanyData()):t.$bvToast.toast(r.message,{title:"",variant:"warning",solid:!0}),e.next=36;break;case 33:e.prev=33,e.t0=e["catch"](26),t.$bvToast.toast(e.t0.message,{title:"",variant:"danger",solid:!0});case 36:t.isLoading=!1,t.$refs["edit-company"].hide();case 38:case"end":return e.stop()}}),e,null,[[26,33]])})))()}}},xe=ye,we=Object(u["a"])(xe,ge,_e,!1,null,null,null),Ce=we.exports,ke={components:{NavBar:pt,PulseLoader:ot["a"],ColaboratorTable:ae,BranchTable:he,CompanyTable:Ce},watch:{provinceId:function(){var t=this;this.selectedDistricts=this.districts.filter((function(e){return e.provinceId===t.provinceId}))}},computed:Object(_["a"])({},Object(f["b"])(["user","companyStaff","provinces","districts","branches","currentUser","token"])),created:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.commit("SET_CLEAR_CURRENT_VENDING"),t.getMembers();case 2:case"end":return e.stop()}}),e)})))()},data:function(){return{userName:"",userUid:"",userPhoneNumber:"",userRole:2,userStatus:1,selectedSubBranch:"",code:Math.floor(Math.random()*this.userPhoneNumber)+1,isLoading:!1,currentPanel:1}},methods:{selectPanel:function(t){1==t?this.currentPanel=1:2==t?this.currentPanel=2:3==t&&(this.currentPanel=3)},clearFields:function(){this.userName="",this.phoneNumber="",this.userRole="",this.userPhoneNumber="",this.selectedSubBranch="",this.code=Math.floor(1e6*Math.random())+1},getMembers:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W.getAllUsers(t.currentUser[0].companyId,t.token);case 3:a=e.sent,t.$store.commit("SET_COMPANY_STAFF",a.result),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getBranches:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={companyId:t.currentUser[0].companyId,userRole:t.currentUser[0].userRole,branchId:t.currentUser[0].branchId},e.prev=2,e.next=5,H.getAllBranches(a,t.token);case 5:r=e.sent,1==r.success?(t.$store.commit("SET_BRANCHES",r.result),t.isLoading=!1):t.isLoading=!1,e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](2),t.error=e.t0.message,t.isLoading=!1,t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0});case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))()},getComanyDetails:function(){return Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:alert("Hello from company details");case 1:case"end":return t.stop()}}),t)})))()},getMeters:function(){console.log("Get meters")}}},Te=ke,Re=(a("7f77"),Object(u["a"])(Te,Qt,Zt,!1,null,"442b9b24",null)),Pe=Re.exports,Se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[a("div",{staticClass:"container-group"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("b-row",[a("b-col",{attrs:{lg:"3",md:"5",sm:"12"}},[a("b-input-group",{staticClass:"mb-2",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"person-fill"}})],1),a("b-form-input",{attrs:{type:"text",disabled:"",value:t.currentCustomer.name.toUpperCase()}})],1),a("b-input-group",{staticClass:"mb-2",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"speedometer"}})],1),a("b-form-input",{attrs:{type:"text",disabled:"",value:t.currentCustomer.barcode}})],1),a("b-input-group",{staticClass:"mb-2",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"bank"}})],1),a("b-form-input",{attrs:{type:"text",disabled:"",value:t.tariffId(t.currentCustomer.tarrifTypeId)}})],1),a("b-input-group",{staticClass:"mb-2",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"phone-fill"}})],1),a("b-form-input",{attrs:{type:"text",disabled:"",value:t.currentCustomer.phone}})],1),a("b-input-group",{staticClass:"mb-2",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"envelope"}})],1),a("b-form-input",{attrs:{type:"text",disabled:"",value:t.currentCustomer.email}})],1),a("b-input-group",{staticClass:"mb-2",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"map-fill"}})],1),a("b-form-input",{attrs:{type:"text",disabled:"",value:t.currentCustomer.address}})],1),a("b-row",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("b-col",{staticClass:"text-left"},[a("b-icon",{attrs:{variant:1==t.currentCustomer.status?"primary":"danger",icon:1==t.currentCustomer.status?"person-check-fill":"person-x-fill"}}),t._v(" "+t._s(1==t.currentCustomer.status?"Activo":"Desactivado"))],1),a("b-col",{staticClass:"text-center",attrs:{lg:"3"},on:{click:function(e){return t.editCustomer(t.currentCustomer)}}},[a("b-icon",{attrs:{variant:"primary",icon:"pencil-fill"}}),t._v(" Editar")],1),a("b-col",{staticClass:"text-right",on:{click:function(e){return t.showCredentials()}}},[a("b-icon",{attrs:{variant:"primary",icon:"unlock-fill"}}),t._v("Credenciais")],1)],1)],1),a("b-col",[a("b-overlay",{attrs:{show:t.isLoading,rounded:"sm"}},[t.readings?a("table",{staticClass:"table table-sm table-hover table-stripped"},[a("thead",[a("tr",{staticStyle:{"font-size":"9pt"}},[a("th",{staticClass:"text-right",attrs:{colspan:"10"}},[a("b-row",{staticClass:"text-center",staticStyle:{"font-size":"10pt"}},[a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"primary"},expression:"{ variant: 'primary' }",modifiers:{hover:!0}}],staticClass:"text-right",attrs:{title:"Nova Factura"},on:{click:function(e){return t.addNewPurchase()}}},[a("b-icon",{attrs:{variant:"success",icon:"cart-plus-fill"}}),a("small",[t._v(" Nova factura")])],1),a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"primary"},expression:"{ variant: 'primary' }",modifiers:{hover:!0}}],staticClass:"text-right",attrs:{title:"Adicionar Crédito"},on:{click:function(e){return t.addBalance()}}},[a("b-icon",{attrs:{variant:"success",icon:"plus"}}),a("b",{staticClass:"text-success",staticStyle:{"font-size":"10pt"}},[t._v("MZN")]),a("small",[t._v(" Crédito")])],1),a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"primary"},expression:"{ variant: 'primary' }",modifiers:{hover:!0}}],staticClass:"text-right",attrs:{title:"Baixar Extracto"},on:{click:function(e){return t.printCustomerStatement()}}},[a("b-icon",{attrs:{variant:"success",icon:"printer-fill"}}),a("small",[t._v(" Extracto")])],1),a("b-col",{staticClass:"text-right",on:{click:function(e){return t.openSmsModal()}}},[a("b-icon",{attrs:{variant:"success",icon:"chat-dots-fill"}}),a("small",[t._v(" SMS")])],1),a("b-col",{staticClass:"text-right",on:{click:function(e){return t.openWhatsAppModal()}}},[a("b-icon",{attrs:{variant:"success",icon:"whatsapp"}}),a("small",[t._v(" WhatsApp")])],1),a("b-col",{staticClass:"text-right",on:{click:function(e){return t.openEmailModal()}}},[a("b-icon",{attrs:{variant:"success",icon:"chat-left-fill"}}),a("small",[t._v(" E-mail")])],1),a("b-col",{staticClass:"text-right",on:{click:function(e){return t.refreshPage()}}},[a("b-icon",{attrs:{variant:"success",icon:"arrow-repeat"}}),a("small",[t._v(" Refresh")])],1)],1)],1)])]),a("thead",{staticClass:"bg-dark text-white",staticStyle:{"font-size":"8pt"}},[a("tr",[a("th",[a("b-icon",{attrs:{variant:"white",icon:"calendar-fill"}}),a("b",[t._v("Janeiro 2023")])],1),a("th",[t._v(t._s(t.$t("receipt")))]),a("th",[t._v(t._s(t.$t("current")))]),a("th",[t._v(t._s(t.$t("total_unities")))]),a("th",[t._v(t._s(t.$t("subtotal")))]),a("th",[t._v("IVA - 12%")]),a("th",[t._v(t._s(t.$t("penalty")))]),a("th",[t._v(t._s(t.$t("total_payable")))]),a("th",{staticClass:"text-center"},[t._v(t._s(t.$t("actions")))])])]),a("tbody",t._l(t.readings,(function(e){return a("tr",{key:e.id,staticClass:"align-middle",staticStyle:{cursor:"pointer","font-size":"8pt"}},[a("td",{staticClass:"align-middle"},[t._v(" "+t._s(t.convertMonthToString(e.consumptionPeriod))+" ")]),a("td",{staticClass:"align-middle"},[t._v(" "+t._s(e.receiptNumber)+"/SAAF/"+t._s(e.year)+" ")]),a("td",{staticClass:"align-middle"},[t._v(" "+t._s(e.current)+" m"),a("sup",[t._v("3")])]),a("td",{staticClass:"align-middle"},[t._v(" "+t._s(e.consumption)+" m"),a("sup",[t._v("3")])]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:e.subTotal,expression:"report.subTotal"}],staticClass:"align-middle"}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getVat(e),expression:"getVat(report)"}],staticClass:"align-middle"}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:e.forfeit*(e.subTotal+t.getVat(e)),expression:"\n                          report.forfeit * (report.subTotal + getVat(report))\n                        "}],staticClass:"align-middle"}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getTotal(e),expression:"getTotal(report)"}],staticClass:"align-middle"}),a("td",{staticClass:"align-middle"},[0==e.status?a("b-row",{staticClass:"text-center",staticStyle:{"font-size":"10pt"}},[a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"danger"},expression:"{ variant: 'danger' }",modifiers:{hover:!0}}],attrs:{title:t.$t("delete")},on:{click:function(a){return t.deleteReading(e.id)}}},[a("b-icon",{attrs:{variant:"danger",icon:"trash"}})],1),a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"info"},expression:"{ variant: 'info' }",modifiers:{hover:!0}}],attrs:{title:t.$t("edit")},on:{click:function(a){return t.updateBill(e)}}},[a("b-icon",{attrs:{variant:"info",icon:"pen"}})],1),a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"info"},expression:"{ variant: 'info' }",modifiers:{hover:!0}}],attrs:{title:t.$t("print")},on:{click:function(a){return t.generatePDF(e.uniqueBillId)}}},[a("b-icon",{attrs:{variant:"primary",icon:"printer-fill"}})],1)],1):-1==e.status?a("b-row",{staticStyle:{"font-size":"10pt"}},[a("b-col",{staticClass:"text-center text-warning"},[a("b-icon",{attrs:{icon:"check-square-fill"}}),a("small",[t._v(" Pendente")])],1)],1):1==e.status?a("b-row",{staticStyle:{"font-size":"10pt"}},[a("b-col",{staticClass:"text-center text-success"},[a("b-icon",{attrs:{icon:"check-square-fill"}}),a("small",[t._v(" Pago")])],1)],1):2==e.status?a("b-row",{staticStyle:{"font-size":"10pt"}},[a("b-col",{staticClass:"text-center text-danger"},[a("b-icon",{attrs:{icon:"trash-fill"}}),a("small",[t._v(" Rejeitada")])],1)],1):t._e()],1)])})),0)]):a("p",{staticClass:"text-danger text-left"},[a("small",[a("em",[t._v(t._s(t.$t("no_purchases")))])])]),a("table",{staticClass:"table table-sm table-hover table-stripped"},[a("thead",[a("tr",{staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"8"}},[a("b-icon",{attrs:{icon:"credit-card-fill"}}),t._v(" Extracto de pagamentos ")],1)])]),a("thead",[a("tr",{staticClass:"bg-dark text-white",staticStyle:{"font-size":"8pt"}},[a("th",[t._v("Data")]),a("th",[t._v("Validado aos")]),a("th",[t._v("Nº da Factura")]),a("th",[t._v("Referência")]),a("th",[t._v("Telemóvel")]),a("th",[t._v("Modo de pagamento")]),a("th",[t._v("Caixa")]),a("th",[t._v("Montante")])])]),a("tbody",t._l(t.payments,(function(e){return a("tr",{key:e.id,staticStyle:{"font-size":"8pt"}},[a("td",[t._v(t._s(e.dateOfPayment))]),a("td",[t._v(t._s(e.createdAt))]),a("td",[t._v(t._s(e.billId)+"/SAAF")]),a("td",[t._v(t._s(e.reference))]),a("td",[t._v(t._s(e.phoneNumber))]),a("td",[t._v(t._s(t.getPaymentMethod(e.paymentMethod)))]),a("td",[t._v(t._s(e.staffName))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:e.totalPaid,expression:"payment.totalPaid"}]})])})),0)])])],1),a("b-col",{attrs:{lg:"2",md:"4",sm:"12"}},[a("table",{staticClass:"table table-sm table-hover table-stripped"},[a("thead",[a("tr",{staticClass:"text-success",staticStyle:{"font-size":"9pt"}},[a("th",{staticClass:"text-left"},[t._v("Crédito")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentBalance,expression:"currentBalance"}],staticClass:"text-right"})]),a("tr",{staticClass:"text-danger",staticStyle:{"font-size":"9pt"}},[a("th",{staticClass:"text-left"},[t._v("Dívida anterior")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.saldoDivida,expression:"saldoDivida"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"2"}},[1==t.user[0].id||165==t.user[0].id?a("b-button",{attrs:{disabled:t.isLoading||0==t.saldoDivida,block:"",size:"sm",variant:"danger"},on:{click:function(e){return t.invalidateDebt()}}},[t._v("Invalidar Multa")]):t._e()],1)]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b-button",{attrs:{block:"",size:"sm",variant:"success"},on:{click:function(e){return t.addDebts()}}},[t._v("Adicionar Dívida")])],1)])])])])],1)],1)]),a("b-modal",{ref:"new-reading",attrs:{"hide-footer":"",title:t.tariffId(t.currentCustomer.tarrifTypeId)}},[a("b-row",[a("b-col",[a("b-row",[a("b-col",[t._v(" Período de facturação: "),a("b",[t._v(t._s(t.consumptionPeriod))])])],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("last")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"last"}},[a("b-form-input",{attrs:{type:"number",size:"sm",min:t.last},model:{value:t.last,callback:function(e){t.last=e},expression:"last"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("current")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"current"}},[a("b-form-input",{attrs:{type:"number",size:"sm",min:t.last},model:{value:t.current,callback:function(e){t.current=e},expression:"current"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("consumption")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"consumption"}},[a("b-form-input",{attrs:{type:"number",size:"sm",min:t.consumption,disabled:""},model:{value:t.consumption,callback:function(e){t.consumption=e},expression:"consumption"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-button",{attrs:{disabled:!t.current||t.isLoading,block:"",size:"sm",variant:"secondary"},on:{click:function(e){return t.addNewReading()}}},[t._v(t._s(t.$t("submit")))])],1)],1)],1)],1)],1),a("b-modal",{ref:"update-reading",attrs:{"hide-footer":"",title:t.tariffId(t.currentCustomer.tarrifTypeId)}},[a("div",{staticClass:"text-center"},[a("b-img",{staticClass:"mb-2",attrs:{thumbnail:"",fluid:"",src:null!=t.waterMeterImageUrl?t.waterMeterImageUrl:t.imageTemplate,alt:"Image 1",width:"250"}})],1),a("b-row",[a("b-col",[a("b-row",[a("b-col",{staticClass:"text-center"},[a("small",[t._v(t._s(t.$t("last")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"last"}},[a("b-form-input",{attrs:{type:"number",size:"sm",min:t.last},model:{value:t.last,callback:function(e){t.last=e},expression:"last"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("current")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"current"}},[a("b-form-input",{attrs:{type:"number",size:"sm",min:t.last},model:{value:t.current,callback:function(e){t.current=e},expression:"current"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("consumption")+" ")+"m "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"consumption"}},[a("b-form-input",{attrs:{type:"number",size:"sm",min:t.consumption,disabled:""},model:{value:t.consumption,callback:function(e){t.consumption=e},expression:"consumption"}})],1)],1)],1),a("b-row",[a("b-col",[1==t.user[0].id||165==t.user[0].id?a("b-button",{attrs:{block:"",size:"sm",variant:"secondary"},on:{click:function(e){return t.updateReading()}}},[t._v(t._s(t.$t("update")))]):t._e()],1)],1)],1)],1)],1),a("b-modal",{ref:"delete-reading",attrs:{"hide-footer":"",title:t.$t("delete")}},[a("p",{staticClass:"text-danger text-center"},[t._v(t._s(t.$t("decide_delete")))]),a("b-row",[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.cancelDeletion()}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[1==t.user[0].id||165==t.user[0].id?a("b-button",{attrs:{block:"",size:"sm",variant:"danger"},on:{click:function(e){return t.decidedToDelete()}}},[t._v(t._s(t.$t("delete")))]):t._e()],1)],1)],1),a("b-modal",{ref:"add-balance",attrs:{"hide-footer":"",size:"md",title:t.$t("add_balance")}},[a("b",[t._v(t._s(t.$t("balance_value")))]),a("b-form-group",{attrs:{"label-for":"credit_add"}},[a("b-form-input",{attrs:{id:"credit_add",type:"number",step:"any",required:"",min:"10",size:"sm",placeholder:t.$t("balance_value")},model:{value:t.amount2BeCredited,callback:function(e){t.amount2BeCredited=e},expression:"amount2BeCredited"}})],1),a("b",[t._v(t._s(t.$t("reference")))]),a("b-form-group",{attrs:{"label-for":"reference"}},[a("b-form-input",{attrs:{id:"reference",type:"text",required:"",size:"sm",placeholder:t.$t("reference")},model:{value:t.paymentReference,callback:function(e){t.paymentReference=e},expression:"paymentReference"}})],1),a("b",[t._v(t._s(t.$t("payment_method")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm",options:t.options},model:{value:t.paymentMethod,callback:function(e){t.paymentMethod=e},expression:"paymentMethod"}}),t.paymentMethod>=7?a("b",[t._v(t._s(t.$t("phone")))]):t._e(),t.paymentMethod>=7?a("b-form-group",{attrs:{"label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"text",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.phoneNumberOfPayment,callback:function(e){t.phoneNumberOfPayment=e},expression:"phoneNumberOfPayment"}})],1):t._e(),a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:t.amount2BeCredited<10||t.isLoading,block:"",size:"sm"},on:{click:function(e){return t.submitBalance()}}},[t.isLoading?[t._v(" "+t._s(t.$t("submiting"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1),a("b-modal",{ref:"show-credentials",attrs:{"hide-footer":"",title:"Credenciais"}},[a("p",{staticClass:"text-dark text-left"},[a("b",[t._v("Nome de usuário:")]),t._v(" "+t._s(t.currentCustomer.phone)+" "),a("br"),a("b",[t._v("Palavra passe:")]),t._v(" "+t._s(t.currentCustomer.passwordHint)+" ")])]),a("b-modal",{ref:"edit-customer",attrs:{"hide-footer":"",title:t.$t("edit")}},[a("div",[a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("name")))]),a("b-form-group",{attrs:{id:"name","label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text",required:"",size:"sm",placeholder:t.$t("name")},model:{value:t.editCustomerValues.name,callback:function(e){t.$set(t.editCustomerValues,"name",e)},expression:"editCustomerValues.name"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("nuit")))]),a("b-form-group",{attrs:{id:"nuit","label-for":"nuit"}},[a("b-form-input",{attrs:{id:"nuit",type:"text",required:"",size:"sm",placeholder:t.$t("nuit")},model:{value:t.editCustomerValues.nuit,callback:function(e){t.$set(t.editCustomerValues,"nuit",e)},expression:"editCustomerValues.nuit"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("phone")))]),a("b-form-group",{attrs:{id:"phone","label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"text",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.editCustomerValues.phone,callback:function(e){t.$set(t.editCustomerValues,"phone",e)},expression:"editCustomerValues.phone"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("document_id")))]),a("b-form-group",{attrs:{id:"meter_id","label-for":"meter_id"}},[a("b-form-input",{attrs:{id:"meeter_id",type:"text",required:"",size:"sm",placeholder:t.$t("meter_id")},model:{value:t.editCustomerValues.meeter_id,callback:function(e){t.$set(t.editCustomerValues,"meeter_id",e)},expression:"editCustomerValues.meeter_id"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("email")))]),a("b-form-group",{attrs:{id:"email","label-for":"email"}},[a("b-form-input",{attrs:{id:"email",type:"text",required:"",size:"sm",placeholder:t.$t("email")},model:{value:t.editCustomerValues.email,callback:function(e){t.$set(t.editCustomerValues,"email",e)},expression:"editCustomerValues.email"}})],1)],1),a("b-col",[a("small",[t._v("Tarifa")]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.editCustomerValues.tarrifTypeId,callback:function(e){t.$set(t.editCustomerValues,"tarrifTypeId",e)},expression:"editCustomerValues.tarrifTypeId"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v("Fontanária")]),a("b-form-select-option",{attrs:{value:"2"}},[t._v("Doméstica")]),a("b-form-select-option",{attrs:{value:"3"}},[t._v("Municipal")]),a("b-form-select-option",{attrs:{value:"5"}},[t._v("Pública")]),a("b-form-select-option",{attrs:{value:"4"}},[t._v("Comercial")]),a("b-form-select-option",{attrs:{value:"6"}},[t._v("Industrial")])],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("address")))]),a("b-form-group",{attrs:{id:"address","label-for":"address"}},[a("b-form-input",{attrs:{id:"address",type:"text",required:"",size:"sm",placeholder:t.$t("address")},model:{value:t.editCustomerValues.address,callback:function(e){t.$set(t.editCustomerValues,"address",e)},expression:"editCustomerValues.address"}})],1)],1),a("b-col",[a("small",[t._v("Status")]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.editCustomerValues.status,callback:function(e){t.$set(t.editCustomerValues,"status",e)},expression:"editCustomerValues.status"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v(t._s(t.$t("active")))]),a("b-form-select-option",{attrs:{value:"2"}},[t._v(t._s(t.$t("inactive")))])],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v("Latitude")]),a("b-form-group",{attrs:{id:"lat","label-for":"lat"}},[a("b-form-input",{attrs:{id:"lat",type:"number",step:"any",size:"sm",placeholder:"Latitude"},model:{value:t.editCustomerValues.lat,callback:function(e){t.$set(t.editCustomerValues,"lat",e)},expression:"editCustomerValues.lat"}})],1)],1),a("b-col",[a("small",[t._v("Longitude")]),a("b-form-group",{attrs:{id:"lng","label-for":"lng"}},[a("b-form-input",{attrs:{id:"lng",type:"number",size:"sm",step:"any",placeholder:"Longitude"},model:{value:t.editCustomerValues.lng,callback:function(e){t.$set(t.editCustomerValues,"lng",e)},expression:"editCustomerValues.lng"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:1==t.isLoading||!t.editCustomerValues.name,block:"",size:"sm"},on:{click:function(e){return t.editCustomerFinal()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)],1)]),a("b-modal",{ref:"show-whatsapp-modal",attrs:{"hide-footer":"",title:"Enviar factura via WhatsApp"}},[a("b-icon",{attrs:{variant:"success",icon:"whatsapp"}}),a("span",{staticClass:"ml-2"},[t._v("Número WhatsApp")]),a("b-form-group",{staticClass:"mt-2",attrs:{id:"whatsapp","label-for":"whatsapp"}},[a("b-form-input",{attrs:{id:"whatsapp",type:"text",required:"",size:"sm",placeholder:"Número WhatsApp"},model:{value:t.currentCustomer.phone,callback:function(e){t.$set(t.currentCustomer,"phone",e)},expression:"currentCustomer.phone"}})],1),a("b-form-textarea",{attrs:{id:"textarea",placeholder:"Enter something...",rows:"3","max-rows":"6"},model:{value:t.whatsAppBill,callback:function(e){t.whatsAppBill=e},expression:"whatsAppBill"}}),a("b-row",{staticClass:"mt-2"},[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.cancelWhatsApp()}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"success",disabled:t.currentCustomer.phone.length<12},on:{click:function(e){return t.sendBillViaWhatsApp()}}},[t._v("Enviar")])],1)],1)],1),a("b-modal",{ref:"show-email-modal",attrs:{"hide-footer":"",title:"Enviar factura via E-mail",id:"modal-scrollable",scrollable:""}},[a("b-icon",{attrs:{variant:"success",icon:"chat-left-fill"}}),a("span",{staticClass:"ml-2"},[t._v("E-mail do destinatário")]),a("b-form-group",{staticClass:"mt-2",attrs:{id:"email","label-for":"email"}},[a("b-form-input",{attrs:{id:"email",type:"text",required:"",size:"sm",placeholder:"E-mail do destinatário"},model:{value:t.currentCustomer.email,callback:function(e){t.$set(t.currentCustomer,"email",e)},expression:"currentCustomer.email"}})],1),a("b-row",[a("b-col",[t._v(t._s(t.emailBillDetails))])],1),a("b-row",{staticClass:"mt-2"},[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.cancelEmail()}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"success",disabled:t.currentCustomer.phone.length<12},on:{click:function(e){return t.sendEmailBill()}}},[t._v("Enviar")])],1)],1)],1),a("b-modal",{ref:"show-sms-modal",attrs:{"hide-footer":"",title:"Enviar factura via SMS"}},[a("b-icon",{attrs:{variant:"secondary",icon:"phone-fill"}}),a("span",{staticClass:"ml-2"},[t._v("Número do destinatário")]),a("b-form-group",{staticClass:"mt-2",attrs:{id:"sms","label-for":"sms"}},[a("b-form-input",{attrs:{id:"sms",type:"text",required:"",size:"sm",placeholder:"Número do destinatário"},model:{value:t.currentCustomer.phone,callback:function(e){t.$set(t.currentCustomer,"phone",e)},expression:"currentCustomer.phone"}})],1),a("b-form-textarea",{attrs:{id:"textarea",placeholder:"Enter something...",rows:"3","max-rows":"6"},model:{value:t.smsBody,callback:function(e){t.smsBody=e},expression:"smsBody"}}),a("b-row",{staticClass:"mt-2"},[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.cancelSms()}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"success",disabled:12!=t.currentCustomer.phone.length},on:{click:function(e){return t.sendSmsBillViaTwilio()}}},[t._v("Enviar SMS")])],1)],1)],1),a("b-modal",{ref:"add-new-debt",attrs:{"hide-footer":"",title:t.$t("add_debts")}},[a("small",[t._v(t._s(t.$t("amount_debt")))]),a("b-form-group",{attrs:{id:"amount_debt","label-for":"amount_debt"}},[a("b-form-input",{attrs:{id:"amount_debt",type:"number",step:"any",required:"",min:"1",size:"sm",placeholder:t.$t("amount_debt")},model:{value:t.amountOfDebt,callback:function(e){t.amountOfDebt=e},expression:"amountOfDebt"}})],1),a("small",[t._v(t._s(t.$t("description")))]),a("b-form-group",{attrs:{id:"description","label-for":"description"}},[a("b-form-input",{attrs:{id:"description",type:"text",required:"",size:"sm",placeholder:t.$t("description")},model:{value:t.debtDescription,callback:function(e){t.debtDescription=e},expression:"debtDescription"}})],1),a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:!t.amountOfDebt||t.isLoading,block:"",size:"sm"},on:{click:function(e){return t.submitDebt()}}},[t.isLoading?[t._v(" A submeter "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v("Submeter")]],2)],1)],1)])],1)},De=[],$e=(a("159b"),a("add5")),Ae=a.n($e),Ie="api/tarrif",Oe=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllTarrifs",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(Ie,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getTarrifsByCategory",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Ie,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertTarrifs",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Ie,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Ne=Oe,Me="api/whatsapp",ze=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"sendSms",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Me,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"sendWhatsAppMessage",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Me,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Be=ze,je="api/billByEmail",Ee=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"sendEmail",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(je,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"getEmails",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put(je,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Le=Ee,Ve="api/debt",Fe=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllDebts",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Ve,"?branchId=").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"getDebtByCustomerId",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Ve,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"updateDebt",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put("".concat(Ve,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"deleteDebt",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(Ve,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertDebt",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Ve,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Ue=Fe,qe="api/invoices",We=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllInvoices",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(qe,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getInvoice",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(qe,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"createPdfInvoice",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(qe,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Ye=We,Ge="api/mpesa",He=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"c2b",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Ge,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"b2c",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put(Ge,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Qe=He,Ze="api/cash_or_pos",Je=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"insertBalance",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Ze,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Ke=Je,Xe="api/customer_balance",ta=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllBalance",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(Xe,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getBalanceByCustomer",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Xe,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertBalance",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Xe,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),ea=ta,aa=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"formatMoney",value:function(t){return new Intl.NumberFormat("pt-PT",{currency:"MZN",style:"currency",minimumFractionDigits:2}).format(t||0)}}]),t}(),ra=aa;Rt.a.vfs=St.a.pdfMake.vfs,gt.a.locale("pt-br");var na=r["default"].extend({name:"Customer",components:{"nav-bar":pt},data:function(){return{readings:[],facturas:[],payments:[],isLoading:!1,message:!1,whatsAppBill:"",emailBillDetails:"",editCustomerValues:{},amountOfDebt:0,debtDescription:"Taxa de religação de água",options:[{value:1,text:"Boca do Caixa"},{value:2,text:"Depósito Bancário"},{value:3,text:"Transferência Bancária"},{value:4,text:"POS"},{value:5,text:"Cheque"},{value:6,text:"SISTAFE"},{value:7,text:"Mpesa Open API"},{value:8,text:"E-Mola"}],purchaseDetail:"",currentTariff:"",quantity:"",readingDeletionId:0,consumptionPeriod:gt()(new Date).format("MMMM Y").toUpperCase(),reading_date_taken:"",consumption:0,last:0,current:0,updatedId:0,waterMeterImageUrl:"",imageTemplate:"https://firebasestorage.googleapis.com/v0/b/tsenane-994c3.appspot.com/o/images%2F20200900627_4029b1a2-530b-49c8-9e4f-c5ba98fd7887?alt=media&token=74344817-5d8f-4deb-94a6-e1d64e8cbd6d",saldoDivida:0,totalFacturasNormais:0,amount2BeCredited:0,paymentMethod:1,phoneNumberOfPayment:"258",paymentReference:"",currentBalance:0,smsBody:""}},computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","branches","provinces","districts","currentCustomer","currentBill","company"])),watch:{current:function(){this.current<this.last?this.consumption=0:this.consumption=parseFloat(this.current)-parseFloat(this.last)},paymentMethod:function(){7==this.paymentMethod&&console.log("Initiating M-Pesa  transaction")}},created:function(){this.getReadings(),this.getDebts(),this.getCustomerBalance()},methods:{editCustomer:function(t){this.$refs["edit-customer"].show(),this.editCustomerValues=t,console.log(this.editCustomerValues)},getVat:function(t){var e=t.year<=2022?.1275:.12,a=t.subTotal*e;return a},getTotal:function(t){var e=t.subTotal+this.getVat(t),a=e*t.forfeit,r=e+a;return r},addDebts:function(){this.$refs["add-new-debt"].show()},submitDebt:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.show=!0,!(t.amount<=0)){e.next=5;break}return t.$bvToast.toast("Valor da dívida inválido.",{title:"Erro",variant:"danger",solid:!0}),t.show=!1,e.abrupt("return");case 5:return a={amount:t.amountOfDebt,status:0,description:t.debtDescription,barcode:t.currentCustomer.barcode,staffName:t.currentUser[0].name,branchId:t.currentCustomer.branchId},e.prev=6,e.next=9,Ue.insertDebt(a,t.token);case 9:r=e.sent,1==r.success&&t.refreshPage(),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](6),t.message=e.t0.message;case 16:t.show=!1,t.refreshPage(),t.$refs["add-new-debt"].hide(),t.amountOfDebt="",t.debtDescription="";case 21:case"end":return e.stop()}}),e,null,[[6,13]])})))()},invalidateDebt:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Ue.updateDebt(t.currentCustomer.barcode,t.token);case 4:a=e.sent,1==a.success?(t.isLoading=!1,console.log(a),t.refreshPage()):(console.log(a.message),t.isLoading=!1),e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0),t.isLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getPendingBills:function(){var t=this.facturas.filter((function(t){return 0==t.status})),e="";return t.forEach((function(t){e+=t.billId+"/SAAF: "+t.total+"\n"})),e},cancelSms:function(){this.$refs["show-sms-modal"].hide()},cancelEmail:function(){this.$refs["show-email-modal"].hide()},sendEmailBill:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={to:t.currentCustomer.email,emailBody:t.emailBillDetails},e.prev=2,e.next=5,Le.sendEmail(a,t.token);case 5:r=e.sent,1==r.success?(t.isLoading=!1,console.log(r)):(console.log(r.message),t.isLoading=!1),t.$refs["show-email-modal"].hide(),e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),console.log(e.t0),t.isLoading=!1,t.$refs["show-email-modal"].hide();case 15:case"end":return e.stop()}}),e,null,[[2,10]])})))()},openEmailModal:function(){this.$refs["show-email-modal"].show(),this.emailBillDetails="Olá, muito obrigado por se cadastrar na nossa plataforma."},openWhatsAppModal:function(){var t;this.$refs["show-whatsapp-modal"].show(),t="*"+this.company[0].name+"*\n",t+=this.company[0].address+"\nNUIT: ",t+=this.company[0].nuit+"\nCel: ",t+=this.company[0].phone+"\n",t+=this.company[0].email+"\nWebsite: ",t+=this.company[0].website+"\n",t+="===========================\n",t+="EXMO SR(s): ",t+=this.currentCustomer.name+"\nEndereço: ",t+=this.currentCustomer.address+"\nContador: ",t+=this.currentCustomer.barcode+"\nCel +",t+=this.currentCustomer.phone+"\n",t+=this.tariffId(this.currentCustomer.tarrifTypeId)+"\n",t+="===========================\n",t+="*FACTURAS*\n";var e=[],a=this.facturas.filter((function(t){return 0==t.status}));a.forEach((function(t){var r;r="--------------------------------------\n",r+="*Factura/Recibo Nº: "+t.billId+"*\n",r+="Data emissão: "+t.dataEmissao+"\n",r+="Vencimento: "+t.dataLimite+"\n",r+="Leitura anterior: "+t.last+" m^3\n",r+="Leitura actual: "+t.current+" m^3\n",r+="Consumo facturado: "+t.totalUnities+" m^3\n",r+="SubTotal: "+t.subTotal+"\n",r+="IVA (12%): "+t.vat+"\n",r+="Multa: "+t.forfeit+"\n",r+="*Total da factura: "+ra.formatMoney(t.total)+"*\n",a.length-1==a.indexOf(t)&&(r+="===========================\n"),e.push({factura:r})}));var r="";e.forEach((function(t){r+=t.factura}));var n="";n+="*Dívida anterior: "+ra.formatMoney(this.saldoDivida)+"*\n",n+="*TOTAL A PAGAR: "+ra.formatMoney(this.totalFacturasNormais+this.saldoDivida)+"*\n",n+="===========================\n";var s="CANAIS DE PAGAMENTO\n";s+="*BCI: Tsenane, Lda*\n",s+=this.company[0].bankAccount+"\n",s+=this.company[0].nib+"\n",s+="--------------------------------------\n",s+="*M-PESA*\n",s+="Digite: *150# > tecla de chamada\n",s+="6. Pagamentos\n",s+="7. Código de Serviço *901029*\n",s+="Referência: "+this.currentCustomer.barcode+"\n",s+="Valor da factura: *"+ra.formatMoney(this.totalFacturasNormais+this.saldoDivida)+"*\n",s+="Digitar o PIN M-PESA\n",s+="Confirmar a transação e *JÁ ESTÁ*\n",s+="===========================\n\n",s+="*App Android:* https://bit.ly/3aBHdtf",this.whatsAppBill=t+r+n+s},sendBillViaWhatsApp:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.isLoading=!0,a={phone:t.currentCustomer.phone,barcode:t.currentCustomer.barcode,message:t.whatsAppBill,staffName:t.user[0].name};try{r=Be.sendWhatsAppMessage(a,t.token),1==r.success?(t.isLoading=!1,t.cancelWhatsApp(),t.$bvToast.toast("Mensagem enviada com sucesso.",{title:"Sucesso!",variant:"success",solid:!0})):(t.isLoading=!1,t.cancelWhatsApp(),t.$bvToast.toast(r.message,{title:"Erro!",variant:"danger",solid:!0}))}catch(n){console.log(n),t.isLoading=!1,t.cancelWhatsApp(),t.$bvToast.toast(n.message,{title:"Erro!",variant:"danger",solid:!0})}case 3:case"end":return e.stop()}}),e)})))()},cancelWhatsApp:function(){this.$refs["show-whatsapp-modal"].hide()},editCustomerFinal:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,tt.insertOrUpdateCustomer(t.editCustomerValues,t.token);case 4:a=e.sent,1==a.success?(t.isLoading=!1,t.$bvToast.toast(a.message,{title:"Sucesso",variant:"success",solid:!0})):(t.isLoading=!1,t.$bvToast.toast(a.message,{title:"",variant:"warning",solid:!0})),t.$refs["edit-customer"].hide(),e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](1),t.$bvToast.toast(""+e.t0,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1,t.$refs["edit-customer"].hide();case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))()},showCredentials:function(){this.$refs["show-credentials"].show()},refreshPage:function(){this.getReadings(),this.getDebts(),this.getCustomerBalance()},addNewPurchase:function(){this.$refs["new-reading"].show()},generatePDF:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.isLoading=!0,r={barcode:e.currentCustomer.barcode,customerName:e.currentCustomer.name,companyId:e.currentUser[0].companyId,tariffTypeId:e.currentCustomer.tarrifTypeId},a.prev=2,a.next=5,Ye.createPdfInvoice(r,e.token);case 5:n=a.sent,1==n.success?(console.log(n),e.downloadPdf(t)):e.$bvToast.toast(n.message,{title:"Error",variant:"danger",solid:!0}),e.isLoading=!1,a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](2),e.isLoading=!1,e.$bvToast.toast(a.t0.message,{title:"Error",variant:"danger",solid:!0});case 14:case"end":return a.stop()}}),a,null,[[2,10]])})))()},downloadPdf:function(t){return Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ae()({printable:"http://localhost:4000/uploads/tsenan/".concat(t,".pdf"),type:"pdf",showModal:!0});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.log(e.t0.message);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()},getReadings:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Lt.getReadingsByCustomer(t.currentCustomer.barcode,t.currentCustomer.tarrifTypeId,t.token);case 4:a=e.sent,a.facturas.length>0?(t.readings=a.result,t.totalFacturasNormais=a.totalFacturas,t.last=a.result[0].current,t.updateReadings(a.facturas),t.facturas=a.facturas):console.log(a.message),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:t.isLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getDebts:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Ue.getDebtByCustomerId(t.currentCustomer.barcode,t.token);case 4:a=e.sent,1==a.success?(t.saldoDivida=null==a.totalDues?0:a.totalDues,t.payments=a.payments):t.saldoDivida=0,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:t.isLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getPaymentMethod:function(t){return 1==t?"Boca do Caixa":2==t?"Depósito Bancário":3==t?"Transferência Bancária":4==t?"POS":5==t?"Cheque":6==t?"SISTAFE":7==t?"M-Pesa Open API":8==t?"E-Mola":void 0},convertMonthToString:function(t){return gt()(t).format("MMMM Y").toUpperCase()},tariffId:function(t){return 1==t?(this.quantityMinTariff=0,"Tarifa Fontenária"):2==t?(this.quantityMinTariff=5,"Tarifa Doméstica"):3==t?(this.quantityMinTariff=0,"Tarifa Municipal"):4==t?(this.quantityMinTariff=15,"Tarifa Comercial"):5==t?(this.quantityMinTariff=15,"Tarifa Pública"):6==t?(this.quantityMinTariff=15,"Tarifa Industrial"):7==t?(this.quantityMinTariff=1,"Tarifa Toma de Água"):void 0},decidedToDelete:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Lt.deleteReading(t.readingDeletionId,t.token);case 4:a=e.sent,1==a.success?(t.$bvToast.toast(a.message,{title:"",variant:"success",solid:!0}),t.getReadings()):t.$bvToast.toast(a.message,{title:"",variant:"danger",solid:!0}),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),t.$bvToast.toast(e.t0.message,{title:"",variant:"danger",solid:!0});case 11:t.$refs["delete-reading"].hide();case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},deleteReading:function(t){this.readingDeletionId=t,this.$refs["delete-reading"].show()},cancelDeletion:function(){this.$refs["delete-reading"].hide()},getTariffById:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Ne.getTarrifsByCategory(t.currentCustomer.tarrifTypeId);case 4:a=e.sent,1==a.success?t.currentTariff=a.result:t.$bvToast.toast("Tarifa não disponível.",{title:"Error",variant:"danger",solid:!0}),t.isLoading=!1,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),t.isLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},updateBill:function(t){this.$refs["update-reading"].show(),this.updatedId=t.id,this.last=t.last,this.current=t.current,this.consumption=t.consumption,this.waterMeterImageUrl=t.waterMeterImageUrl},updateReading:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={last:t.last,current:t.current,consumption:t.consumption,id:t.updatedId,updatedBy:t.user[0].name},t.isLoading=!0,e.prev=2,e.next=5,Lt.updateReading(a,t.token);case 5:r=e.sent,1==r.success?(t.$bvToast.toast(r.message,{title:"",variant:"success",solid:!0}),t.getReadings()):t.$bvToast.toast(r.message,{title:"",variant:"danger",solid:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"Erro",variant:"danger",solid:!0});case 12:t.$refs["update-reading"].hide(),t.$emit("update-deletion"),t.isLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))()},updateReadings:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=t.filter((function(t){return 0==t.status})),e.isLoading=!0,r.forEach((function(t){var a={id:0,readingId:t.billId,barcode:e.currentCustomer.barcode,vat:t.vat,subTotal:t.subTotal,totalOfBill:t.total};try{var r=Lt.updateReading(a,e.token);1==r&&console.log(t.uniqueBillId+"Actualizado com sucesso")}catch(n){console.log(n.message)}}));case 3:case"end":return a.stop()}}),a)})))()},addNewReading:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={last:t.last,current:t.current,consumption:t.consumption,barcode:t.currentCustomer.barcode,status:0,branchId:t.currentCustomer.branchId,staffName:t.user[0].name,tarrifTypeId:t.currentCustomer.tarrifTypeId,consumoFacturado:t.getConsumtionByTariff(t.consumption,t.currentCustomer.tarrifTypeId),lat:t.currentCustomer.lat,lng:t.currentCustomer.lng},t.isLoading=!0,e.prev=2,e.next=5,Lt.insertReadings(a,t.token);case 5:r=e.sent,1==r.success?t.$bvToast.toast(r.message,{title:"",variant:"success",solid:!0}):t.$bvToast.toast(r.message,{title:"Duplicado",variant:"danger",solid:!0}),t.$refs["new-reading"].hide(),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"Erro",variant:"danger",solid:!0}),t.$refs["new-reading"].hide();case 14:t.getReadings(),t.isLoading=!1;case 16:case"end":return e.stop()}}),e,null,[[2,10]])})))()},getConsumtionByTariff:function(t,e){var a=0;return e>=4?a=t<=15?15:t:2==e||3==e?a=t<=5?5:t:1==e&&(a=t),a},addBalance:function(){this.$refs["add-balance"].show()},submitBalance:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isLoading=!0,!(t.amount2BeCredited>=10)){e.next=20;break}if(7!=t.paymentMethod){e.next=19;break}return a={branchId:t.currentCustomer.branchId,barcode:t.currentCustomer.barcode,amount:t.amount2BeCredited,phoneNumber:t.phoneNumberOfPayment,transactionRef:Math.floor(1e5*Math.random())+1,thirdPartyRef:t.currentCustomer.barcode},e.prev=4,e.next=7,Qe.c2b(a,t.token);case 7:r=e.sent,1==r.success?(t.isLoading=!1,t.$refs["add-balance"].hide(),t.$bvToast.toast("Pagamento efectuado com sucesso.",{title:"Sucesso",variant:"success",solid:!0}),console.log(r)):(t.$refs["add-balance"].hide(),t.isLoading=!1,t.$bvToast.toast("Houve um erro, tente mais tarde.",{title:"Erro",variant:"danger",solid:!0}),console.log(r)),t.isLoading=!1,e.next=16;break;case 12:e.prev=12,e.t0=e["catch"](4),t.isLoading=!1,t.$refs["add-balance"].hide();case 16:t.isLoading=!1,e.next=20;break;case 19:t.submitCashOrPos();case 20:case"end":return e.stop()}}),e,null,[[4,12]])})))()},submitCashOrPos:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={branchId:t.currentCustomer.branchId,barcode:t.currentCustomer.barcode,customerId:t.currentCustomer.id,amount:t.amount2BeCredited,phoneNumber:t.currentCustomer.phone,transactionRef:Math.floor(1e5*Math.random())+1,staff:t.currentUser[0].name,provider:t.paymentMethod},e.prev=2,e.next=5,Ke.insertBalance(a,t.token);case 5:r=e.sent,1==r.success&&(t.show=!1,t.$refs["add-balance"].hide(),t.$bvToast.toast(r.message,{title:"Sucesso",variant:"success",solid:!0})),e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](2),t.show=!1,t.$refs["add-balance"].hide(),t.$bvToast.toast(e.t0.message,{title:"Erro:",variant:"danger",solid:!0});case 14:t.isLoading=!1,t.$refs["add-balance"].hide();case 16:case"end":return e.stop()}}),e,null,[[2,9]])})))()},getCustomerBalance:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,ea.getBalanceByCustomer(t.currentCustomer.barcode,t.token);case 4:a=e.sent,1==a.success?(t.currentBalance=a.currentBalance,t.customerCreditHistory=a.result):console.log(a.message),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()},printCustomerStatement:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r,n,s,i,o,c,l,u,d,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.isLoading=!0,a=[],r=[],n=Object(vt["a"])(t.facturas);try{for(n.s();!(s=n.n()).done;)i=s.value,o=[],o.push({text:i.dataEmissao,fontSize:8}),o.push({text:i.billId+"/SAF/"+i.year,fontSize:8,alignment:"center"}),o.push({text:i.last,fontSize:8,alignment:"center"}),o.push({text:i.current,fontSize:8,alignment:"center"}),o.push({text:i.consumoFacturado,fontSize:8,alignment:"center"}),o.push({text:i.dataLimite,fontSize:8,alignment:"center"}),o.push({text:parseFloat(i.total).toFixed(2),fontSize:8,alignment:"right"}),o.push({text:1==i.status?"Pago":"Pendente",fontSize:8,alignment:"center"}),a.push(o)}catch(p){n.e(p)}finally{n.f()}c=Object(vt["a"])(t.payments);try{for(c.s();!(l=c.n()).done;)u=l.value,d=[],d.push({text:u.dateOfPayment,fontSize:8}),d.push({text:u.createdAt,fontSize:8}),d.push({text:u.billId+"/SAF/",fontSize:8,alignment:"center"}),d.push({text:u.reference,fontSize:8,alignment:"center"}),d.push({text:u.phoneNumber,fontSize:8,alignment:"center"}),d.push({text:t.getPaymentMethod(u.paymentMethod),fontSize:8,alignment:"center"}),d.push({text:u.staffName,fontSize:8,alignment:"right"}),d.push({text:u.totalPaid,fontSize:8,alignment:"center"}),r.push(d)}catch(p){c.e(p)}finally{c.f()}return e.next=9,t.getBase64ImageFromURL("https://saaf-tsenane.herokuapp.com/img/logo_12.2b7a27d2.jpeg");case 9:e.t0=e.sent,e.t1=[30,0,0,0],e.t2={image:e.t0,width:250,height:150,margin:e.t1},e.t3=[e.t2],e.t4={columns:[{text:"Documento processado por computador",alignment:"left",fontSize:8,margin:[30,0,0,0]},{text:"TSENANE Software",alignment:"right",fontSize:8,margin:[0,0,30,0]}]},e.t5=[{columns:[[{text:"EXTRACTO: ".concat(t.currentCustomer.barcode,"\n"),bold:!0,fontSize:11,alignment:"right"}]]},{text:"\n\n\n\n\n\n\n"},{columns:[[[{text:"Nome: ".concat(t.currentCustomer.name),bold:!0,fontSize:11},{text:"".concat(t.tariffId(t.currentCustomer.tarrifTypeId)),bold:!0,fontSize:10},{text:"Endereço: ".concat(t.currentCustomer.address),fontSize:10},{text:"Telefone: ".concat(t.currentCustomer.phone),fontSize:10},{text:"NUIT: ".concat(t.currentCustomer.nuit),fontSize:10},{text:"E-mail: ".concat(t.currentCustomer.email),fontSize:10}]],[{text:"Data de impressão: ".concat(gt()().format("DD-MM-YYYY").toLocaleString()),alignment:"right",bold:!0,fontSize:10}]]},{text:"Histórico de facturas emitidas",style:"sectionHeader"},{table:{widths:["*","auto","auto","auto","auto","auto","auto","auto"],body:[[{text:"Data de emissão",style:"columnsTitle"},{text:"Nº Factura",style:"columnsTitle"},{text:"Leitura anterior",style:"columnsTitle"},{text:"Leitura actual",style:"columnsTitle"},{text:"Consumo facturado",style:"columnsTitle"},{text:"Vencimento",style:"columnsTitle"},{text:"Montante",style:"columnsTitle"},{text:"Situação",style:"columnsTitle"}]].concat(a)}},{text:"\nCrédito depositado: ".concat(t.currentBalance.toFixed(2)," MZN"),fontSize:10,alignment:"right",color:"#000000"},{text:"Valor das facturas liquidadas: ".concat(t.totalDividasLiquidadas().toFixed(2)," MZN"),fontSize:10,alignment:"right",color:"#000000"},{text:"Saldo disponível: ".concat((t.currentBalance-t.totalDividasLiquidadas()).toFixed(2)," MZN"),fontSize:12,alignment:"right",bold:!0,color:"#000000"},{text:"Histórico de pagamentos",style:"sectionHeader"},{table:{widths:["*","auto","auto","auto","auto","auto","auto","auto"],body:[[{text:"Data de pagamento",style:"columnsTitle"},{text:"Validado aos",style:"columnsTitle"},{text:"Nº Recibo",style:"columnsTitle"},{text:"Referência",style:"columnsTitle"},{text:"Telemóvel",style:"columnsTitle"},{text:"Modo de pagamento",style:"columnsTitle"},{text:"Operador",style:"columnsTitle"},{text:"Montante pago",style:"columnsTitle"}]].concat(r)}},{text:"\n\n Assinatura: _______________________________",alignment:"center",fontSize:10}],e.t6={sectionHeader:{bold:!0,decoration:"underline",fontSize:12,margin:[0,15,0,15]},columnsTitle:{fontSize:8,bold:!0,color:"#000000"}},m={header:e.t3,footer:e.t4,content:e.t5,styles:e.t6},Rt.a.createPdf(m).print();case 18:case"end":return e.stop()}}),e)})))()},getBase64ImageFromURL:function(t){var e=this;return new Promise((function(a,r){var n=new Image;n.setAttribute("crossOrigin","anonymous"),n.onload=function(){var t=document.createElement("canvas");t.width=n.width,t.height=n.height;var r=t.getContext("2d");r.drawImage(n,0,0);var s=t.toDataURL("image/png");e.isLoading=!1,a(s)},n.onerror=function(t){e.isLoading=!1,r(t)},n.src=t}))},totalDividasLiquidadas:function(){var t=this.payments.filter((function(t){return t.id>=24825})),e=t.reduce((function(t,e){return t+e.totalPaid}),0);return e}}}),sa=na,ia=(a("07ab"),Object(u["a"])(sa,Se,De,!1,null,"6507976e",null)),oa=ia.exports,ca=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar-cashier"),a("b-row",{staticClass:"mt-3"},[a("b-col",{attrs:{lg:"3",md:"12",sm:"12"}},[a("b-card",{attrs:{"header-tag":"header"},scopedSlots:t._u([{key:"header",fn:function(){return[a("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("customer_details")))])]},proxy:!0}])},[a("b-overlay",{staticClass:"mt-1 mb-1 bg-white",attrs:{show:t.show,rounded:"sm"}},[t.customer.length?a("b-row",[a("b-col",[a("h5",[a("small",[t._v(t._s(t.$t("category"))+": "+t._s(t.tariffId(t.customer.length?t.customer[0].tarrifTypeId:"")))])]),a("b-input-group",{staticClass:"mb-1",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"person-badge"}})],1),a("b-form-input",{attrs:{type:"text",size:"sm",disabled:!t.editting},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}})],1),a("b-input-group",{staticClass:"mb-1",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"map"}})],1),a("b-form-input",{attrs:{type:"text",size:"sm",disabled:!t.editting},model:{value:t.customerAddress,callback:function(e){t.customerAddress=e},expression:"customerAddress"}})],1),a("b-input-group",{staticClass:"mb-1",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"telephone"}})],1),a("b-form-input",{attrs:{type:"text",size:"sm",disabled:!t.editting},model:{value:t.customerPhone,callback:function(e){t.customerPhone=e},expression:"customerPhone"}})],1),a("b-input-group",{staticClass:"mb-1",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"envelope-fill"}})],1),a("b-form-input",{attrs:{type:"text",size:"sm",disabled:!t.editting},model:{value:t.customerEmail,callback:function(e){t.customerEmail=e},expression:"customerEmail"}})],1),a("b-input-group",{staticClass:"mb-1",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[t._v(" "+t._s(t.$t("document_id"))+" ")]),a("b-form-input",{attrs:{type:"text",size:"sm",disabled:!t.editting},model:{value:t.customerNationalId,callback:function(e){t.customerNationalId=e},expression:"customerNationalId"}})],1),a("b-input-group",{staticClass:"mb-1",attrs:{size:"sm"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[t._v(" "+t._s(t.$t("nuit"))+" ")]),a("b-form-input",{attrs:{type:"text",size:"sm",disabled:!t.editting},model:{value:t.customerNuit,callback:function(e){t.customerNuit=e},expression:"customerNuit"}})],1),a("b-row",[t.editting?t._e():a("b-col",[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"success",block:"",size:"sm"},on:{click:function(e){return t.editCustomer()}}},[t._v(" "+t._s(t.$t("update_details")))])],1),t.editting?a("b-col",[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"danger",block:"",size:"sm"},on:{click:function(e){return t.cancelEditing()}}},[t._v(" "+t._s(t.$t("cancel")))])],1):t._e(),t.editting?a("b-col",[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"secondary",block:"",disabled:!t.editting,size:"sm"},on:{click:function(e){return t.editCustomerFinal()}}},[a("b-icon",{attrs:{icon:"pen"}})],1)],1):t._e()],1)],1)],1):a("b-row",{staticClass:"text-danger"},[a("b-col",[t._v(t._s(t.error))])],1)],1)],1)],1),a("b-col",[a("b-card",{attrs:{"header-tag":"header"},scopedSlots:t._u([{key:"header",fn:function(){return[a("b-row",[a("b-col",{attrs:{cols:"6"}},[a("h5",{staticClass:"align-middle"},[t._v(" "+t._s(t.$t("cashier"))+": "),a("small",[t._v(t._s((new Date).getDate()+"/"+((new Date).getMonth()+1)+"/"+(new Date).getFullYear()))])])]),a("b-col",[a("b-input-group",{staticClass:"mb-2",attrs:{size:"md"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"pen"}})],1),a("b-form-input",{attrs:{type:"text",size:"md",placeholder:t.$t("type_customer_barcode")},model:{value:t.barcode,callback:function(e){t.barcode=e},expression:"barcode"}}),a("b-input-group-append",[a("b-button",{attrs:{disabled:!t.barcode||t.barcode.length<6,size:"sm",text:"Buscar",variant:"secondary"},on:{click:function(e){return t.searchCustomer()}}},[t._v(" Buscar ")])],1)],1)],1)],1)]},proxy:!0}])},[a("b-overlay",{staticClass:"mt-1 mb-1 bg-white",attrs:{show:t.show,rounded:"sm"}},[t.readings.length?a("b-row",[a("b-col",[a("h5",{},[a("small",[t._v(t._s(t.readings.length)+" "+t._s(t.$t("last_purchases")))])])])],1):t._e(),t.readings.length?a("b-row",[a("b-col",[a("table",{ref:"readings-details",staticClass:"table table-sm table-hover table-bordered table-stripped"},[a("thead",{staticClass:"bg-secondary text-white"},[a("tr",[a("th",[t._v(" "+t._s(t.$t("month_consumption"))+" ")]),a("th",[t._v(t._s(t.$t("receipt")))]),a("th",[t._v(t._s(t.$t("value")))]),a("th",[t._v(t._s(t.$t("penalty")))]),a("th",{staticClass:"text-center"},[t._v(t._s(t.$t("total_to_pay")))]),a("th")])]),a("tbody",t._l(t.facturas,(function(e){return a("tr",{key:e.billId,staticStyle:{cursor:"pointer"}},[a("td",{staticClass:"align-middle"},[t._v(t._s(e.createdAt))]),a("td",{staticClass:"align-middle"},[t._v(t._s(e.billId))]),a("td",{staticClass:"align-middle"},[t._v(" "+t._s(parseFloat(e.subTotal)+parseFloat(e.vat))+" ")]),a("td",{staticClass:"align-middle"},[t._v(" "+t._s(e.forfeit)+" ")]),a("td",{staticClass:"text-center align-middle"},[t._v(" "+t._s(e.total)+" ")]),a("td",{staticClass:"align-middle"},[0==e.status?a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"danger",block:"",disabled:t.show,size:"sm"},on:{click:function(a){return t.submitBill(e)}}},[a("b-icon",{attrs:{icon:"credit-card"}}),t._v("       "+t._s(t.$t("pay"))+" ")],1):a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"success",block:"",disabled:"",size:"sm"}},[a("b-icon",{attrs:{icon:"check-square-fill"}}),t._v("      "+t._s(t.$t("paid"))+" ")],1)],1)])})),0)])])],1):t._e()],1),t.error_readings?a("b-row",[a("b-col",{staticClass:"text-danger"},[t._v(t._s(t.error_readings))])],1):t._e()],1)],1),a("b-col",{attrs:{lg:"3",md:"12",sm:"12"}},[a("b-card",{attrs:{"header-tag":"header"},scopedSlots:t._u([{key:"header",fn:function(){return[a("b-row",[a("b-col",{attrs:{lg:"7"}},[a("h5",{staticClass:"align-middle"},[a("small",[t._v(t._s(t.currentBalance.toFixed(2))+" MZN")])])]),a("b-col",{staticClass:"text-right"},[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"success",block:"",disabled:!t.payments.length,size:"sm"},on:{click:function(e){return t.generatePDFFile()}}},[a("b-icon",{attrs:{icon:"printer-fill"}})],1)],1)],1)]},proxy:!0}])},[t.payments.length?a("table",{ref:"payment-details",staticClass:"table table-sm table-hover table-stripped"},[a("thead",t._l(t.payments,(function(e,r){return a("tr",{key:r,staticStyle:{"font-size":"12px"}},[a("td",[t._v(t._s(r+1))]),a("td",[t._v(t._s(e.customerName))]),a("td",{staticClass:"text-right"},[t._v(t._s(e.totalPaid))])])})),0)]):t._e()])],1)],1),a("b-modal",{ref:"invalidate-forfeit",attrs:{"hide-footer":"",title:t.$t("invalidate_forfeit")}},[a("p",{staticClass:"text-danger",staticStyle:{"font-size":"10pt"}},[t._v(" Olá "),a("b",{staticClass:"text-dark"},[t._v(t._s(t.user[0].name))]),t._v("! Certifique a data do pagamento que consta no talão de depósito, para efectivar o cancelamento da multa de "),a("b",{staticClass:"text-dark"},[t._v(t._s(t.customerName))])]),a("b-row",[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.cancelValidation()}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"danger"},on:{click:function(e){return t.invalidateMulta()}}},[t._v(t._s(t.$t("invalidate_forfeit")))])],1)],1)],1),a("b-modal",{ref:"validate-bill",attrs:{"hide-footer":"",size:"md",scrollable:"",title:t.$t("pay_now")}},[a("div",[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[a("table",{staticClass:"table table-sm table-bordered",staticStyle:{"font-size":"10pt"}},[a("thead",[a("tr",[a("th",[t._v(" "+t._s(t.customer.length?t.customer[0].name.toUpperCase():"")+" ")]),a("th",{staticClass:"text-right"},[t._v(" "+t._s(t.customer.length?t.customer[0].barcode:"")+" ")])])]),a("tbody",[a("tr",[a("td",[t._v(t._s(t.$t("bill_receipt_number")))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.billId))])]),a("tr",[a("td",[t._v(t._s(t.$t("current_forfeit")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentForfeit,expression:"currentForfeit"}],staticClass:"text-right"})]),a("tr",[a("td",[t._v(t._s(t.$t("current_bill")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.subTotal,expression:"subTotal"}],staticClass:"text-right"})]),a("tr",[a("th",[t._v(t._s(t.$t("total_payable")))]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentBillValue,expression:"currentBillValue"}],staticClass:"text-right"})])])]),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("date_of_payment")))]),a("b-form-datepicker",{staticClass:"mb-2",attrs:{size:"sm"},model:{value:t.paymentDate,callback:function(e){t.paymentDate=e},expression:"paymentDate"}})],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("payment_method")))]),a("b-form-select",{attrs:{options:t.options,size:"sm"},model:{value:t.paymentMethod,callback:function(e){t.paymentMethod=e},expression:"paymentMethod"}})],1),a("b-col",[a("small",[t._v(t._s(t.$t("payment_reference")))]),a("b-form-group",{attrs:{"label-for":"payment_reference"}},[a("b-form-input",{attrs:{type:"text",size:"sm"},model:{value:t.paymentReference,callback:function(e){t.paymentReference=e},expression:"paymentReference"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("amount_received")))]),a("b-form-group",{attrs:{"label-for":"amount_received"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",min:0},model:{value:t.amountReceived,callback:function(e){t.amountReceived=e},expression:"amountReceived"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("debit_balance")))]),a("b-form-group",{attrs:{"label-for":"debit_balance"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",disabled:""},model:{value:t.debitBalance,callback:function(e){t.debitBalance=e},expression:"debitBalance"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-button",{attrs:{disabled:!t.amountReceived>t.grandTotal||t.show,block:"",size:"sm",variant:"success"},on:{click:function(e){return t.finalizepayment()}}},[t._v(t._s(t.$t("pay_now")))])],1)],1)],1)],1)])],1)},la=[],ua=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("b-navbar",{staticClass:"navbar",attrs:{toggleable:"lg",type:"dark",variant:"info"}},[r("b-navbar-brand",{attrs:{to:"/cashier"}},[r("img",{staticStyle:{"border-radius":"40%"},attrs:{src:a("c6f3"),alt:"AquaMoz",width:"40"}}),t._v("  "),r("span",[t._v(t._s(t.company.length?t.company[0].name:"Company"))])]),r("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),r("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[r("b-navbar-nav",{staticStyle:{"font-size":"10pt"}}),r("b-navbar-nav",{staticClass:"ml-auto"},[r("b-nav-item-dropdown",{attrs:{text:t.$t("lang"),right:""}},t._l(t.languages,(function(e){return r("b-dropdown-item",{key:e.title,on:{click:function(a){return t.changeLocale(e.language)}}},[r("flag",{attrs:{iso:e.flag,squared:!1}}),t._v("   "),r("small",[t._v(t._s(e.title))])],1)})),1),r("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[r("i",{staticClass:"fa fa-user"}),t._v("   "+t._s(t.user?t.user[0].name:"User")+" ")]},proxy:!0}])},[r("b-dropdown-item",{attrs:{to:"/profile"}},[t._v(t._s(t.$t("profile")))]),r("hr"),r("b-dropdown-item",{on:{click:function(e){return t.logout()}}},[t._v(t._s(t.$t("logout")))])],1)],1)],1)],1)],1)},da=[],ma={name:"Navbar",computed:Object(_["a"])({},Object(f["b"])(["user","branches","token","currentUser","company"])),created:function(){},data:function(){return{languages:[{flag:"mz",language:"pt",title:"PT"},{flag:"gb",language:"en",title:"EN"}]}},methods:{gotToCustomersPanel:function(){this.$store.commit("SET_CURRENT_BRANCH",this.branches[0]),this.$router.push("/branch")},changeLocale:function(t){T.locale=t},logout:function(){localStorage.removeItem("MatiAppTokenJwt"),this.$router.replace("/")}}},pa=ma,fa=Object(u["a"])(pa,ua,da,!1,null,null,null),ba=fa.exports,va=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"domesticBelowFive",value:function(t,e){var a=parseFloat(e.serviceAvailabilityFee)+parseFloat(e.socialTire),r=.1275*a,n=a+r,s=[{id:0,subTotal:a,tax:r,total:n,serviceAvailabilityFee:e.serviceAvailabilityFee,totalUnities:t}];return s}},{key:"domesticAboveFive",value:function(t,e){var a=parseFloat(t),r=0,n=0,s=5;6==a?r=1:7==a?r=2:a>7&&(n=a-7,r=2);var i=parseFloat(e.serviceAvailabilityFee),o=parseFloat(e.socialTire),c=parseFloat(e.firstSeven)*r,l=parseFloat(e.aboveSeven)*n,u=i+o+c+l,d=.1275*u,m=u+d,p=[{id:2,escalaoUm:o,escalaoDois:c,escalaoTres:l,subTotal:u,total:m,tax:d,fixedTax:e.serviceAvailabilityFee,base:[{baseEscUm:s,baseEscDois:r,baseEscTres:n}]}];return p}},{key:"fontCalc",value:function(t,e){var a=parseFloat(t)*parseFloat(e.pricePerMeterCubic),r=.1275*a,n=r+a,s=[{id:1,quantity:t,subTotal:a,tax:r,total:n,fixedTax:e.serviceAvailabilityFee,base:[]}];return s}},{key:"calculatePublicComercialAndIndustrial",value:function(t,e){var a=parseFloat(t),r=parseFloat(e.firstFifteen)+parseFloat(e.serviceAvailabilityFee),n=0;t>15&&(n=a-15);var s=n*parseFloat(e.aboveFifteen),i=r+s,o=.1275*i,c=o+i,l=[{id:4,escalaoUm:r,escalaoDois:s,base:[{baseEscDois:n}],fixedTax:e.serviceAvailabilityFee,subTotal:i,tax:o,total:c}];return l}}]),t}(),ha=va,ga="api/simulator",_a=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getTarrifsByCategory",value:function(t){return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(a,r){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(ga,"/").concat(t));case 3:n=e.sent,s=n.data,a(s),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),r(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),ya=_a,xa="api/cashierPayments",wa=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllPayments",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(xa,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getPaymentsByStaffId",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(xa,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Ca=wa,ka="api/search_by_id_range",Ta=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"searchCustomers",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(ka,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"searchCustomersByLatLng",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(ka,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Ra=Ta,Pa="api/payments",Sa=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllPayments",value:function(t,e){var a="".concat(Pa,"?paymentMethod=").concat(t.paymentMethod,"&fromDate=").concat(t.from,"&toDate=").concat(t.to),r="Bearer "+e;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(e,n){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(a,{headers:{Authorization:r}});case 3:s=t.sent,i=s.data,e(i),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getCustomerPayments",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Pa,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"deletePayment",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(Pa,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertPayment",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Pa,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Da=Sa,$a=a("62c5"),Aa=a.n($a);Rt.a.vfs=St.a.pdfMake.vfs;var Ia={name:"Manager",computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","company"])),created:function(){this.getAllPayments()},components:{NavBarCashier:ba},data:function(){return{customerName:"",customerAddress:"",customerNationalId:"",customerPhone:"",customerEmail:"",customerNuit:"",editting:!1,error:"",error_readings:"",show:!1,barcode:"",customer:[],currentTariff:[],readings:[],facturas:[],payments:[],paymentMethod:"",paymentReference:"",amountReceived:0,debitBalance:0,grandTotal:0,currentBillValue:0,currentForfeit:0,paymentDate:"".concat((new Date).getFullYear(),"-").concat((new Date).getMonth()+1,"-").concat((new Date).getDate()),referenceOfPayment:"",options:[{value:1,text:"Boca do Caixa"},{value:2,text:"Depósito Bancário"},{value:3,text:"Transferência Bancária"},{value:4,text:"POS"},{value:5,text:"Cheque"},{value:6,text:"SISTAFE"},{value:7,text:"MPESA Open API"},{value:8,text:"E-Mola"}],currentBalance:0,subTotal:0,vat:0,billId:0,consumption:0,forfeit:0,totalPaid:0,receiptNumber:"",deadlineOfBill:""}},watch:{amountReceived:function(){0!=this.amountReceived.length?this.debitBalance=parseFloat(this.currentBillValue)-parseFloat(this.amountReceived):this.debitBalance=0},paymentMethod:function(){7==this.paymentMethod&&console.log("Initiating M-Pesa transaction")},paymentDate:function(){var t=gt()(new Date(this.deadlineOfBill)).add(15,"days").toDate(),e=gt()(this.paymentDate).isSame(t,"month");console.log(this.paymentDate),console.log(e),e?this.searchCustomer():(this.currentBillValue=(this.currentBillValue-this.currentForfeit).toFixed(2),this.$refs["invalidate-forfeit"].show(),this.currentForfeit=0)}},methods:{generatePDFFile:function(){var t=document.createElement("canvas");Aa()(t,"123456789",{format:"CODE39"});var e=t.toDataURL("image/png");console.log(e);var a="".concat((new Date).getDate(),"-").concat((new Date).getMonth()+1,"-").concat((new Date).getFullYear());console.log(a);var r,n=[],s=Object(vt["a"])(this.payments);try{for(s.s();!(r=s.n()).done;){var i=r.value,o=[];o.push({text:i.billId+"/SAF/2021",style:"estilo"}),o.push({text:i.customerName,style:"estilo"}),o.push({text:i.reference,style:"estilo"}),o.push({text:i.dateOfPayment,style:"estilo"}),o.push({text:i.createdAt,style:"estilo"}),o.push({text:this.getPaymentMethod(i.paymentMethod),style:"estilo"}),o.push({text:i.totalPaid.toFixed(2),style:"estilo"}),n.push(o)}}catch(l){s.e(l)}finally{s.f()}var c={content:[{columns:[{text:"RELATÓRIO DO CAIXA: "+"".concat(a),style:"header"},{text:"TOTAL RECEBIDO: "+this.currentBalance.toFixed(2)+" MZN\n\n",style:"header"}]},{table:{body:[[{text:"Factura/Recibo",style:"columnsTitle"},{text:"Nome do cliente",style:"columnsTitle"},{text:"Referência",style:"columnsTitle"},{text:"Data Depósito",style:"columnsTitle"},{text:"Data de Confirmação",style:"columnsTitle"},{text:"Modo de Pagamento",style:"columnsTitle"},{text:"Valor Pago",style:"columnsTitle"}]].concat(n)}}],styles:{header:{fontSize:10,bold:!0},columnsTitle:{fontSize:8,bold:!0,fillColor:"#7159c1",color:"#FFFFFF"},estilo:{fontSize:8}}};Rt.a.createPdf(c).open()},getPaymentMethod:function(t){return 1==t?"Boca do Caixa":2==t?"Depósito Bancário":3==t?"Transferência Bancária":4==t?"POS":5==t?"Cheque":6==t?"SISTAFE":7==t?"M-Pesa Open API":8==t?"E-Mola":void 0},cancelValidation:function(){this.$refs["invalidate-forfeit"].hide(),this.searchCustomer()},invalidateMulta:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,a={billId:t.billId,staffId:t.user[0].id,invalidateMulta:1},e.prev=2,e.next=5,Ue.insertDebt(a,t.token);case 5:r=e.sent,1==r.success?t.searchCustomer():console.log(r.message),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0.message);case 12:t.show=!1,t.$refs["invalidate-forfeit"].hide();case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))()},finalizepayment:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,a={id:t.billId,billId:t.billId,barcode:t.barcode,customerName:t.customer[0].name,tarrifTypeId:t.customer[0].tarrifTypeId,branchId:t.customer[0].branchId,staffId:t.user[0].id,staffName:t.user[0].name,consumption:t.consumption,vat:t.vat,subTotal:t.subTotal,fine:t.forfeit,totalPaid:t.amountReceived,saldoDevedor:t.debitBalance,reference:t.paymentReference,dateOfPayment:t.paymentDate,paymentMethod:t.paymentMethod},e.prev=2,e.next=5,Da.insertPayment(a,t.token);case 5:r=e.sent,1==r.success?(t.$bvToast.toast(r.message,{title:"",variant:"success",solid:!0}),t.amountReceived=0,t.debitBalance=0,t.referenceOfPayment="",t.paymentMethod="",t.dateOfPayment="",t.searchCustomer(),t.getAllPayments()):t.$bvToast.toast(r.message,{title:"",variant:"warning",solid:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0.message);case 12:t.show=!1,t.$refs["validate-bill"].hide();case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))()},getAllPayments:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,e.prev=1,e.next=4,Ca.getPaymentsByStaffId(t.user[0].id,t.token);case 4:a=e.sent,1==a.success?(t.currentBalance=a.totalPaid,t.payments=a.result):t.currentBalance=0,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),t.currentBalance=0,console.log(e.t0.message);case 12:t.show=!1;case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))()},submitBill:function(t){this.currentForfeit=parseFloat(t.forfeit),this.consumption=t.totalUnities,this.receiptNumber=t.receiptNumber,this.billId=t.billId,this.vat=parseFloat(t.vat),this.subTotal=parseFloat(t.subTotal)+parseFloat(t.vat),this.currentBillValue=t.total,this.fine=parseFloat(t.forfeit),this.deadlineOfBill=t.createdAt,this.$refs["validate-bill"].show()},getSubtotalValue:function(t){var e,a=t.consumption;if(2==this.customer[0].tarrifTypeId&&a<=5){e=ha.domesticBelowFive(5,this.currentTariff[0]);var r=e[0].subTotal,n=e[0].total*t.forfeit,s=e[0].total+n,i=e[0].tax;this.currentBillValue=s.toFixed(2);var o={subTotal:r.toFixed(2),totalOfBill:s.toFixed(2),forfeit:n.toFixed(2),vat:i};return o}if((2==this.customer[0].tarrifTypeId||3==this.customer[0].tarrifTypeId)&&a>5){e=ha.domesticAboveFive(a,this.currentTariff[0]);var c=e[0].subTotal,l=e[0].total*t.forfeit,u=e[0].total+l,d=e[0].tax;this.currentBillValue=u.toFixed(2);var m={subTotal:c.toFixed(2),totalOfBill:u.toFixed(2),forfeit:l.toFixed(2),vat:d};return m}if(1==this.customer[0].tarrifTypeId){e=ha.fontCalc(a,this.currentTariff[0]);var p=e[0].subTotal,f=e[0].total*t.forfeit,b=e[0].total+f,v=e[0].tax;this.currentBillValue=b.toFixed(2);var h={subTotal:p.toFixed(2),totalOfBill:b.toFixed(2),forfeit:f.toFixed(2),vat:v};return h}if(this.customer[0].tarrifTypeId>=4){e=ha.calculatePublicComercialAndIndustrial(a,this.currentTariff[0]);var g=e[0].subTotal,_=e[0].total*t.forfeit,y=e[0].total+_,x=e[0].tax;this.currentBillValue=y.toFixed(2);var w={subTotal:g.toFixed(2),totalOfBill:y.toFixed(2),forfeit:_.toFixed(2),vat:x};return w}},populateValues:function(){this.customerName=this.customer[0].name,this.customerAddress=this.customer[0].address,this.customerNationalId=this.customer[0].meeter_id,this.customerPhone=this.customer[0].phone,this.customerEmail=this.customer[0].email,this.customerNuit=this.customer[0].nuit},clearValues:function(){this.customerName="",this.customerAddress="",this.customerNationalId="",this.customerPhone="",this.customerEmail="",this.customerNuit=""},editCustomer:function(){this.editting=!0},cancelEditing:function(){this.editting=!1},editCustomerFinal:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,a={id:t.customer[0].id,status:t.customer[0].status,name:t.customerName,address:t.customerAddress,phone:t.customerPhone,email:t.customerEmail,nuit:t.customerNuit,meeter_id:t.customerNationalId},e.prev=2,e.next=5,tt.insertOrUpdateCustomer(a,t.token);case 5:r=e.sent,1==r.success?(t.show=!1,t.$bvToast.toast(a.name+" actualizado com sucesso",{title:"",variant:"success",solid:!0}),t.searchCustomer()):(t.customers=r.result,t.show=!1,t.$bvToast.toast(r.message,{title:"",variant:"warning",solid:!0})),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),t.$bvToast.toast(""+e.t0,{title:"Erro",variant:"danger",solid:!0}),t.show=!1;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))()},searchCustomer:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.barcode,t.show=!0,0!==a.length){e.next=6;break}return t.show=!1,t.customer=[],e.abrupt("return");case 6:return e.prev=6,e.next=9,Ra.searchCustomers(t.barcode,t.token);case 9:r=e.sent,1==r.success?(t.customer=r.result,t.show=!1,t.populateValues(),t.getTariffById(),t.fetchAllReadings()):(t.show=!1,t.error=r.message,t.customer=[],t.readings=[],t.clearValues()),e.next=21;break;case 13:e.prev=13,e.t0=e["catch"](6),t.$bvToast.toast(""+e.t0.message,{title:"Erro",variant:"danger",solid:!0}),t.show=!1,t.customer=[],t.error=e.t0.message,t.clearValues(),t.readings=[];case 21:t.show=!1,t.editting=!1;case 23:case"end":return e.stop()}}),e,null,[[6,13]])})))()},getTariffById:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,e.prev=1,e.next=4,ya.getTarrifsByCategory(t.customer[0].tarrifTypeId);case 4:a=e.sent,1==a.success?t.currentTariff=a.result:t.$bvToast.toast("Tarifa não disponível.",{title:"Error",variant:"danger",solid:!0}),t.show=!1,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),t.show=!1;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},fetchAllReadings:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,e.prev=1,e.next=4,Lt.getReadingsByCustomer(t.barcode,t.customer[0].tarrifTypeId,t.token);case 4:a=e.sent,1==a.success?(t.readings=a.result,t.facturas=a.facturas,t.error_readings=""):(t.error_readings=a.message,t.readings=[],t.facturas=[]),t.show=!1,e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](1),t.error_readings=e.t0.message,t.readings=[],t.show=!1;case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))()},tariffId:function(t){return 1==t?(this.quantityMinTariff=0,"Fontenária"):2==t?(this.quantityMinTariff=5,"Doméstica"):3==t?(this.quantityMinTariff=0,"Municipal"):4==t?(this.quantityMinTariff=15,"Comercial"):5==t?(this.quantityMinTariff=15,"Público"):6==t?(this.quantityMinTariff=15,"Industrial"):void 0}}},Oa=Ia,Na=(a("fe25"),Object(u["a"])(Oa,ca,la,!1,null,"f3fefe06",null)),Ma=Na.exports,za=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-row",[a("b-col",[a("b-card",{attrs:{"header-tag":"header"}},[a("b-row",[a("b-col",{attrs:{lg:"2"}},[a("b-button",{attrs:{variant:"outline-primary",block:""}},[a("b-icon",{attrs:{icon:"plus-square-fill"}}),a("span",[t._v(" Compor Mensagem")])],1),a("b-list-group",{staticClass:"mt-1"},t._l(t.messageCategory,(function(e){return a("b-list-group-item",{key:e.value,staticClass:"d-flex justify-content-between align-items-center",on:{click:function(a){return t.getMessages(e.value)}}},[a("small",[a("b",[t._v(t._s(e.text))])]),a("b-badge",{attrs:{variant:"secondary",pill:""}},[t._v(t._s(t.getMessagesCount(e.value)))])],1)})),1)],1),a("b-col",{},[a("b-input-group",{staticClass:"input-messages"},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"chat-dots-fill"}})],1),a("b-form-input",{attrs:{type:"text",size:"md",placeholder:"Pesquisar mensagens"},on:{keyup:function(e){return t.searchMessages()}},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),a("b-overlay",{staticClass:"mt-2 mb-2 bg-white",attrs:{show:t.isLoading,rounded:"lg"}},[t.filteredMessages.length>0?a("b-row",{staticClass:"mt-0"},[a("b-col",t._l(t.filteredMessages,(function(e){return a("b-row",{key:e.id,staticClass:"message-body"},[a("b-col",{attrs:{lg:"3"}},[t._v(t._s(e.customerName))]),a("b-col",[t._v(t._s(e.messageBody))]),a("b-col",{staticClass:"text-right",attrs:{lg:"2"}},[t._v(t._s(e.sentDateTime))])],1)})),1)],1):t._e()],1)],1)],1)],1)],1)],1)],1)},Ba=[],ja="api/supportMessages",Ea=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllMessages",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(ja,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getMessages",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(ja,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"deleteMessage",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(ja,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertMessage",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(ja,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),La=Ea,Va={name:"Profile",computed:Object(_["a"])({},Object(f["b"])(["user","token"])),created:function(){this.getAllMessages()},components:{NavBar:pt},data:function(){return{isLoading:!1,search:"",messages:[],filteredMessages:[],messageCategory:[{value:0,text:"Reporte de fugas"},{value:1,text:"Falta de água"},{value:2,text:"Avarias"},{value:3,text:"Falta de facturas"},{value:4,text:"Reclamações"},{value:5,text:"Outros"}]}},methods:{searchMessages:function(){console.log("Hello from searching messages.")},sendMessages:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.isLoading=!0;case 1:case"end":return e.stop()}}),e)})))()},getAllMessages:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,La.getAllMessages(t.token);case 4:a=e.sent,1==a.success?(t.messages=a.result,t.$store.commit("SET_NOTIFICATIONS",t.messages),t.isLoading=!1):(t.messages=[],t.isLoading=!1,t.$store.commit("SET_NOTIFICATIONS",[])),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](1),t.$store.commit("SET_NOTIFICATIONS",[]),t.isLoading=!1,console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getMessagesCount:function(t){var e=this.messages.filter((function(e){return e.categoryType==t}));return e.length},getMessages:function(t){this.filteredMessages=this.messages.filter((function(e){return e.categoryType==t}))}}},Fa=Va,Ua=(a("aef8"),Object(u["a"])(Fa,za,Ba,!1,null,"e5dfddb4",null)),qa=Ua.exports,Wa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login-body"},[a("login-navbar"),a("b-row",[a("b-col",{attrs:{lg:"12",sm:"12",md:"12"}},[a("form",{staticClass:"form-login",on:{submit:function(e){return e.preventDefault(),t.registerNewCustomer()}}},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header text-center"},[t._v(" "+t._s(t.$t("new_customer"))+" ")]),a("div",{staticClass:"card-body"},[a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],staticClass:"form-control",attrs:{disabled:t.loading,required:"",type:"text",size:"sm",placeholder:t.$t("name")},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),a("b-row",[a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("b-form-group",{attrs:{id:"email"}},[a("b-form-input",{attrs:{type:"email",disabled:t.loading,required:"",size:"sm",placeholder:t.$t("email")},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1),a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("b-form-group",{attrs:{id:"password"}},[a("b-form-input",{attrs:{type:"password",disabled:t.loading,required:"",size:"sm",placeholder:t.$t("password")},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1)],1),a("b-row",[a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("b-form-group",{attrs:{id:"phone"}},[a("b-form-input",{attrs:{type:"number",disabled:t.loading,required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1)],1),a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("b-form-group",{attrs:{id:"nuit"}},[a("b-form-input",{attrs:{type:"number",disabled:t.loading,required:"",size:"sm",placeholder:t.$t("nuit")},model:{value:t.nuit,callback:function(e){t.nuit=e},expression:"nuit"}})],1)],1)],1),a("b-row",[a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("b-form-group",{attrs:{id:"identification"}},[a("b-form-input",{attrs:{type:"text",disabled:t.loading,required:"",size:"sm",placeholder:t.$t("identification")},model:{value:t.id_number,callback:function(e){t.id_number=e},expression:"id_number"}})],1)],1),a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("b-form-group",{attrs:{id:"address"}},[a("b-form-input",{attrs:{type:"text",disabled:t.loading,required:"",size:"sm",placeholder:t.$t("address")},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1)],1)],1),a("b-row",[a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("small",[t._v(t._s(t.$t("province")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm",disabled:t.loading},model:{value:t.provinceId,callback:function(e){t.provinceId=e},expression:"provinceId"}},t._l(t.provinces,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id,disabled:t.loading}},[t._v(t._s(e.name))])})),1)],1),a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("small",[t._v(t._s(t.$t("district")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm",disabled:t.loading},model:{value:t.districtId,callback:function(e){t.districtId=e},expression:"districtId"}},t._l(t.selectedDistricts,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id,disabled:t.provinceId<=0}},[t._v(t._s(e.name))])})),1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("neighbor")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm",disabled:t.loading},model:{value:t.neighborhood,callback:function(e){t.neighborhood=e},expression:"neighborhood"}},t._l(t.selectedneighbors,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id,disabled:t.provinceId<=0}},[t._v(t._s(e.name))])})),1)],1),a("b-col",[a("div",{staticClass:"form-group"},[a("small",[t._v(t._s(t.$t("tarrif_type")))]),a("b-form-select",{attrs:{size:"sm",disabled:t.loading,options:t.tariffs},model:{value:t.tarrifTypeId,callback:function(e){t.tarrifTypeId=e},expression:"tarrifTypeId"}})],1)])],1),a("b-row",[a("b-col",[a("p",{staticClass:"btn btn-primary btn-sm w-100",on:{click:function(e){return t.backToLogin()}}},[[t._v(" "+t._s(t.$t("login"))+" ")]],2)]),a("b-col",[a("button",{staticClass:"btn btn-success btn-sm w-100",attrs:{disabled:t.loading}},[t.loading?[t._v(" "+t._s(t.$t("submiting"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)])],1)],1)])])])],1),a("b-row",{staticClass:"footer"},[a("b-col",[t._v("Copyright ©2021 Water & Energy Resources, LDA. All rights reserved.")])],1)],1)},Ya=[],Ga=r["default"].extend({computed:Object(_["a"])(Object(_["a"])({},Object(f["b"])(["user"])),{},{nextRoute:function(){return this.$route.query.redirect||"/dashboard"}}),components:{LoginNavbar:D},data:function(){return{tariffs:[{value:1,text:"Fontenária"},{value:2,text:"Doméstica"},{value:3,text:"Municipal"},{value:4,text:"Comércio & Público"},{value:5,text:"Indústria"}],name:"",phone:"",nuit:"",address:"",password:"",tarrifTypeId:"",email:"",id_number:"",neighborhood:"",error:null,loading:!1,provinces:[],districts:[],districtId:0,provinceId:0,id:0,selectedDistricts:""}},watch:{provinceId:function(){var t=this;this.selectedDistricts=this.districts.filter((function(e){return e.provinceId===t.provinceId}))}},created:function(){this.getProvinces()},methods:{backToLogin:function(){this.$router.push("/")},registerUserToDatabase:function(t){var e=this;return Object(g["a"])(regeneratorRuntime.mark((function a(){var r,n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,E.getApiKey(t.uid);case 3:if(r=a.sent,1!=r.success){a.next=12;break}return n=r.token,a.next=8,tt.insertOrUpdateCustomer(t,n);case 8:s=a.sent,1==s.success?(e.$bvToast.toast("Pré registo efectuado com sucesso",{title:"Sucesso",variant:"success",solid:!0}),e.loading=!1,e.$router.replace("/")):(e.$bvToast.toast(s.message,{title:"Error",variant:"danger",solid:!0}),e.loading=!1),a.next=14;break;case 12:e.$bvToast.toast(r.message,{title:"Error",variant:"danger",solid:!0}),e.loading=!1;case 14:a.next=20;break;case 16:a.prev=16,a.t0=a["catch"](0),console.log(a.t0),e.loading=!1;case 20:case"end":return a.stop()}}),a,null,[[0,16]])})))()},getProvinces:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,F.getProvinces();case 4:a=e.sent,1==a.success?(t.provinces=a.result,t.getDistricts()):t.loading=!1,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),t.error=e.t0.message,t.loading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getDistricts:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,F.getDistricts(1);case 4:a=e.sent,1==a.success?(t.districts=a.result,t.loading=!1):t.loading=!1,e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](1),t.error=e.t0.message,t.loading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()}}}),Ha=Ga,Qa=(a("c303"),Object(u["a"])(Ha,Wa,Ya,!1,null,"306683d5",null)),Za=Qa.exports,Ja=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"simulator"},[a("login-navbar"),a("b-row",[a("b-col",{attrs:{lg:"12",sm:"12",md:"12"}},[a("form",{staticClass:"simulador",on:{submit:function(e){return e.preventDefault(),t.registerNewCustomer()}}},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-header text-center"},[t._v(" "+t._s(t.$t("water_simulator"))+" ")]),a("div",{staticClass:"card-body"},[a("b-overlay",{attrs:{show:t.isLoading,rounded:"sm"}},[a("b-row",[a("b-col",[a("div",{staticClass:"form-group"},[t._v(" "+t._s(t.$t("tarrif_type"))+" "),a("b-form-select",{attrs:{size:"sm",options:t.tariffs},model:{value:t.tariffTypeId,callback:function(e){t.tariffTypeId=e},expression:"tariffTypeId"}})],1)])],1),a("b-row",[a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("b-form-group",{attrs:{id:"last"}},[a("b-form-input",{attrs:{type:"number",step:"any",min:"0",disabled:"",required:"",size:"sm",placeholder:t.$t("last_reading")},model:{value:t.last,callback:function(e){t.last=e},expression:"last"}})],1)],1),a("b-col",{attrs:{lg:"6",sm:"12",md:"6"}},[a("b-form-group",{attrs:{id:"current"}},[a("b-form-input",{attrs:{type:"number",step:"any",min:"0",disabled:0==t.tariffTypeId,required:"",size:"sm",placeholder:"Quantidade"},model:{value:t.current,callback:function(e){t.current=e},expression:"current"}})],1)],1)],1),a("b-row",[a("b-col",[a("p",{staticClass:"text-center text-secondary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.backToLogin()}}},[t._v(" "+t._s(t.$t("login"))+" ")])]),a("b-col",[a("b-button",{attrs:{disabled:0==t.tariffTypeId||0==t.last.length||0==t.current.length,block:"",size:"sm",variant:"secondary"},on:{click:function(e){return t.simulateBill()}}},[t._v(t._s(t.$t("simulate_bill")))])],1)],1)],1)],1)])])])],1),a("b-row",{staticClass:"footer text-secondary"},[a("b-col",[t._v("Copyright ©2021 TSENANE, LDA. All rights reserved.")])],1),a("b-modal",{ref:"simulator-result",attrs:{"hide-footer":"",size:"lg",title:t.$t("simulator-result")}},[a("simulator-modal",{attrs:{purchaseDetails:t.purchaseDetail,currentTarif:t.currentTariff}})],1)],1)},Ka=[],Xa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"simulator-modal"},[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[a("table",{staticClass:"table table-sm table-hover table'bordered",staticStyle:{"font-size":"8pt"}},[a("tbody",[a("tr",[a("td",{attrs:{width:"40%"}},[a("b",[t._v(t._s(t.$t("description")))])]),a("td",[a("b",[t._v(t._s(t.$t("quantity_")))])]),a("td",[a("b",[t._v(t._s(t.$t("price_per_unit"))+"m"),a("sup",[t._v("3")])])]),a("td",{staticClass:"text-right"},[a("b",[t._v(t._s(t.$t("subtotal")))])])])]),0===t.purchaseDetails[0].id?a("tbody",[a("tr",[a("td",[t._v(t._s(t.$t("fixed_tax")))]),a("td",[t._v(t._s(1))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].serviceAvailabilityFee,expression:"currentTarif[0].serviceAvailabilityFee"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].serviceAvailabilityFee,expression:"currentTarif[0].serviceAvailabilityFee"}],staticClass:"text-right"})]),a("tr",[a("td",[t._v(t._s(t.$t("minimum_consuption")))]),a("td",[t._v(t._s(5))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].socialTire/5,expression:"currentTarif[0].socialTire / 5"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].socialTire,expression:"currentTarif[0].socialTire"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.$t("total_without_vat")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].subTotal,expression:"purchaseDetails[0].subTotal"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.$t("vat")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].tax,expression:"purchaseDetails[0].tax"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[a("b",[t._v("SUBTOTAL DE CONTAS DE ÁGUA")])]),a("td",{staticClass:"text-right"},[a("b",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].total,expression:"purchaseDetails[0].total"}]})])])]):1===t.purchaseDetails[0].id?a("tbody",[a("tr",[a("td",[t._v(" "+t._s(t.$t("price_per_m_3"))+" ")]),a("td",[t._v(t._s(t.purchaseDetails[0].quantity))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].pricePerMeterCubic,expression:"currentTarif[0].pricePerMeterCubic"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].subTotal,expression:"purchaseDetails[0].subTotal"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.$t("vat")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].tax,expression:"purchaseDetails[0].tax"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[a("b",[t._v("SUBTOTAL DE CONTAS DE ÁGUA")])]),a("td",{staticClass:"text-right"},[a("b",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].total,expression:"purchaseDetails[0].total"}]})])])]):2===t.purchaseDetails[0].id?a("tbody",[a("tr",[a("td",[t._v(t._s(t.$t("fixed_tax")))]),a("td",[t._v(t._s(1))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].serviceAvailabilityFee,expression:"currentTarif[0].serviceAvailabilityFee"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].serviceAvailabilityFee,expression:"currentTarif[0].serviceAvailabilityFee"}],staticClass:"text-right"})]),a("tr",[a("td",[t._v(t._s(t.$t("first_five")))]),a("td",[t._v(t._s(5))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].socialTire/5,expression:"currentTarif[0].socialTire / 5"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].socialTire,expression:"currentTarif[0].socialTire"}],staticClass:"text-right"})]),a("tr",[a("td",[t._v(" "+t._s(t.$t("first_seven"))+" ")]),a("td",[t._v(t._s(t.purchaseDetails[0].base[0].baseEscDois))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].firstSeven,expression:"currentTarif[0].firstSeven"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].escalaoDois,expression:"purchaseDetails[0].escalaoDois"}],staticClass:"text-right"})]),t.purchaseDetails[0].escalaoTres>0?a("tr",[a("td",[t._v(" "+t._s(t.$t("above_seven"))+" ")]),a("td",[t._v(t._s(t.purchaseDetails[0].base[0].baseEscTres))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].aboveSeven,expression:"currentTarif[0].aboveSeven"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].escalaoTres,expression:"purchaseDetails[0].escalaoTres"}],staticClass:"text-right"})]):t._e(),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.$t("total_without_vat")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].subTotal,expression:"purchaseDetails[0].subTotal"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.$t("vat")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].tax,expression:"purchaseDetails[0].tax"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[a("b",[t._v("SUBTOTAL DE CONTAS DE ÁGUA")])]),a("td",{staticClass:"text-right"},[a("b",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].total,expression:"purchaseDetails[0].total"}]})])])]):t.purchaseDetails[0].id>=4?a("tbody",[a("tr",[a("td",[t._v(t._s(t.$t("fixed_tax")))]),a("td",[t._v(t._s(1))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].serviceAvailabilityFee,expression:"currentTarif[0].serviceAvailabilityFee"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].serviceAvailabilityFee,expression:"currentTarif[0].serviceAvailabilityFee"}],staticClass:"text-right"})]),a("tr",[a("td",[t._v(" "+t._s(t.$t("first_fifteen"))+" ")]),a("td",[t._v(t._s(15))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].firstFifteen/15,expression:"currentTarif[0].firstFifteen / 15"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].firstFifteen,expression:"currentTarif[0].firstFifteen"}],staticClass:"text-right"})]),t.purchaseDetails[0].base[0].baseEscDois>0?a("tr",[a("td",[t._v(" "+t._s(t.$t("above_fifteen"))+" ")]),a("td",[t._v(t._s(t.purchaseDetails[0].base[0].baseEscDois))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.currentTarif[0].aboveFifteen,expression:"currentTarif[0].aboveFifteen"}]}),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].escalaoDois,expression:"purchaseDetails[0].escalaoDois"}],staticClass:"text-right"})]):t._e(),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.$t("total_without_vat")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].subTotal,expression:"purchaseDetails[0].subTotal"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.$t("vat")))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].tax,expression:"purchaseDetails[0].tax"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[a("b",[t._v("SUBTOTAL DE CONTAS DE ÁGUA")])]),a("td",{staticClass:"text-right"},[a("b",{directives:[{name:"money-format",rawName:"v-money-format",value:t.purchaseDetails[0].total,expression:"purchaseDetails[0].total"}]})])])]):t._e(),a("tbody",[a("tr",[a("td",{staticClass:"bg-dark",attrs:{colspan:"4"}})])]),a("tbody",[a("tr",[a("td",{attrs:{colspan:"3"}},[t._v("Dívida do contador pré-pago")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.prePaidMeterDue,expression:"prePaidMeterDue"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v("Sistema de Gestão de Vendas")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.vendingSystem,expression:"vendingSystem"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v("Caixa de instalação de contador DN20")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.installationMeterBox,expression:"installationMeterBox"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v("Válvula de corte 3/4 mm, PN 16 bar")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.cutValve,expression:"cutValve"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v("IVA 17%")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.totalMeterDues(),expression:"totalMeterDues()"}],staticClass:"text-right"})]),a("tr",[a("th",{attrs:{colspan:"3"}},[t._v("SUBTOTAL DE INSTALAÇÃO DO CONTADOR PRÉ-PAGO")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.subtotalOfMeterInstallation,expression:"subtotalOfMeterInstallation"}],staticClass:"text-right"})])]),a("tr",{staticStyle:{"font-size":"12px"}},[a("th",{attrs:{colspan:"3"}},[t._v("TOTAL A PAGAR PRIMEIRO MÊS")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.total2PayFirstMonth,expression:"total2PayFirstMonth"}],staticClass:"text-right"})]),a("tbody",[a("tr",[a("td",{staticClass:"bg-dark",attrs:{colspan:"4"}})])]),a("tbody",[a("tr",[a("td",{attrs:{colspan:"3"}},[t._v("Dívida do contador pré-pago")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.prePaidMeterDue,expression:"prePaidMeterDue"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v("Sistema de Gestão de Vendas (2º mês a diante)")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.vendingSystemSecondMonth,expression:"vendingSystemSecondMonth"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"3"}},[t._v("IVA 17% (2º mês a diante)")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.vatSecondMonthOnWards,expression:"vatSecondMonthOnWards"}],staticClass:"text-right"})]),a("tr",{staticStyle:{"font-size":"12px"}},[a("th",{attrs:{colspan:"3"}},[t._v("Subtotal da dívida do contador pré-pago")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.vendingSystemSecondMonth+t.vatSecondMonthOnWards+t.prePaidMeterDue,expression:"vendingSystemSecondMonth + vatSecondMonthOnWards + prePaidMeterDue"}],staticClass:"text-right"})]),a("tr",{staticStyle:{"font-size":"12px"}},[a("th",{attrs:{colspan:"3"}},[t._v("TOTAL A PAGAR SEGUNDO MÊS")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.total2PaySecondMonthOnwards,expression:"total2PaySecondMonthOnwards"}],staticClass:"text-right"})])])])])],1)},tr=[],er={name:"simulator-modal",props:["purchaseDetails","currentTarif","quantity"],data:function(){return{show:!1,prePaidMeterDue:233.3333333333333,vendingSystem:260,vendingSystemSecondMonth:40,installationMeterBox:1512.16,cutValve:30.5,vat:0,vatSecondMonthOnWards:0,subtotalOfMeterInstallation:0,total2PayFirstMonth:0,total2PaySecondMonthOnwards:0}},computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","currentCustomer","availableCustomerBalance"])),created:function(){console.log(this.purchaseDetails)},methods:{printDocument:function(){Ae()("printable","html")},totalMeterDues:function(){var t=this.prePaidMeterDue+this.vendingSystem+this.installationMeterBox+this.cutValve;this.vat=.17*t,this.subtotalOfMeterInstallation=this.vat+t,this.total2PayFirstMonth=this.subtotalOfMeterInstallation+this.purchaseDetails[0].total;var e=this.prePaidMeterDue+this.vendingSystemSecondMonth;return this.vatSecondMonthOnWards=.17*e,this.total2PaySecondMonthOnwards=e+this.vatSecondMonthOnWards+this.purchaseDetails[0].total,this.vat},finalizePurchase:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r,n,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.show=!0,a=parseFloat(t.purchaseDetails[0].total),r=parseFloat(0==t.availableCustomerBalance?0:t.availableCustomerBalance[0].balance),n=r-a,n<0)t.$bvToast.toast("Sem saldo suficiente para efectuar esta compra. O seu saldo é de "+r.toFixed(2)+" MZN",{variant:"warning",solid:!0}),t.show=!1;else{s={customerId:t.currentCustomer.id,customerName:t.currentCustomer.name,meterNumber:t.currentCustomer.barcode,phoneNumber:t.currentCustomer.phone,tariffType:t.getTariffType(t.currentCustomer.tarrifTypeId),branchId:t.currentCustomer.branchId,staffId:t.currentUser[0].id,last:0,current:0,quantity:t.quantity,fixedTax:t.purchaseDetails[0].fixedTax,vat:t.purchaseDetails[0].tax,subTotal:t.purchaseDetails[0].subTotal,fine:0,totalPaid:t.purchaseDetails[0].total,staff:t.currentUser[0].name,voucher:Math.floor(1e20*Math.random()-1),remainderBalance:n};try{i=Da.insertPurchase(s,t.token),t.$bvToast.toast(i.message,{variant:"success",solid:!0}),t.show=!1,t.printDocument(),t.$emit("finalize-purchase")}catch(o){t.$bvToast.toast(o.message,{variant:"danger",solid:!0}),t.show=!1}}case 5:case"end":return e.stop()}}),e)})))()},getTariffType:function(t){return 1==t?(this.quantityMinTariff=0,"Fontenária"):2==t?(this.quantityMinTariff=5,"Doméstica"):3==t?(this.quantityMinTariff=0,"Municipal"):4==t?(this.quantityMinTariff=25,"Comércio & Público"):5==t?(this.quantityMinTariff=50,"Indústria"):void 0}}},ar=er,rr=Object(u["a"])(ar,Xa,tr,!1,null,null,null),nr=rr.exports,sr={name:"Simulator",components:{LoginNavbar:D,SimulatorModal:nr},data:function(){return{tariffs:[{value:1,text:"Fontenária"},{value:2,text:"Doméstica"},{value:3,text:"Municipal"},{value:4,text:"Comercial"},{value:5,text:"Público"},{value:5,text:"Industrial"}],tariffTypeId:0,isLoading:!1,currentTariff:"",last:0,current:"",purchaseDetail:""}},watch:{tariffTypeId:function(){this.getTariffById(this.tariffTypeId)}},methods:{backToLogin:function(){this.$router.push("/")},simulateBill:function(){var t=parseFloat(this.last),e=parseFloat(this.current),a=this.tariffTypeId;if(e<t)this.$bvToast.toast("A leitura actual deve ser igual ou superior à anterior.",{title:"Error",variant:"danger",solid:!0});else{var r=e-t;if(2===a||3===a)if(r<=5){var n=ha.domesticBelowFive(r,this.currentTariff[0]);this.purchaseDetail=n,this.showDetails=!0,this.$refs["simulator-result"].show()}else{var s=ha.domesticAboveFive(r,this.currentTariff[0]);this.purchaseDetail=s,this.showDetails=!0,this.$refs["simulator-result"].show()}else if(1===a){var i=ha.fontCalc(r,this.currentTariff[0]);this.purchaseDetail=i,this.showDetails=!0,this.$refs["simulator-result"].show()}else if(a>=4){var o=ha.calculatePublicComercialAndIndustrial(r,this.currentTariff[0]);this.purchaseDetail=o,this.showDetails=!0,this.$refs["simulator-result"].show()}}},getTariffById:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,ya.getTarrifsByCategory(t.tariffTypeId);case 4:a=e.sent,1==a.success?t.currentTariff=a.result:t.$bvToast.toast("Tarifa não disponível.",{title:"Error",variant:"danger",solid:!0}),t.isLoading=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log(e.t0.message),t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}}},ir=sr,or=(a("cd5b"),Object(u["a"])(ir,Ja,Ka,!1,null,"7ec366e6",null)),cr=or.exports,lr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-container",{staticClass:"bv-example-row mt-2"},[a("b-row",[a("b-col",[a("h4",{ref:"content",staticClass:"texte-center text-white"},[a("center",[t._v(" "+t._s(t.currentUser[0].name)+" - "),a("small",[t._v(t._s(t.getUserProfile(t.currentUser[0].userRole)))])])],1)])],1),a("hr",{staticClass:"bg-info mt-1"}),a("b-row",[a("b-col",{attrs:{lg:"3"}}),a("b-col",[a("b-card",{attrs:{"header-tag":"header"},scopedSlots:t._u([{key:"header",fn:function(){return[a("h5",{staticClass:"mb-0"},[t._v(t._s(t.$t("update_profile")))])]},proxy:!0}])},[a("small",[t._v(t._s(t.$t("name")))]),a("b-form-group",{attrs:{id:"name","label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text",placeholder:t.$t("name"),size:"sm",disabled:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("small",[t._v(t._s(t.$t("phone")))]),a("b-form-group",{attrs:{id:"phone","label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"text",placeholder:t.$t("phone"),size:"sm",disabled:""},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),a("small",[t._v(t._s(t.$t("old_password")))]),a("b-form-group",{attrs:{"label-for":"old_password"}},[a("b-form-input",{attrs:{id:"oldPassword",type:"password",placeholder:t.$t("old_password"),size:"sm",disabled:t.isLoading},model:{value:t.oldPassword,callback:function(e){t.oldPassword=e},expression:"oldPassword"}})],1),a("small",[t._v(t._s(t.$t("new_password")))]),a("b-form-group",{attrs:{"label-for":"new_password"}},[a("b-form-input",{attrs:{id:"newPassword",type:"password",placeholder:t.$t("new_password"),size:"sm",disabled:t.isLoading},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}})],1),a("small",[t._v(t._s(t.$t("confirm_password")))]),a("b-form-group",{attrs:{"label-for":"confirm_password"}},[a("b-form-input",{attrs:{id:"confirmPassword",type:"password",placeholder:t.$t("confirm_password"),size:"sm",disabled:t.isLoading},model:{value:t.confirmPassword,callback:function(e){t.confirmPassword=e},expression:"confirmPassword"}})],1),a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:t.confirmPassword.length<6||t.newPassword.length<6||t.oldPassword.length<6||1==t.isLoading,block:"",size:"sm"},on:{click:function(e){return t.updateProfile()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("update")))]],2)],1)],1),a("b-col",{attrs:{lg:"3"}})],1)],1)],1)},ur=[],dr={name:"Profile",computed:Object(_["a"])({},Object(f["b"])(["user","currentUser","token"])),created:function(){this.$store.commit("SET_CLEAR_CURRENT_VENDING"),this.populateValues()},components:{NavBar:pt},data:function(){return{isLoading:!1,name:"",phone:"",oldPassword:"",newPassword:"",confirmPassword:"",passwordConfirmation:""}},methods:{populateValues:function(){this.name=this.currentUser[0].name,this.phone=this.currentUser[0].phoneNumber},updateProfile:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isLoading=!0,t.currentUser[0].code!=t.oldPassword){e.next=19;break}if(t.newPassword!=t.confirmPassword){e.next=16;break}return a={id:t.currentUser[0].id,code:t.newPassword},e.prev=4,e.next=7,z.updatePassword(a,t.token);case 7:r=e.sent,1==r.success?t.$bvToast.toast(r.message,{title:"",variant:"success",solid:!0}):t.$bvToast.toast(r.message,{title:"",variant:"warning",solid:!0}),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](4),t.$bvToast.toast(e.t0.message,{title:"",variant:"error",solid:!0});case 14:e.next=17;break;case 16:t.$bvToast.toast("Nova senha não coincide com a senha de confirmação.",{title:"",variant:"danger",solid:!0});case 17:e.next=20;break;case 19:t.$bvToast.toast("A senha antiga não coincide com a que digitou, tente outra vez.",{title:"",variant:"danger",solid:!0});case 20:t.isLoading=!1,t.oldPassword="",t.newPassword="",t.confirmPassword="";case 24:case"end":return e.stop()}}),e,null,[[4,11]])})))()},getUserProfile:function(t){return 1==t?"Súper Admin":3==t?"Caixa":void 0}}},mr=dr,pr=Object(u["a"])(mr,lr,ur,!1,null,null,null),fr=pr.exports,br=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[a("div",{staticClass:"container-group"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("b-overlay",{attrs:{show:t.isLoading,rounded:"sm"}},[a("b-row",[a("b-col",[a("b-row",{staticClass:"mb-1"},[a("b-col",[a("b-form-select",{attrs:{options:t.options},model:{value:t.selectedPaymentMethod,callback:function(e){t.selectedPaymentMethod=e},expression:"selectedPaymentMethod"}})],1),a("b-col",[a("b-form-datepicker",{attrs:{placeholder:"M",block:"",size:"sm",id:"from-datepicker"},model:{value:t.fromDate,callback:function(e){t.fromDate=e},expression:"fromDate"}})],1),a("b-col",[a("b-form-datepicker",{attrs:{placeholder:t.$t("to"),block:"",size:"sm",id:"to-datepicker"},model:{value:t.toDate,callback:function(e){t.toDate=e},expression:"toDate"}})],1),a("b-col",{attrs:{cols:"1"}},[a("b-button",{attrs:{disabled:!t.toDate&&!t.fromDate||t.isLoading,size:"sm",variant:"success",block:""},on:{click:function(e){return t.searchPayments()}}},[a("b-icon",{attrs:{icon:"search"}})],1)],1),a("b-col",{attrs:{cols:"1"}},[a("b-button",{attrs:{disabled:0==t.reports.length,size:"sm",variant:"success",block:""},on:{click:function(e){return t.generateExcelReport()}}},[t._v("Excel "),a("b-icon",{attrs:{icon:"file-excel-fill"}})],1)],1),a("b-col",{attrs:{cols:"1"}},[a("b-button",{attrs:{disabled:0==t.reports.length,size:"sm",variant:"success",block:""},on:{click:function(e){return t.generatePDFReport()}}},[t._v("Pdf "),a("b-icon",{attrs:{icon:"printer-fill"}})],1)],1)],1),t.reports.length>0?a("table",{staticClass:"table table-sm table-hover table-stripped"},[a("thead",[a("tr",{staticStyle:{"font-size":"12pt"}},[a("th",{attrs:{colspan:"7"}},[t._v("TOTAL COLETADO")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.totalRecebido,expression:"totalRecebido"}],staticClass:"text-right",attrs:{colspan:"3"}})])]),a("thead",[a("tr",{staticClass:"bg-dark text-white",attrs:{id:"reportList"}},[a("th",[t._v(t._s(t.$t("name")))]),a("th",[t._v(t._s(t.$t("id_range")))]),a("th",[t._v("Factura/Recibo nº")]),a("th",[t._v(t._s(t.$t("date")))]),a("th",[t._v("Data de confirmação na loja")]),a("th",[t._v(t._s(t.$t("payment_reference")))]),a("th",[t._v(t._s(t.$t("phone")))]),a("th",[t._v(t._s(t.$t("cashier")))]),a("th",[t._v(t._s(t.$t("payment_method")))]),a("th",{staticClass:"text-right"},[t._v(t._s(t.$t("total_paid")))])])]),a("tbody",t._l(t.reports,(function(e){return a("tr",{key:e.id},[a("td",[t._v(t._s(e.customerName))]),a("td",[t._v(t._s(e.barcode))]),a("td",[t._v(t._s(e.billId)+"/SAF")]),a("td",[t._v(t._s(e.dateOfPayment))]),a("td",[t._v(t._s(e.createdAt))]),a("td",[t._v(t._s(e.reference.toUpperCase()))]),a("td",[t._v(t._s(e.phoneNumber))]),a("td",[t._v(t._s(e.staffName))]),a("td",[t._v(t._s(t.getPaymentMethod(e.paymentMethod)))]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(e.totalPaid.toFixed(2))+" MZN ")])])})),0)]):t._e(),0===t.reports.length?a("b-alert",{staticClass:"text-center",attrs:{variant:"danger",show:"",dismissible:""}},[a("i",{staticClass:"fas fa-info"}),t._v(" "+t._s(t.$t("unavailable_purchases"))+" ")]):t._e()],1)],1)],1)],1)])])])],1)},vr=[],hr=a("2e92");Rt.a.vfs=St.a.pdfMake.vfs;var gr=r["default"].extend({name:"Reports",created:function(){this.fromDate=gt()().format("YYYY-MM-DD"),this.toDate=gt()().format("YYYY-MM-DD"),this.searchPayments()},mounted:function(){},components:{NavBar:pt},data:function(){return{reports:[],isLoading:!1,fromDate:"",toDate:"",selectedPaymentMethod:0,options:[{value:0,text:"Meio de pagamento"},{value:1,text:"Boca de Caixa"},{value:2,text:"Depósito Bancário"},{value:3,text:"Transferência Bancária"},{value:4,text:"POS"},{value:5,text:"Cheque"},{value:6,text:"SISTAFE"},{value:7,text:"M-Pesa Open-Api"},{value:8,text:"E-Mola"}],totalRecebido:0,value:""}},computed:Object(_["a"])({},Object(f["b"])(["user","token","user","branches","currentBranch"])),watch:{},methods:{searchPayments:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={paymentMethod:t.selectedPaymentMethod,from:t.fromDate,to:t.toDate},t.isLoading=!0,e.prev=2,e.next=5,Da.getAllPayments(a,t.token);case 5:r=e.sent,0==r.success?(t.reports=[],t.totalRecebido=0):(t.reports=r.result,t.totalRecebido=r.totalRecebido),t.isLoading=!1,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"Error:",variant:"danger",solid:!0}),t.isLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()},generateExcelReport:function(){var t,e=[],a=Object(vt["a"])(this.reports);try{for(a.s();!(t=a.n()).done;){var r=t.value,n={"Data de pagamento":r.dateOfPayment,"Data de confirmação":r.createdAt,"Factura/Recibo":"".concat(r.billId,"/SAF"),"Nome do cliente":r.customerName,Referencia:r.reference.toUpperCase(),"Modo de pagamento":this.getPaymentMethod(r.paymentMethod),"Total Pago":r.totalPaid.toFixed(2),Caixa:r.staffName};e.push(n)}}catch(c){a.e(c)}finally{a.f()}var s="RelatórioDeRecebimentos_"+this.fromDate+"_A_"+this.toDate,i=e,o="xls";Object(hr["a"])({data:i,fileName:s,exportType:o})},generatePDFReport:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r,n,s,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=[],r=Object(vt["a"])(t.reports);try{for(r.s();!(n=r.n()).done;)s=n.value,i=[],i.push({text:s.createdAt,style:"estilo"}),i.push({text:"".concat(s.billId,"/SAF"),style:"estilo"}),i.push({text:s.customerName,style:"estilo"}),i.push({text:s.phoneNumber,style:"estilo"}),i.push({text:s.reference.toUpperCase(),style:"estilo"}),i.push({text:t.getPaymentMethod(s.paymentMethod),style:"estilo"}),i.push({text:s.totalPaid.toFixed(2),style:"estilo"}),a.push(i)}catch(c){r.e(c)}finally{r.f()}o={content:[{columns:[{text:"RELATÓRIO DE PAGAMENTOS\n Data ".concat(t.fromDate," à ").concat(t.toDate,"\n Total coletado: ").concat(t.totalRecebido," MZN\n\n"),style:"header"}]},{table:{body:[[{text:"Data",style:"columnsTitle"},{text:"Factura/Recibo",style:"columnsTitle"},{text:"Cliente",style:"columnsTitle"},{text:"Telefone",style:"columnsTitle"},{text:"Referência",style:"columnsTitle"},{text:"Método de Pagamento",style:"columnsTitle"},{text:"Valor Pago",style:"columnsTitle"}]].concat(a)}}],styles:{header:{fontSize:10,bold:!0},columnsTitle:{fontSize:8,bold:!0,fillColor:"#7159c1",color:"#FFFFFF"},estilo:{fontSize:8}}},Rt.a.createPdf(o).open();case 5:case"end":return e.stop()}}),e)})))()},getPaymentMethod:function(t){return 1==t?"Boca do Caixa":2==t?"Depósito Bancário":3==t?"Transferência Bancária":4==t?"POS":5==t?"Cheque":6==t?"SISTAFE":7==t?"M-Pesa Open-Api":8==t?"E-Mola":void 0}}}),_r=gr,yr=(a("3273"),Object(u["a"])(_r,br,vr,!1,null,"72c475ce",null)),xr=yr.exports,wr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[a("div",{staticClass:"container-group"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("b-row",[a("b-col",{staticClass:"text-dark",attrs:{cols:"4",lg:"3",md:"12",sm:"12"}},[a("h5",{staticStyle:{"font-weight":"bold"}},[t._v(" "+t._s(t.currentBranch.name)+": "+t._s(t.customers.length)+" "+t._s(t.$t("customers"))+" ")])]),a("b-col",{attrs:{cols:"4"}},[a("b-form-select",{staticClass:"mb-1",attrs:{size:"sm"},model:{value:t.branchId,callback:function(e){t.branchId=e},expression:"branchId"}},t._l(t.branches,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.printExcelShet()}}},[a("b-icon",{attrs:{icon:"file-excel-fill"}}),a("small",[t._v(" Devedores")])],1),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.printList()}}},[a("b-icon",{attrs:{icon:"file-pdf-fill"}}),a("small",[t._v("Lista de leituras")])],1),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.printPDFInvoice()}}},[a("b-icon",{attrs:{icon:"file-pdf-fill"}}),a("small",[t._v("Baixar facturas")])],1),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.openAddNewCustomerModal()}}},[a("b-icon",{attrs:{icon:"person-plus-fill"}}),a("small",[t._v(" "+t._s(t.$t("new_customer")))])],1)],1),a("hr",{staticClass:"bg-info mt-0"}),a("b-row",[a("b-col",{attrs:{lg:"12"}},[a("b-card",[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[t.customers.length>0?a("table",{staticClass:"table table-sm table-hover table-stripped",attrs:{id:"my-table"}},[a("thead",{staticClass:"bg-dark text-white",staticStyle:{"font-size":"9pt"}},[a("tr",[a("th",[t._v(t._s(t.$t("name")))]),a("th",[t._v(t._s(t.$t("meter_id")))]),a("th",[t._v(t._s(t.$t("nuit")))]),a("th",[t._v("Tipo")]),a("th",[t._v("Tarifa")]),a("th",[t._v("Telemóvel")]),a("th",[t._v("F/R pendentes")]),a("th",[t._v("Dívida")]),a("th",{staticClass:"text-center"},[t._v(t._s(t.$t("actions")))])])]),a("tbody",t._l(t.customers,(function(e){return a("tr",{key:e.id,class:{active:1==e.status,"bg-danger":2==e.status,"text-white":2==e.status},staticStyle:{cursor:"pointer","font-size":"9pt"}},[a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.barcode))]),a("td",[t._v(t._s(e.nuit))]),a("td",[t._v(t._s(t.meterType(e.meeter_type)))]),a("td",[t._v(t._s(t.tariffId(e.tarrifTypeId)))]),a("td",[t._v(t._s(e.phone))]),a("td",[t._v(" "+t._s(t.getNumberOfPendingBills(e.barcode).length)+" ")]),a("td",[t._v(" "+t._s((t.getTDbt(e.barcode)+t.dividaMlt(e.barcode)).toFixed(2))+" ")]),a("td",[a("b-row",[a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"info"},expression:"{ variant: 'info' }",modifiers:{hover:!0}}],staticClass:"text-center",attrs:{title:t.$t("edit")},on:{click:function(a){return t.editCustomer(e)}}},[a("b-icon",{attrs:{icon:"tag-fill"}})],1),a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"info"},expression:"{ variant: 'info' }",modifiers:{hover:!0}}],staticClass:"text-center",attrs:{title:t.$t("go_to_customer_panel")},on:{click:function(a){return t.openVendingPanel(e)}}},[a("b-icon",{attrs:{icon:"box-arrow-up-right"}})],1),a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"primary"},expression:"{ variant: 'primary' }",modifiers:{hover:!0}}],staticClass:"text-center",attrs:{title:t.$t("go_to_customer_panel")},on:{click:function(a){return t.generatePDF(e)}}},[a("b-icon",{attrs:{icon:"chat-dots-fill",variant:"primary"}}),t._v(" SMS")],1)],1)],1)])})),0)]):a("p",{staticClass:"text-danger"},[a("b",[t._v(t._s(t.$t("unavailable_customers")))])])])],1)],1)],1)],1)])])]),a("b-modal",{ref:"send-sms",attrs:{"hide-footer":"",title:"Enviar factura via SMS"}},[a("b-row",[a("b-col",[a("small",[t._v("Número de telemóvel:")]),a("b-form-group",{attrs:{"label-for":"phonenumber"}},[a("b-form-input",{attrs:{type:"text",required:"",size:"sm",placeholder:"Número de telemóvel"},model:{value:t.phoneNumberSMS,callback:function(e){t.phoneNumberSMS=e},expression:"phoneNumberSMS"}})],1)],1)],1),a("pre",[t._v("      "+t._s(t.smsDetailsTextLocal)+"\n    ")]),a("b-row",[a("b-col",[a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:t.isLoading,block:"",size:"sm",variant:"primary"},on:{click:function(e){return t.sendSMS()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)],1),a("b-modal",{ref:"edit-customer",attrs:{"hide-footer":"",title:t.$t("edit")}},[a("div",[a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("name")))]),a("b-form-group",{attrs:{id:"name","label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text",required:"",size:"sm",placeholder:t.$t("name")},model:{value:t.editCustomerValues.name,callback:function(e){t.$set(t.editCustomerValues,"name",e)},expression:"editCustomerValues.name"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("nuit")))]),a("b-form-group",{attrs:{id:"nuit","label-for":"nuit"}},[a("b-form-input",{attrs:{id:"nuit",type:"text",required:"",size:"sm",placeholder:t.$t("nuit")},model:{value:t.editCustomerValues.nuit,callback:function(e){t.$set(t.editCustomerValues,"nuit",e)},expression:"editCustomerValues.nuit"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("phone")))]),a("b-form-group",{attrs:{id:"phone","label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"text",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.editCustomerValues.phone,callback:function(e){t.$set(t.editCustomerValues,"phone",e)},expression:"editCustomerValues.phone"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("document_id")))]),a("b-form-group",{attrs:{id:"meter_id","label-for":"meter_id"}},[a("b-form-input",{attrs:{id:"meeter_id",type:"text",required:"",size:"sm",placeholder:t.$t("meter_id")},model:{value:t.editCustomerValues.meeter_id,callback:function(e){t.$set(t.editCustomerValues,"meeter_id",e)},expression:"editCustomerValues.meeter_id"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("address")))]),a("b-form-group",{attrs:{id:"address","label-for":"address"}},[a("b-form-input",{attrs:{id:"address",type:"text",required:"",size:"sm",placeholder:t.$t("address")},model:{value:t.editCustomerValues.address,callback:function(e){t.$set(t.editCustomerValues,"address",e)},expression:"editCustomerValues.address"}})],1)],1),a("b-col",[a("small",[t._v("Status")]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.editCustomerValues.status,callback:function(e){t.$set(t.editCustomerValues,"status",e)},expression:"editCustomerValues.status"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v(t._s(t.$t("active")))]),a("b-form-select-option",{attrs:{value:"2"}},[t._v(t._s(t.$t("inactive")))])],1)],1)],1),a("b-row",[a("b-col",[a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:1==t.isLoading||!t.editCustomerValues.name,block:"",size:"sm"},on:{click:function(e){return t.editCustomerFinal()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)],1)]),a("b-modal",{ref:"add-customer",attrs:{"hide-footer":"",title:t.$t("new_customer")}},[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("name")))]),a("b-form-group",{attrs:{id:"name","label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text",required:"",size:"sm",placeholder:t.$t("name")},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("meeter_id")))]),a("b-form-group",{attrs:{id:"meeter_id","label-for":"meeter_id"}},[a("b-form-input",{attrs:{id:"meeter_id",type:"text",required:"",size:"sm",placeholder:t.$t("meeter_id")},model:{value:t.meeter_id,callback:function(e){t.meeter_id=e},expression:"meeter_id"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("phone")))]),a("b-form-group",{attrs:{id:"phone","label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"text",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("nuit")))]),a("b-form-group",{attrs:{id:"nuit","label-for":"nuit"}},[a("b-form-input",{attrs:{id:"nuit",type:"number",required:"",size:"sm",placeholder:t.$t("nuit")},model:{value:t.nuit,callback:function(e){t.nuit=e},expression:"nuit"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("email")))]),a("b-form-group",{attrs:{id:"email","label-for":"email"}},[a("b-form-input",{attrs:{id:"email",type:"text",required:"",size:"sm",placeholder:t.$t("email")},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("tarrif_type")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.tariffTypeId,callback:function(e){t.tariffTypeId=e},expression:"tariffTypeId"}},t._l(t.tariffs,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("meter_type")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.meter_type,callback:function(e){t.meter_type=e},expression:"meter_type"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v(t._s(t.$t("post_paid")))]),a("b-form-select-option",{attrs:{value:"2"}},[t._v(t._s(t.$t("pre_paid")))])],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("id_range")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.barcode,callback:function(e){t.barcode=e},expression:"barcode"}},t._l(t.meters,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.meterNumber,disabled:e.status>0}},[t._v(t._s(e.meterNumber))])})),1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("address")))]),a("b-form-group",{attrs:{id:"address","label-for":"address"}},[a("b-form-input",{attrs:{id:"address",type:"text",required:"",size:"sm"},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:1==t.isLoading||!t.name||!t.phone,block:"",size:"sm"},on:{click:function(e){return t.saveCustomer()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)],1)],1)],1)},Cr=[],kr=(a("fb6a"),"api/meter"),Tr=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllMeters",value:function(t,e){var a="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(r,n){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get("".concat(kr,"?branchId=").concat(e),{headers:{Authorization:a}});case 3:s=t.sent,i=s.data,r(i),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"searchMeter",value:function(t,e,a,r){var n="Bearer "+r;return new Promise(function(){var r=Object(g["a"])(regeneratorRuntime.mark((function r(s,i){var o,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,O.a.get("".concat(kr,"/").concat(t,"/").concat(e,"/").concat(a),{headers:{Authorization:n}});case 3:o=r.sent,c=o.data,s(c),r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](0),i(r.t0);case 11:case"end":return r.stop()}}),r,null,[[0,8]])})));return function(t,e){return r.apply(this,arguments)}}())}},{key:"insertMeter",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(kr,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Rr=Tr,Pr="api/readingList",Sr=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getReadingList",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Pr,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Dr=Sr,$r="api/smsService",Ar=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllSentSms",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get($r,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getSMS",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat($r,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"sendSmsViaTextLocal",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post($r,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Ir=Ar;Rt.a.vfs=St.a.pdfMake.vfs;var Or={name:"BranchPanel",components:{NavBar:pt},watch:{branchId:function(){var t=this,e=this.branches.filter((function(e){return e.id===t.branchId}));this.$store.commit("SET_CURRENT_BRANCH",e[0]),this.getCustomers(),this.getPendingBills(),this.getAllDebts(),this.fetchAllMeters()}},computed:Object(_["a"])({},Object(f["b"])(["user","token","branches","currentUser","currentBranch","tariffs","meters"])),created:function(){this.$store.commit("SET_CURRENT_BRANCH",this.branches[0]),this.branchId=this.branches[0].id,this.getPendingBills(),this.getAllDebts(),this.getCustomers(),this.fetchAllMeters()},data:function(){return{show:!1,branchId:"",customers:[],isLoading:!1,name:"",phone:"",nuit:"",address:"",email:"",meeter_id:"",barcode:"",tariffTypeId:"",meter_type:1,selectedMeter:{},editCustomerValues:{},facturasIrregulares:[],numberPendingBills:0,totalPendingBill:0,listaDeDividas:[],totalDividasMultas:0,smsDetailsTextLocal:"",phoneNumberSMS:"258",currentCustomer:{}}},methods:{getNumberOfPendingBills:function(t){return this.facturasIrregulares.filter((function(e){return e.barcode===t}))},generatePDF:function(t){var e=this.getTDbt(t.barcode)+this.dividaMlt(t.barcode),a=this.facturasIrregulares.filter((function(e){return 0===e.status&&e.barcode===t.barcode})),r=a[a.length>0?a.length-1:0];this.currentCustomer=t;var n="\n";n+="FACTURA NR: "+r.receiptNumber+"\n",n+="Paga via M-Pesa:\n",n+="*150# OK\n",n+="6. Pagamentos\n",n+="7. Codigo Servico: 901029\n",n+="Referencia: "+t.barcode+"\n",n+="VALOR: "+e.toFixed(2)+" MZN\n",n+="Digitar PIN e JA ESTA\n",this.smsDetailsTextLocal=n,this.$refs["send-sms"].show(),this.phoneNumberSMS=t.phone},sendSMS:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(12==t.phoneNumberSMS.length){e.next=3;break}return t.$bvToast.toast("Número de destinatário inválido.",{title:"Erro!",variant:"warning",solid:!0}),e.abrupt("return");case 3:return a={number:t.phoneNumberSMS,smsBody:t.smsDetailsTextLocal,barcode:t.currentCustomer.barcode},t.isLoading=!0,e.prev=5,e.next=8,Ir.sendSmsViaTextLocal(a,t.token);case 8:r=e.sent,r.success,console.log(r.message),t.isLoading=!1,t.$refs["send-sms"].hide(),e.next=18;break;case 14:e.prev=14,e.t0=e["catch"](5),t.isLoading=!1,t.$refs["send-sms"].hide();case 18:case"end":return e.stop()}}),e,null,[[5,14]])})))()},getTDbt:function(t){var e=this.facturasIrregulares.filter((function(e){return e.barcode===t})),a=e.reduce((function(t,e){return t+e.totalOfBill+e.totalOfBill*e.forfeit}),0);return parseFloat(a)},meterType:function(t){return 1==t?"Pós-pago":2==t?"Pré-pago":void 0},tariffId:function(t){return 1==t?"Fontenária":2==t?"Doméstica":3==t?"Municipal":4==t?"Comercial":5==t?"Pública":6==t?"Industrial":7==t?"Toma de Água":void 0},dividaMlt:function(t){var e=this.listaDeDividas.filter((function(e){return e.barcode===t&&0===e.status})),a=e.reduce((function(t,e){return t+e.amount}),0);return parseFloat(a)},getAllDebts:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,e.prev=1,e.next=4,Ue.getAllDebts(t.currentBranch.id,t.token);case 4:a=e.sent,1==a.success?(t.listaDeDividas=a.result,t.totalDividasMultas=t.listaDeDividas.reduce((function(t,e){return t+e.amount}),0)):t.listaDeDividas=[],e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0.message);case 11:t.show=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getPendingBills:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,a={branchId:t.currentBranch.id},e.prev=2,e.next=5,Dr.getReadingList(a,t.token);case 5:r=e.sent,1==r.success?(t.facturasIrregulares=r.result,t.totalPendingBill=t.facturasIrregulares.reduce((function(t,e){return t+e.totalOfBill+e.totalOfBill*e.forfeit}),0)):t.facturasIrregulares=[],e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0.message),t.facturasIrregulares=[];case 13:t.show=!1;case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))()},printListOfReading:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,a={branchId:t.currentBranch.id,branchName:t.currentBranch.name},e.prev=2,e.next=5,Dr.getReadingList(a,t.token);case 5:r=e.sent,1==r.success?console.log(r):t.$bvToast.toast(r.message,{title:"",variant:"warning",solid:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"",variant:"danger",solid:!0});case 12:t.show=!1;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))()},openVendingPanel:function(t){this.customers=[],this.$store.commit("SET_CURRENT_CUSTOMER",t),this.$router.push("/customerview")},printPDFInvoice:function(){var t=this;this.show=!0,this.customers.forEach((function(e){var a={barcode:e.barcode,customerName:e.name,companyId:t.currentUser[0].companyId,tariffTypeId:e.tarrifTypeId,branchName:t.currentBranch.name};try{var r=Ye.createPdfInvoice(a,t.token);1==r.success?console.log(r):t.$bvToast.toast(r.message,{title:"Error",variant:"danger",solid:!0}),t.show=!1}catch(n){t.show=!1,t.$bvToast.toast(n.message,{title:"Error",variant:"danger",solid:!0})}}))},fetchAllMeters:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Rr.getAllMeters(t.token,t.currentBranch.id);case 3:a=e.sent,t.$store.commit("SET_METERS",a.result),t.isLoading=!1,e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0.message),t.isLoading=!1,t.$store.commit("SET_METERS",null);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))()},listItems:function(){this.itemsForList=this.customers.slice((this.currentPage-1)*this.perPage,this.currentPage*this.perPage)},editCustomer:function(t){this.$refs["edit-customer"].show(),this.editCustomerValues=t},editCustomerFinal:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,tt.insertOrUpdateCustomer(t.editCustomerValues,t.token);case 4:a=e.sent,1==a.success?(t.isLoading=!1,t.$bvToast.toast(t.editCustomerValues.name+" actualizado com sucesso",{title:"",variant:"success",solid:!0}),t.getCustomers()):(t.customers=a.result,t.isLoading=!1,t.$bvToast.toast(a.message,{title:"",variant:"warning",solid:!0}),t.getCustomers()),t.$refs["edit-customer"].hide(),e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](1),t.$bvToast.toast(""+e.t0,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1,t.$refs["edit-customer"].hide();case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))()},saveCustomer:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=Math.floor(1e6*Math.random())+1,r={branchId:t.currentBranch.id,meeter_type:t.meter_type,tarrifTypeId:t.tariffTypeId,barcode:t.barcode,meeter_id:t.meeter_id,email:t.email,address:t.address,nuit:t.nuit,phone:t.phone,name:t.name,status:1,uid:t.currentBranch.id+t.meeter_id+a,created_by:t.user[0].name},t.isLoading=!0,e.prev=3,e.next=6,tt.insertOrUpdateCustomer(r,t.token);case 6:n=e.sent,t.isLoading=!1,1==n.success?(t.$bvToast.toast(t.name+" cadastrado com sucesso",{title:"Sucesso",variant:"success",solid:!0}),t.clearValues(),t.getCustomers()):t.$bvToast.toast(n.message,{title:"",variant:"warning",solid:!0}),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](3),t.$bvToast.toast(""+e.t0,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))()},clearValues:function(){this.meeter_type=1,this.tarrifTypeId="",this.barcode="",this.meeter_id="",this.email="",this.address="",this.nuit="",this.phone="",this.name="",this.$refs["add-customer"].hide()},openAddNewCustomerModal:function(){this.$refs["add-customer"].show()},getCustomers:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,tt.getCustomerByBranch(t.currentBranch.id,t.token);case 4:a=e.sent,t.customers=a.result,t.listItems(),t.fetchAllMeters(),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),t.customers=[],t.isLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))()},printExcelShet:function(){var t,e=[],a=Object(vt["a"])(this.customers);try{for(a.s();!(t=a.n()).done;){var r=t.value,n={"Nome completo":r.name,Contador:r.barcode,"Telemóvel":r.phone.substring(3),"Facturas Pendentes":this.getNumberOfPendingBills(r.barcode).length,"Montante em dívida":this.getTDbt(r.barcode).toFixed(2),"Observação":""};this.getNumberOfPendingBills(r.barcode).length>=1&&e.push(n)}}catch(c){a.e(c)}finally{a.f()}var s="Devedores_Bairro_"+this.currentBranch.name,i=e,o="xls";Object(hr["a"])({data:i,fileName:s,exportType:o})},printList:function(){if(this.customers){var t,e=[],a=Object(vt["a"])(this.customers);try{for(a.s();!(t=a.n()).done;){var r=t.value,n=[];n.push({text:r.name,style:"estilo"}),n.push({text:r.barcode,style:"estilo"}),n.push({text:this.getNumberOfPendingBills(r.barcode).length,style:"estilo"}),n.push({text:this.getTDbt(r.barcode).toFixed(2),style:"estilo"}),n.push({text:"",style:"estilo"}),n.push({text:"",style:"estilo"}),n.push({text:"",style:"estilo"}),e.push(n)}}catch(i){a.e(i)}finally{a.f()}var s={content:[{columns:[{text:"LISTA DE CLIENTES DO BAIRRO ".concat(this.currentBranch.name.toUpperCase()," [ ").concat(this.customers.length," ]"),style:"header"}]},{table:{body:[[{text:"Nome do cliente",style:"columnsTitle"},{text:"Contador",style:"columnsTitle"},{text:"F/Pendentes",style:"columnsTitle"},{text:"Dívida",style:"columnsTitle"},{text:"Anterior",style:"columnsTitle"},{text:"Actual",style:"columnsTitle"},{text:"Observação",style:"columnsTitle"}]].concat(e)}}],styles:{header:{fontSize:9,bold:!0},columnsTitle:{fontSize:9,bold:!0,fillColor:"#7159c1",color:"#FFFFFF"},estilo:{fontSize:8}}};Rt.a.createPdf(s).open()}else this.$bvToast.toast("Clientes indisponíveis.",{title:"",variant:"warning",solid:!0})},saveCustomerBill:function(){var t=this,e=this.customers.filter((function(t){return 1===t.status}));e.forEach((function(e){var a=t.facturasIrregulares.filter((function(t){return 0===t.status&&t.barcode===e.barcode}));t.generateBill(e,a)}))},generateBill:function(t,e){var a=this;return Object(g["a"])(regeneratorRuntime.mark((function r(){var n,s,i,o,c,l,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=e[e.length>0?e.length-1:0],!(e.length>0)){r.next=18;break}s=[],i=Object(vt["a"])(e);try{for(i.s();!(o=i.n()).done;)c=o.value,l=[],l.push({text:c.receiptNumber+"/SAF/"+c.year,fontSize:8}),l.push({text:c.dataEmissao,fontSize:8}),l.push({text:c.dataLimite,fontSize:8}),l.push({text:c.consumoFacturado,fontSize:8}),l.push({text:c.subTotal,fontSize:8}),l.push({text:c.vat,fontSize:8}),l.push({text:c.forfeit,fontSize:8}),l.push({text:c.totalOfBill,fontSize:8}),s.push(l)}catch(d){i.e(d)}finally{i.f()}return r.next=7,a.getBase64ImageFromURL("https://saaf-tsenane.herokuapp.com/img/logo_12.2b7a27d2.jpeg");case 7:r.t0=r.sent,r.t1=[30,0,0,0],r.t2={image:r.t0,width:250,height:150,margin:r.t1},r.t3=[r.t2],r.t4={columns:[{text:"Documento processado por computador",alignment:"left",fontSize:8,margin:[30,0,0,0]},{text:"TSENANE Software",alignment:"right",fontSize:8,margin:[0,0,30,0]}]},r.t5=[{columns:[[{text:"Factura/Recibo Nº: ".concat(n.receiptNumber,"\n"),bold:!0,fontSize:10,alignment:"right"}]]},{text:"\n\n\n\n\n\n\n"},{columns:[[[{text:"Nome: ".concat(t.name),bold:!0,fontSize:11},{text:"Tarifa: ".concat(a.tariffId(t.tarrifTypeId)),bold:!0,fontSize:10},{text:"Endereço: ".concat(t.address),fontSize:10},{text:"Telefone: ".concat(t.phone),fontSize:10},{text:"NUIT: ".concat(t.nuit),fontSize:10}]],[{text:"Data de emissão: ".concat(n.dataEmissao),alignment:"right",bold:!0,fontSize:10},{text:"Data de vencimento: ".concat(n.dataLimite),alignment:"right",bold:!0,fontSize:10}]]},{text:"Dados da factura",style:"sectionHeader"},{table:{widths:["*","auto","auto","auto","auto","auto","auto","auto"],body:[[{text:"Nº/Doc",style:"columnsTitle"},{text:"Data",style:"columnsTitle"},{text:"Vencimento",style:"columnsTitle"},{text:"Consumo",style:"columnsTitle"},{text:"Subtotal",style:"columnsTitle"},{text:"IVA",style:"columnsTitle"},{text:"Multa",style:"columnsTitle"},{text:"Total",style:"columnsTitle"}]].concat(s)},layout:"lightHorizontalLines"},{text:"\nTOTAL A PAGAR: ".concat((a.getTDbt(t.barcode)+a.dividaMlt(t.barcode)).toFixed(2)," MZN"),fontSize:10,alignment:"right",color:"#000000"},{text:"\n\n Assinatura do técnico: _______________________________",alignment:"center",fontSize:10}],r.t6={sectionHeader:{bold:!0,decoration:"underline",fontSize:12,margin:[0,15,0,15]},columnsTitle:{fontSize:8,bold:!0,color:"#000000"}},u={header:r.t3,footer:r.t4,content:r.t5,styles:r.t6},Rt.a.createPdf(u).download("uploads/".concat(t.barcode,"_.pdf")),r.next=19;break;case 18:return r.abrupt("return");case 19:case"end":return r.stop()}}),r)})))()},getBase64ImageFromURL:function(t){var e=this;return new Promise((function(a,r){var n=new Image;n.setAttribute("crossOrigin","anonymous"),n.onload=function(){var t=document.createElement("canvas");t.width=n.width,t.height=n.height;var r=t.getContext("2d");r.drawImage(n,0,0);var s=t.toDataURL("image/png");e.isLoading=!1,a(s)},n.onerror=function(t){e.isLoading=!1,r(t)},n.src=t}))}}},Nr=Or,Mr=(a("f714"),Object(u["a"])(Nr,wr,Cr,!1,null,"30aae717",null)),zr=Mr.exports,Br=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[a("div",{staticClass:"container-group"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("b-row",[a("b-col",{staticClass:"text-dark",attrs:{cols:"4",lg:"3",md:"12",sm:"12"}},[a("h5",{staticStyle:{"font-weight":"bold"}},[t._v(" "+t._s(t.currentBranch.name)+": "+t._s(t.customers.length)+" "+t._s(t.$t("customers"))+" ")])]),a("b-col",{attrs:{cols:"4"}},[a("b-form-select",{staticClass:"mb-1",attrs:{size:"sm"},model:{value:t.branchId,callback:function(e){t.branchId=e},expression:"branchId"}},t._l(t.branches,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.printExcelShet()}}},[a("b-icon",{attrs:{icon:"file-excel-fill"}}),a("small",[t._v(" Devedores")])],1),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.printList()}}},[a("b-icon",{attrs:{icon:"file-pdf-fill"}}),a("small",[t._v("Lista de leituras")])],1),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.printPDFInvoice()}}},[a("b-icon",{attrs:{icon:"file-pdf-fill"}}),a("small",[t._v("Baixar facturas")])],1),a("b-col",{staticClass:"text-right text-primary",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.openAddNewCustomerModal()}}},[a("b-icon",{attrs:{icon:"person-plus-fill"}}),a("small",[t._v(" "+t._s(t.$t("new_customer")))])],1)],1),a("hr",{staticClass:"bg-info mt-0"}),a("b-row",[a("b-col",{attrs:{lg:"12"}},[a("b-card",[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[t.customers.length>0?a("table",{staticClass:"table table-sm table-hover table-stripped",attrs:{id:"my-table"}},[a("thead",{staticClass:"bg-dark text-white",staticStyle:{"font-size":"9pt"}},[a("tr",[a("th",[t._v(t._s(t.$t("name")))]),a("th",[t._v(t._s(t.$t("meter_id")))]),a("th",[t._v(t._s(t.$t("nuit")))]),a("th",[t._v("Tipo")]),a("th",[t._v("Tarifa")]),a("th",[t._v("Telemóvel")]),a("th",[t._v("F/R pendentes")]),a("th",[t._v("Dívida")]),a("th",{staticClass:"text-center"},[t._v(t._s(t.$t("actions")))])])]),a("tbody",t._l(t.customers,(function(e){return a("tr",{key:e.id,class:{active:1==e.status,"bg-danger":2==e.status,"text-white":2==e.status},staticStyle:{cursor:"pointer","font-size":"9pt"}},[a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.barcode))]),a("td",[t._v(t._s(e.nuit))]),a("td",[t._v(t._s(t.meterType(e.meeter_type)))]),a("td",[t._v(t._s(t.tariffId(e.tarrifTypeId)))]),a("td",[t._v(t._s(e.phone))]),a("td",[t._v(" "+t._s(t.getNumberOfPendingBills(e.barcode).length)+" ")]),a("td",[t._v(" "+t._s((t.getTDbt(e.barcode)+t.dividaMlt(t.barcode)).toFixed(2))+" ")]),a("td",[a("b-row",[a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"info"},expression:"{ variant: 'info' }",modifiers:{hover:!0}}],staticClass:"text-center",attrs:{title:t.$t("edit")},on:{click:function(a){return t.editCustomer(e)}}},[a("b-icon",{attrs:{icon:"tag-fill"}})],1),a("b-col",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",value:{variant:"info"},expression:"{ variant: 'info' }",modifiers:{hover:!0}}],staticClass:"text-center",attrs:{title:t.$t("go_to_customer_panel")},on:{click:function(a){return t.openVendingPanel(e)}}},[a("b-icon",{attrs:{icon:"box-arrow-up-right"}})],1)],1)],1)])})),0)]):a("p",{staticClass:"text-danger"},[a("b",[t._v(t._s(t.$t("unavailable_customers")))])])])],1)],1)],1)],1)])])]),a("b-modal",{ref:"edit-customer",attrs:{"hide-footer":"",title:t.$t("edit")}},[a("div",[a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("name")))]),a("b-form-group",{attrs:{id:"name","label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text",required:"",size:"sm",placeholder:t.$t("name")},model:{value:t.editCustomerValues.name,callback:function(e){t.$set(t.editCustomerValues,"name",e)},expression:"editCustomerValues.name"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("nuit")))]),a("b-form-group",{attrs:{id:"nuit","label-for":"nuit"}},[a("b-form-input",{attrs:{id:"nuit",type:"text",required:"",size:"sm",placeholder:t.$t("nuit")},model:{value:t.editCustomerValues.nuit,callback:function(e){t.$set(t.editCustomerValues,"nuit",e)},expression:"editCustomerValues.nuit"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("phone")))]),a("b-form-group",{attrs:{id:"phone","label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"text",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.editCustomerValues.phone,callback:function(e){t.$set(t.editCustomerValues,"phone",e)},expression:"editCustomerValues.phone"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("document_id")))]),a("b-form-group",{attrs:{id:"meter_id","label-for":"meter_id"}},[a("b-form-input",{attrs:{id:"meeter_id",type:"text",required:"",size:"sm",placeholder:t.$t("meter_id")},model:{value:t.editCustomerValues.meeter_id,callback:function(e){t.$set(t.editCustomerValues,"meeter_id",e)},expression:"editCustomerValues.meeter_id"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("address")))]),a("b-form-group",{attrs:{id:"address","label-for":"address"}},[a("b-form-input",{attrs:{id:"address",type:"text",required:"",size:"sm",placeholder:t.$t("address")},model:{value:t.editCustomerValues.address,callback:function(e){t.$set(t.editCustomerValues,"address",e)},expression:"editCustomerValues.address"}})],1)],1),a("b-col",[a("small",[t._v("Status")]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.editCustomerValues.status,callback:function(e){t.$set(t.editCustomerValues,"status",e)},expression:"editCustomerValues.status"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v(t._s(t.$t("active")))]),a("b-form-select-option",{attrs:{value:"2"}},[t._v(t._s(t.$t("inactive")))])],1)],1)],1),a("b-row",[a("b-col",[a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:1==t.isLoading||!t.editCustomerValues.name,block:"",size:"sm"},on:{click:function(e){return t.editCustomerFinal()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)],1)]),a("b-modal",{ref:"add-customer",attrs:{"hide-footer":"",title:t.$t("new_customer")}},[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("name")))]),a("b-form-group",{attrs:{id:"name","label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text",required:"",size:"sm",placeholder:t.$t("name")},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("meeter_id")))]),a("b-form-group",{attrs:{id:"meeter_id","label-for":"meeter_id"}},[a("b-form-input",{attrs:{id:"meeter_id",type:"text",required:"",size:"sm",placeholder:t.$t("meeter_id")},model:{value:t.meeter_id,callback:function(e){t.meeter_id=e},expression:"meeter_id"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("phone")))]),a("b-form-group",{attrs:{id:"phone","label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"text",required:"",size:"sm",placeholder:t.$t("phone")},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("nuit")))]),a("b-form-group",{attrs:{id:"nuit","label-for":"nuit"}},[a("b-form-input",{attrs:{id:"nuit",type:"number",required:"",size:"sm",placeholder:t.$t("nuit")},model:{value:t.nuit,callback:function(e){t.nuit=e},expression:"nuit"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("email")))]),a("b-form-group",{attrs:{id:"email","label-for":"email"}},[a("b-form-input",{attrs:{id:"email",type:"text",required:"",size:"sm",placeholder:t.$t("email")},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("tarrif_type")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.tariffTypeId,callback:function(e){t.tariffTypeId=e},expression:"tariffTypeId"}},t._l(t.tariffs,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("meter_type")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.meter_type,callback:function(e){t.meter_type=e},expression:"meter_type"}},[a("b-form-select-option",{attrs:{value:"1"}},[t._v(t._s(t.$t("post_paid")))]),a("b-form-select-option",{attrs:{value:"2"}},[t._v(t._s(t.$t("pre_paid")))])],1)],1),a("b-col",[a("small",[t._v(t._s(t.$t("id_range")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.barcode,callback:function(e){t.barcode=e},expression:"barcode"}},t._l(t.meters,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.meterNumber,disabled:e.status>0}},[t._v(t._s(e.meterNumber))])})),1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("address")))]),a("b-form-group",{attrs:{id:"address","label-for":"address"}},[a("b-form-input",{attrs:{id:"address",type:"text",required:"",size:"sm"},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1)],1)],1),a("b-row",[a("b-col",[a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:1==t.isLoading||!t.name||!t.phone,block:"",size:"sm"},on:{click:function(e){return t.saveCustomer()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)],1)],1)],1)},jr=[],Er="api/batchInvoice",Lr=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getInvoice",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Er,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"generatePDF",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Er,"?barcode=").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"createPdfInvoice",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Er,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Vr=Lr;Rt.a.vfs=St.a.pdfMake.vfs;var Fr={name:"BranchPanel",components:{NavBar:pt},watch:{branchId:function(){var t=this,e=this.branches.filter((function(e){return e.id===t.branchId}));this.$store.commit("SET_CURRENT_BRANCH",e[0]),this.getCustomers(),this.getPendingBills(),this.getAllDebts(),this.fetchAllMeters()}},computed:Object(_["a"])({},Object(f["b"])(["user","token","branches","currentUser","currentBranch","tariffs","meters"])),created:function(){this.$store.commit("SET_CURRENT_BRANCH",this.branches[0]),this.branchId=this.branches[0].id,this.getPendingBills(),this.getAllDebts(),this.getCustomers(),this.fetchAllMeters()},data:function(){return{show:!1,branchId:"",customers:[],isLoading:!1,name:"",phone:"",nuit:"",address:"",email:"",meeter_id:"",barcode:"",tariffTypeId:"",meter_type:1,selectedMeter:{},editCustomerValues:{},facturasIrregulares:[],numberPendingBills:0,totalPendingBill:0,listaDeDividas:[],totalDividasMultas:0}},methods:{getNumberOfPendingBills:function(t){return this.facturasIrregulares.filter((function(e){return e.barcode===t}))},getTDbt:function(t){var e=this.facturasIrregulares.filter((function(e){return e.barcode===t})),a=e.reduce((function(t,e){return t+e.totalOfBill+e.totalOfBill*e.forfeit}),0);return parseFloat(a)},meterType:function(t){return 1==t?"Pós-pago":2==t?"Pré-pago":void 0},tariffId:function(t){return 1==t?"Fontenária":2==t?"Doméstica":3==t?"Municipal":4==t?"Comercial":5==t?"Pública":6==t?"Industrial":7==t?"Toma de Água":void 0},dividaMlt:function(t){var e=this.listaDeDividas.filter((function(e){return e.barcode===t&&0===e.status})),a=e.reduce((function(t,e){return t+e.amount}),0);return parseFloat(a)},getAllDebts:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,e.prev=1,e.next=4,Ue.getAllDebts(t.currentBranch.id,t.token);case 4:a=e.sent,1==a.success?(t.listaDeDividas=a.result,t.totalDividasMultas=t.listaDeDividas.reduce((function(t,e){return t+e.amount}),0)):t.listaDeDividas=[],e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0.message);case 11:t.show=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getPendingBills:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,a={branchId:t.currentBranch.id},e.prev=2,e.next=5,Dr.getReadingList(a,t.token);case 5:r=e.sent,1==r.success?(t.facturasIrregulares=r.result,t.totalPendingBill=t.facturasIrregulares.reduce((function(t,e){return t+e.totalOfBill+e.totalOfBill*e.forfeit}),0)):t.facturasIrregulares=[],e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0.message),t.facturasIrregulares=[];case 13:t.show=!1;case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))()},printListOfReading:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,a={branchId:t.currentBranch.id,branchName:t.currentBranch.name},e.prev=2,e.next=5,Dr.getReadingList(a,t.token);case 5:r=e.sent,1==r.success?console.log(r):t.$bvToast.toast(r.message,{title:"",variant:"warning",solid:!0}),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"",variant:"danger",solid:!0});case 12:t.show=!1;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))()},openVendingPanel:function(t){this.customers=[],this.$store.commit("SET_CURRENT_CUSTOMER",t),this.$router.push("/customerview")},printPDFInvoice:function(){var t=this;this.show=!0,this.customers.forEach((function(e){var a={barcode:e.barcode,customerName:e.name,companyId:t.currentUser[0].companyId,tarrifTypeId:e.tarrifTypeId,branchName:t.currentBranch.name};try{var r=Vr.createPdfInvoice(a,t.token);1==r.success?console.log(r):t.$bvToast.toast(r.message,{title:"Error",variant:"danger",solid:!0}),t.show=!1}catch(n){t.show=!1,t.$bvToast.toast(n.message,{title:"Error",variant:"danger",solid:!0})}}))},fetchAllMeters:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Rr.getAllMeters(t.token,t.currentBranch.id);case 3:a=e.sent,t.$store.commit("SET_METERS",a.result),t.isLoading=!1,e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](0),console.log(e.t0.message),t.isLoading=!1,t.$store.commit("SET_METERS",null);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))()},listItems:function(){this.itemsForList=this.customers.slice((this.currentPage-1)*this.perPage,this.currentPage*this.perPage)},editCustomer:function(t){this.$refs["edit-customer"].show(),this.editCustomerValues=t},editCustomerFinal:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,tt.insertOrUpdateCustomer(t.editCustomerValues,t.token);case 4:a=e.sent,1==a.success?(t.isLoading=!1,t.$bvToast.toast(t.editCustomerValues.name+" actualizado com sucesso",{title:"",variant:"success",solid:!0}),t.getCustomers()):(t.customers=a.result,t.isLoading=!1,t.$bvToast.toast(a.message,{title:"",variant:"warning",solid:!0}),t.getCustomers()),t.$refs["edit-customer"].hide(),e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](1),t.$bvToast.toast(""+e.t0,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1,t.$refs["edit-customer"].hide();case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))()},saveCustomer:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=Math.floor(1e6*Math.random())+1,r={branchId:t.currentBranch.id,meeter_type:t.meter_type,tarrifTypeId:t.tariffTypeId,barcode:t.barcode,meeter_id:t.meeter_id,email:t.email,address:t.address,nuit:t.nuit,phone:t.phone,name:t.name,status:1,uid:t.currentBranch.id+t.meeter_id+a,created_by:t.user[0].name},t.isLoading=!0,e.prev=3,e.next=6,tt.insertOrUpdateCustomer(r,t.token);case 6:n=e.sent,t.isLoading=!1,1==n.success?(t.$bvToast.toast(t.name+" cadastrado com sucesso",{title:"Sucesso",variant:"success",solid:!0}),t.clearValues(),t.getCustomers()):t.$bvToast.toast(n.message,{title:"",variant:"warning",solid:!0}),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](3),t.$bvToast.toast(""+e.t0,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))()},clearValues:function(){this.meeter_type=1,this.tarrifTypeId="",this.barcode="",this.meeter_id="",this.email="",this.address="",this.nuit="",this.phone="",this.name="",this.$refs["add-customer"].hide()},openAddNewCustomerModal:function(){this.$refs["add-customer"].show()},getCustomers:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,tt.getCustomerByBranch(t.currentBranch.id,t.token);case 4:a=e.sent,t.customers=a.result,t.listItems(),t.fetchAllMeters(),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](1),t.customers=[],t.isLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))()},printExcelShet:function(){var t,e=[],a=Object(vt["a"])(this.customers);try{for(a.s();!(t=a.n()).done;){var r=t.value,n={"Nome completo":r.name,Contador:r.barcode,"Telemóvel":r.phone.substring(3),"Facturas Pendentes":this.getNumberOfPendingBills(r.barcode).length,"Montante em dívida":this.getTDbt(r.barcode).toFixed(2),"Observação":""};this.getNumberOfPendingBills(r.barcode).length>=1&&e.push(n)}}catch(c){a.e(c)}finally{a.f()}var s="Devedores_Bairro_"+this.currentBranch.name,i=e,o="xls";Object(hr["a"])({data:i,fileName:s,exportType:o})},printList:function(){if(this.customers){var t,e=[],a=Object(vt["a"])(this.customers);try{for(a.s();!(t=a.n()).done;){var r=t.value,n=[];n.push({text:r.name,style:"estilo"}),n.push({text:r.barcode,style:"estilo"}),n.push({text:this.getNumberOfPendingBills(r.barcode).length,style:"estilo"}),n.push({text:this.getTDbt(r.barcode).toFixed(2),style:"estilo"}),n.push({text:"",style:"estilo"}),n.push({text:"",style:"estilo"}),n.push({text:"",style:"estilo"}),e.push(n)}}catch(i){a.e(i)}finally{a.f()}var s={content:[{columns:[{text:"LISTA DE CLIENTES DO BAIRRO ".concat(this.currentBranch.name.toUpperCase()," [ ").concat(this.customers.length," ]"),style:"header"}]},{table:{body:[[{text:"Nome do cliente",style:"columnsTitle"},{text:"Contador",style:"columnsTitle"},{text:"F/Pendentes",style:"columnsTitle"},{text:"Dívida",style:"columnsTitle"},{text:"Anterior",style:"columnsTitle"},{text:"Actual",style:"columnsTitle"},{text:"Observação",style:"columnsTitle"}]].concat(e)}}],styles:{header:{fontSize:9,bold:!0},columnsTitle:{fontSize:9,bold:!0,fillColor:"#7159c1",color:"#FFFFFF"},estilo:{fontSize:8}}};Rt.a.createPdf(s).open()}else this.$bvToast.toast("Clientes indisponíveis.",{title:"",variant:"warning",solid:!0})}}},Ur=Fr,qr=(a("887d"),Object(u["a"])(Ur,Br,jr,!1,null,"846a711c",null)),Wr=qr.exports,Yr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),t.isLoading?a("pulse-loader",{staticClass:"text-center mt-4"}):a("b-container",{staticClass:"bv-example-row mt-2"},[a("div",[a("b-row",[a("b-col",{attrs:{lg:"10",md:"8",sm:"6"}},[a("h5",{staticClass:"text-white"},[a("small",[t._v(t._s(t.$t("tariff_management")))])])]),a("b-col",[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"secondary",size:"sm",block:""},on:{click:function(e){return t.openModalTarrif()}}},[t._v(t._s(t.$t("new_tariff"))+"     "),a("i",{staticClass:"fas fa-plus"})])],1)],1),a("hr",{staticClass:"bg-info mt-2"}),a("b-row",{staticClass:"mt-2"},t._l(t.tarrifs,(function(e){return a("tarrif-card",{key:e.id,attrs:{token:t.token,tarrifs:e}})})),1)],1)]),a("b-modal",{ref:"add-tarrif",attrs:{"hide-footer":"",title:t.$t("new_tariff")}},[a("b-form-group",{attrs:{id:"add-tarif","label-for":"add-tarif"}},[a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("system")))]),a("b-form-select",{staticClass:"mb-3",attrs:{size:"sm"},model:{value:t.tarrifTypeId,callback:function(e){t.tarrifTypeId=e},expression:"tarrifTypeId"}},t._l(t.tarrifs,(function(e){return a("b-form-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1)],1),1===t.tarrifTypeId?a("div",[a("small",[t._v(" "+t._s(t.$t("price_per_m_3"))+" "),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{id:"pricePerMeterCubic","label-for":"pricePerMeterCubic"}},[a("b-form-input",{attrs:{type:"number",min:"10",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.pricePerMeterCubic,callback:function(e){t.pricePerMeterCubic=e},expression:"pricePerMeterCubic"}})],1)],1):t._e(),2===t.tarrifTypeId||3===t.tarrifTypeId?a("div",[a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("fixed_tax")))]),a("b-form-group",{attrs:{id:"serviceAvailabilityFee","label-for":"serviceAvailabilityFee"}},[a("b-form-input",{attrs:{type:"number",min:"50",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.serviceAvailabilityFee,callback:function(e){t.serviceAvailabilityFee=e},expression:"serviceAvailabilityFee"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(" "+t._s(t.$t("minimum_consuption"))+" m"),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{id:"socialTire","label-for":"socialTire"}},[a("b-form-input",{attrs:{type:"number",min:"0",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.socialTire,callback:function(e){t.socialTire=e},expression:"socialTire"}})],1)],1),a("b-col",[a("small",[t._v(" "+t._s(t.$t("first_five"))+" m"),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{"label-for":"firstFive"}},[a("b-form-input",{attrs:{id:"firstFive",type:"number",min:"50",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.firstFive,callback:function(e){t.firstFive=e},expression:"firstFive"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(" "+t._s(t.$t("first_seven"))+" m"),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{id:"firstSeven","label-for":"firstSeven"}},[a("b-form-input",{attrs:{type:"number",min:"0",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.firstSeven,callback:function(e){t.firstSeven=e},expression:"firstSeven"}})],1)],1),a("b-col",[a("small",[t._v(" "+t._s(t.$t("above_seven"))+" m"),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{id:"aboveSeven","label-for":"aboveSeven"}},[a("b-form-input",{attrs:{type:"number",min:"0",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.aboveSeven,callback:function(e){t.aboveSeven=e},expression:"aboveSeven"}})],1)],1)],1)],1):t._e(),t.tarrifTypeId>=4?a("div",[a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("fixed_tax")))]),a("b-form-group",{attrs:{id:"serviceAvailabilityFee","label-for":"serviceAvailabilityFee"}},[a("b-form-input",{attrs:{type:"number",min:"150",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.serviceAvailabilityFee,callback:function(e){t.serviceAvailabilityFee=e},expression:"serviceAvailabilityFee"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(" "+t._s(t.$t("first_fifteen"))+" m"),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{id:"firstFifteen","label-for":"firstFifteen"}},[a("b-form-input",{attrs:{type:"number",min:"0",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.firstFifteen,callback:function(e){t.firstFifteen=e},expression:"firstFifteen"}})],1)],1),a("b-col",[a("small",[t._v(" "+t._s(t.$t("above_fifteen"))+"m"),a("sup",[t._v("3")])]),a("b-form-group",{attrs:{id:"aboveFifteen","label-for":"aboveFifteen"}},[a("b-form-input",{attrs:{type:"number",min:"0",step:"any",required:"",size:"sm",placeholder:"Preço"},model:{value:t.aboveFifteen,callback:function(e){t.aboveFifteen=e},expression:"aboveFifteen"}})],1)],1)],1)],1):t._e(),a("b-button",{staticClass:"mt-3 sm",attrs:{disabled:1==t.isLoading||!t.tarrifTypeId,block:"",size:"sm"},on:{click:function(e){return t.insertTarrif()}}},[t.isLoading?[t._v(" "+t._s(t.$t("updating"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1)],1)],1)},Gr=[],Hr=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.tarrifsById?a("b-col",{staticClass:"mb-1",attrs:{lg:"4",md:"12",sm:"12"}},[a("b-card",{staticClass:"mb-1"},[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[1===t.tarrifs.id||3===t.tarrifs.id?a("div",[a("table",{staticClass:"table table-sm bg-white"},[a("thead",[a("tr",{staticClass:"bg-secondary text-white",staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"2"}},[t._v(t._s(t.tarrifs.name))])]),t.isLoading?t._e():a("tr",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("th",{attrs:{width:"60%"}},[a("small",[t._v(" "+t._s(t.$t("price_per_m_3"))+" "),a("sup",[t._v("3")])])]),a("th",{staticClass:"text-right"},[a("small",{directives:[{name:"money-format",rawName:"v-money-format",value:t.tarrifsById[0].pricePerMeterCubic,expression:"tarrifsById[0].pricePerMeterCubic"}]})])])])])]):t._e(),2===t.tarrifs.id||3===t.tarrifs.id?a("div",[a("table",{staticClass:"table table-sm bg-white mt-2"},[t.isLoading?t._e():a("thead",[a("tr",{staticClass:"bg-secondary text-white",staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"2"}},[t._v(t._s(t.tarrifs.name))])]),a("tr",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("th",{attrs:{width:"60%"}},[a("small",[t._v(t._s(t.$t("fixed_tax")))])]),a("th",{staticClass:"text-right"},[a("small",{directives:[{name:"money-format",rawName:"v-money-format",value:t.tarrifsById[0].serviceAvailabilityFee,expression:"tarrifsById[0].serviceAvailabilityFee"}]})])]),a("tr",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("th",{attrs:{width:"60%"}},[a("small",[t._v(" "+t._s(t.$t("minimum_consuption"))+" m "),a("sup",[t._v("3")])])]),a("th",{staticClass:"text-right"},[a("small",{directives:[{name:"money-format",rawName:"v-money-format",value:t.tarrifsById[0].socialTire,expression:"tarrifsById[0].socialTire"}]})])]),a("tr",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("th",{attrs:{width:"60%"}},[a("small",[t._v(t._s(t.$t("first_five")))])]),a("th",{staticClass:"text-right"},[a("small",{directives:[{name:"money-format",rawName:"v-money-format",value:t.tarrifsById[0].firstFive,expression:"tarrifsById[0].firstFive"}]})])]),a("tr",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("th",{attrs:{width:"60%"}},[a("small",[t._v(t._s(t.$t("first_seven")))])]),a("th",{staticClass:"text-right"},[a("small",{directives:[{name:"money-format",rawName:"v-money-format",value:t.tarrifsById[0].firstSeven,expression:"tarrifsById[0].firstSeven"}]})])]),a("tr",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("th",{attrs:{width:"60%"}},[a("small",[t._v(t._s(t.$t("above_seven")))])]),a("th",{staticClass:"text-right"},[a("small",{directives:[{name:"money-format",rawName:"v-money-format",value:t.tarrifsById[0].aboveSeven,expression:"tarrifsById[0].aboveSeven"}]})])])])])]):t._e(),t.tarrifs.id>=4?a("div",[a("table",{staticClass:"table table-sm bg-white mt-2"},[t.isLoading?t._e():a("thead",[a("tr",{staticClass:"bg-secondary text-white",staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"2"}},[t._v(t._s(t.tarrifs.name))])]),a("tr",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("th",{attrs:{width:"60%"}},[a("small",[t._v(" "+t._s(t.$t("first_fifteen"))+" m"),a("sup",[t._v("3")])])]),a("th",{staticClass:"text-right"},[a("small",{directives:[{name:"money-format",rawName:"v-money-format",value:t.tarrifsById[0].firstFifteen,expression:"tarrifsById[0].firstFifteen"}]})])]),a("tr",{staticStyle:{cursor:"pointer","font-size":"10pt"}},[a("th",{attrs:{width:"60%"}},[a("small",[t._v(" "+t._s(t.$t("above_fifteen"))+" m"),a("sup",[t._v("3")])])]),a("th",{staticClass:"text-right"},[a("small",{directives:[{name:"money-format",rawName:"v-money-format",value:t.tarrifsById[0].aboveFifteen,expression:"tarrifsById[0].aboveFifteen"}]})])])])])]):t._e()])],1)],1):t._e()},Qr=[],Zr={name:"TarrifCard",props:["tarrifs"],data:function(){return{tarrifsById:[],isLoading:!1,show:!1}},computed:Object(_["a"])({},Object(f["b"])(["user","token"])),created:function(){this.gettarrifByCategory()},methods:{gettarrifByCategory:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Ne.getTarrifsByCategory(t.tarrifs.id,t.token);case 4:a=e.sent,t.tarrifsById=a.result,t.isLoading=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),t.$bvToast.toast(""+e.t0,{title:"Sucesso",variant:"danger",solid:!0}),t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}}},Jr=Zr,Kr=Object(u["a"])(Jr,Hr,Qr,!1,null,"ac52e3d6",null),Xr=Kr.exports,tn={name:"Tarrifs",watch:{tarrifType:function(){return 1===this.tarrifType}},computed:Object(_["a"])({},Object(f["b"])(["user","token"])),created:function(){this.$store.commit("SET_CLEAR_CURRENT_VENDING"),this.fetchTarrifs()},components:{NavBar:pt,PulseLoader:ot["a"],TarrifCard:Xr},data:function(){return{currentUser:[],isLoading:!1,tarrifs:[],tarrifTypeId:0,pricePerMeterCubic:0,socialTire:0,serviceAvailabilityFee:0,firstSeven:0,firstFive:0,aboveSeven:0,firstFifteen:0,aboveFifteen:0}},methods:{insertTarrif:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={tarrifTypeId:t.tarrifTypeId,pricePerMeterCubic:t.pricePerMeterCubic,socialTire:t.socialTire,serviceAvailabilityFee:t.serviceAvailabilityFee,firstFive:t.firstFive,firstSeven:t.firstSeven,aboveSeven:t.aboveSeven,firstFifteen:t.firstFifteen,aboveFifteen:t.aboveFifteen},t.isLoading=!0,e.prev=2,e.next=5,Ne.insertTarrifs(a,t.token);case 5:r=e.sent,1==r.success?(t.tarrifs=r.result,t.isLoading=!1,t.fetchTarrifs(),t.$bvToast.toast("Tarifa inserida com sucesso.",{title:"Sucesso",variant:"success",solid:!0}),t.$refs["add-tarrif"].hide()):(t.$bvToast.toast(r.message,{title:"Sucesso",variant:"success",solid:!0}),t.$refs["add-tarrif"].hide()),e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](2),t.isLoading=!1,t.$bvToast.toast(""+e.t0,{title:"Sucesso",variant:"danger",solid:!0}),t.$refs["add-tarrif"].hide();case 14:case"end":return e.stop()}}),e,null,[[2,9]])})))()},openModalTarrif:function(){this.$refs["add-tarrif"].show()},fetchTarrifs:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Ne.getAllTarrifs(t.token);case 4:a=e.sent,t.tarrifs=a.result,t.isLoading=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](1),t.$bvToast.toast(""+e.t0,{title:"Sucesso",variant:"danger",solid:!0}),t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))()}}},en=tn,an=Object(u["a"])(en,Yr,Gr,!1,null,null,null),rn=an.exports,nn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[a("div",{staticClass:"container-group"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("b-overlay",{attrs:{show:t.show,rounded:"sm"}},[a("b-row",[a("b-col",[a("b-row",[a("b-col",{attrs:{lg:"11",md:"8",sm:"8"}},[t._v(t._s(t.$t("products_services"))+" Em Meticais - MZN")]),a("b-col",{staticClass:"text-right",attrs:{lg:"1",md:"4",sm:"4"}},[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"success",block:"",size:"sm"},on:{click:function(e){return t.addNewProduct()}}},[a("b-icon",{attrs:{icon:"plus-square"}})],1)],1)],1),t.products.length?a("table",{staticClass:"table table-sm table-bordered",staticStyle:{"font-size":"8pt"}},[a("thead",{staticClass:"bg-dark text-white"},[a("tr",[a("th",{staticClass:"text-center align-middle"},[t._v("Ordem")]),a("th",{staticClass:"text-center align-middle"},[t._v("Diâmetro")]),a("th",{staticClass:"text-center align-middle"},[t._v(" Depósito Garantia ")]),a("th",{staticClass:"text-center align-middle"},[t._v(" Vistoria Sem Transporte ")]),a("th",{staticClass:"text-center align-middle"},[t._v(" Vistoria Com Transporte ")]),a("th",{staticClass:"text-center align-middle"},[t._v(" Subscrição De Contrato ")]),a("th",{staticClass:"text-center align-middle"},[t._v("Taxa Religação")]),a("th",{staticClass:"text-center align-middle"},[t._v(" Aferição Contador ")]),a("th",{staticClass:"text-center align-middle"},[t._v(" Aferição C. Danificado ")]),a("th",{staticClass:"text-center align-middle"},[t._v(" Violação Instalação ")]),a("th",{staticClass:"text-center align-middle"},[t._v(" Aluguer Contador ")]),a("th",{staticClass:"text-center align-middle",attrs:{colspan:"2"}},[t._v(" "+t._s(t.$t("actions"))+" ")])])]),a("tbody",t._l(t.products,(function(e,r){return a("tr",{key:r},[a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(r+1)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.diameter)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaDepositoGarantia)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaVistoriaSemTransporte)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaVistoriaComTransporte)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaSubscricaoContrato)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaCorteReligacao)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaAfericaoContador)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaEncargoContadorDanificado)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaEncargoViolacaoInstalacao)+" ")]),a("td",{staticClass:"align-middle text-center"},[t._v(" "+t._s(e.taxaAluguerContador)+" ")]),a("td",{staticClass:"text-center align-middle",attrs:{colspan:"2"}},[a("b-row",[a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"secondary"},on:{click:function(a){return t.editProduct(e)}}},[a("b-icon",{attrs:{icon:"pen"}})],1)],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"danger"},on:{click:function(a){return t.deleteProduct(e)}}},[a("b-icon",{attrs:{icon:"trash"}})],1)],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"success"}},[a("b-icon",{attrs:{icon:"cart-plus"}})],1)],1)],1)],1)])})),0)]):a("b-row",[a("b-col",[a("h5",{staticClass:"text-danger"},[a("small",[a("em",[t._v("Sem nenhuma taxa ou encargo cadastrado até ao momento!")])])])])],1)],1)],1)],1)],1)])])]),a("b-modal",{ref:"delete-product",attrs:{"hide-footer":"",title:t.$t("delete")}},[a("p",{staticClass:"text-danger text-center"},[t._v(t._s(t.$t("decide_delete")))]),a("b-row",[a("b-col",[a("b-button",{attrs:{block:"",size:"sm"},on:{click:function(e){return t.cancelDeletion()}}},[t._v(t._s(t.$t("cancel")))])],1),a("b-col",[a("b-button",{attrs:{block:"",size:"sm",variant:"danger"},on:{click:function(e){return t.decidedToDelete()}}},[t._v(t._s(t.$t("delete")))])],1)],1)],1),a("b-modal",{ref:"add-new-product",attrs:{"hide-footer":"",title:"Nova Taxa Ou Encargos"}},[a("b-col",[a("b-row",[a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("small",[t._v("Diâmetro Do Contador")]),a("b-form-group",{attrs:{"label-for":"diameter"}},[a("b-form-select",{attrs:{size:"sm"},model:{value:t.diameter,callback:function(e){t.diameter=e},expression:"diameter"}},[a("b-form-select-option",{attrs:{value:"1/2"}},[t._v("1/2")]),a("b-form-select-option",{attrs:{value:"3/4"}},[t._v("3/4")]),a("b-form-select-option",{attrs:{value:"1"}},[t._v("1")]),a("b-form-select-option",{attrs:{value:"1-1/4"}},[t._v("1-1/4")]),a("b-form-select-option",{attrs:{value:"1-1/2"}},[t._v("1-1/2")]),a("b-form-select-option",{attrs:{value:"2"}},[t._v("2")]),a("b-form-select-option",{attrs:{value:"3"}},[t._v("3")]),a("b-form-select-option",{attrs:{value:"4"}},[t._v("4")]),a("b-form-select-option",{attrs:{value:"6"}},[t._v("6")]),a("b-form-select-option",{attrs:{value:"8"}},[t._v("8")])],1)],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_deposito_garantia"}},[a("b-form-input",{attrs:{type:"number",min:"20",step:"any",size:"sm",placeholder:t.$t("taxa_deposito_garantia")},model:{value:t.taxaDepositoGarantia,callback:function(e){t.taxaDepositoGarantia=e},expression:"taxaDepositoGarantia"}})],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_vistoria_sem_transporte"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",placeholder:t.$t("taxa_vistoria_sem_transporte")},model:{value:t.taxaVistoriaSemTransporte,callback:function(e){t.taxaVistoriaSemTransporte=e},expression:"taxaVistoriaSemTransporte"}})],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_vistoria_com_transporte"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",placeholder:t.$t("taxa_vistoria_com_transporte")},model:{value:t.taxaVistoriaComTransporte,callback:function(e){t.taxaVistoriaComTransporte=e},expression:"taxaVistoriaComTransporte"}})],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_subscricao_contrato"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",placeholder:t.$t("taxa_subscricao_contrato")},model:{value:t.taxaSubscricaoContrato,callback:function(e){t.taxaSubscricaoContrato=e},expression:"taxaSubscricaoContrato"}})],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_corte_religacao"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",placeholder:t.$t("taxa_corte_religacao")},model:{value:t.taxaCorteReligacao,callback:function(e){t.taxaCorteReligacao=e},expression:"taxaCorteReligacao"}})],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_afericao_contador"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",placeholder:t.$t("taxa_afericao_contador")},model:{value:t.taxaAfericaoContador,callback:function(e){t.taxaAfericaoContador=e},expression:"taxaAfericaoContador"}})],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_encargo_contador_danificado"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",placeholder:t.$t("taxa_encargo_contador_danificado")},model:{value:t.taxaEncargoContadorDanificado,callback:function(e){t.taxaEncargoContadorDanificado=e},expression:"taxaEncargoContadorDanificado"}})],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_encargo_violacao_instalacao"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",placeholder:t.$t("taxa_encargo_violacao_instalacao")},model:{value:t.taxaEncargoViolacaoInstalacao,callback:function(e){t.taxaEncargoViolacaoInstalacao=e},expression:"taxaEncargoViolacaoInstalacao"}})],1)],1),a("b-col",{attrs:{lg:"12",md:"12",sm:"12"}},[a("b-form-group",{attrs:{"label-for":"taxa_aluguer_contador"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",placeholder:t.$t("taxa_aluguer_contador")},model:{value:t.taxaAluguerContador,callback:function(e){t.taxaAluguerContador=e},expression:"taxaAluguerContador"}})],1)],1),a("b-col",[a("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-center",modifiers:{"modal-center":!0}}],attrs:{variant:"success",block:"",disabled:t.show,size:"sm"},on:{click:function(e){return t.saveProduct()}}},[t._v(t._s(t.$t("save_product")))])],1)],1)],1)],1)],1)},sn=[],on="api/products",cn=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllProducts",value:function(t){var e="Bearer "+t;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(a,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(on,{headers:{Authorization:e}});case 3:n=t.sent,s=n.data,a(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"deleteProduct",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(on,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertOrUpdateProduct",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(on,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),ln=cn,un={name:"Products",computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","company"])),components:{"nav-bar":pt},created:function(){this.getAllProducts()},data:function(){return{show:!1,taxaDepositoGarantia:"",taxaVistoriaSemTransporte:"",taxaVistoriaComTransporte:"",taxaSubscricaoContrato:"",taxaCorteReligacao:"",taxaAfericaoContador:"",taxaEncargoContadorDanificado:"",taxaEncargoViolacaoInstalacao:"",taxaAluguerContador:"",diameter:"",products:[],productId:""}},methods:{cancelDeletion:function(){this.$refs["delete-product"].hide(),this.clearValues()},addNewProduct:function(){this.$refs["add-new-product"].show()},deleteProduct:function(t){this.productId=t.id,this.$refs["delete-product"].show()},decidedToDelete:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,e.prev=1,e.next=4,ln.deleteProduct(t.productId,t.token);case 4:a=e.sent,1==a.success&&t.$bvToast.toast(a.message,{title:"",variant:"success",solid:!0}),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:t.getAllProducts(),t.clearValues(),t.show=!1;case 14:case"end":return e.stop()}}),e,null,[[1,8]])})))()},clearValues:function(){this.taxaDepositoGarantia="",this.taxaVistoriaSemTransporte="",this.taxaVistoriaComTransporte="",this.taxaSubscricaoContrato="",this.taxaCorteReligacao="",this.taxaAfericaoContador="",this.taxaEncargoContadorDanificado="",this.taxaAluguerContador="",this.diameter="",this.productId="",this.taxaEncargoViolacaoInstalacao="",this.$refs["delete-product"].hide(),this.show=!1},editProduct:function(t){this.productId=t.id,this.taxaDepositoGarantia=t.taxaDepositoGarantia,this.taxaVistoriaSemTransporte=t.taxaVistoriaSemTransporte,this.taxaVistoriaComTransporte=t.taxaVistoriaComTransporte,this.taxaSubscricaoContrato=t.taxaSubscricaoContrato,this.taxaCorteReligacao=t.taxaCorteReligacao,this.taxaAfericaoContador=t.taxaAfericaoContador,this.taxaEncargoViolacaoInstalacao=t.taxaEncargoViolacaoInstalacao,this.taxaEncargoContadorDanificado=t.taxaEncargoContadorDanificado,this.taxaAluguerContador=t.taxaAluguerContador,this.diameter=t.diameter,this.$refs["add-new-product"].show()},getAllProducts:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,e.prev=1,e.next=4,ln.getAllProducts(t.token);case 4:a=e.sent,1==a.success?(t.products=a.result,console.log(a),t.show=!1):(t.show=!1,t.products=[]),e.next=14;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0),t.$bvToast.toast(e.t0,{title:"",variant:"danger",solid:!0}),t.show=!1,t.products=[];case 14:case"end":return e.stop()}}),e,null,[[1,8]])})))()},saveProduct:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.show=!0,a={productId:t.productId,taxaDepositoGarantia:t.taxaDepositoGarantia,taxaVistoriaSemTransporte:t.taxaVistoriaSemTransporte,taxaVistoriaComTransporte:t.taxaVistoriaComTransporte,taxaSubscricaoContrato:t.taxaSubscricaoContrato,taxaCorteReligacao:t.taxaCorteReligacao,taxaAfericaoContador:t.taxaAfericaoContador,taxaEncargoContadorDanificado:t.taxaEncargoContadorDanificado,taxaEncargoViolacaoInstalacao:t.taxaEncargoViolacaoInstalacao,taxaAluguerContador:t.taxaAluguerContador,diameter:t.diameter},e.prev=2,e.next=5,ln.insertOrUpdateProduct(a,t.token);case 5:r=e.sent,1==r.success?(t.$bvToast.toast(r.message,{title:"",variant:"success",solid:!0}),t.$refs["add-new-product"].hide()):t.$bvToast.toast(r.message,{title:"",variant:"warning",solid:!0}),t.clearValues(),t.getAllProducts(),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](2),t.clearValues(),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))()}}},dn=un,mn=(a("d7a2"),Object(u["a"])(dn,nn,sn,!1,null,"33116452",null)),pn=mn.exports,fn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-container",{staticClass:"bv-example-row",attrs:{fluid:""}},[a("div",{staticClass:"container-group"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("b-overlay",{attrs:{show:t.isLoading,rounded:"sm"}},[t.serverError?a("b-row",{staticClass:"mt-0"},[a("b-col",{attrs:{cols:"9"}},[a("b-row",[a("b-col",{staticClass:"text-center"},[a("b-row",{staticClass:"mb-1"},[a("b-col",[a("b-form-datepicker",{attrs:{placeholder:t.$t("from"),block:"",size:"sm",id:"from-datepicker"},model:{value:t.fromDate,callback:function(e){t.fromDate=e},expression:"fromDate"}})],1),a("b-col",[a("b-form-datepicker",{attrs:{placeholder:t.$t("to"),block:"",size:"sm",id:"to-datepicker"},model:{value:t.toDate,callback:function(e){t.toDate=e},expression:"toDate"}})],1),a("b-col",{attrs:{cols:"2"}},[a("b-button",{attrs:{disabled:!t.toDate&&!t.fromDate||t.isLoading,size:"sm",variant:"success",block:""},on:{click:function(e){return t.searchPayments()}}},[a("b-icon",{attrs:{icon:"search"}})],1)],1),a("b-col",[a("b-form-select",{attrs:{size:"sm"},model:{value:t.reportType,callback:function(e){t.reportType=e},expression:"reportType"}},[a("b-form-select-option",{attrs:{value:"0"}},[t._v("Baixar "+t._s(t.$t("report")))]),a("b-form-select-option",{attrs:{value:"1"}},[t._v("Relatório Comercial e Financeiro ")])],1)],1)],1)],1)],1),a("table",{staticClass:"table table-sm table-hover table-bordered"},[a("thead",[a("tr",[a("th",{staticClass:"text-lef text-dark",attrs:{colspan:"9"}},[a("h6",{staticStyle:{"font-size":"12pt"}},[a("b",[t._v("RELATÓRIO COMERCIAL E FINANCEIRO DO MÊS DE "+t._s(t.consumptionPeriod))])])])])]),a("tbody",[a("tr",{staticClass:"bg-dark text-white"},[a("th",{attrs:{colspan:"2"}},[t._v("DESCRIÇÃO")]),a("th",[t._v("FONTANÁRIOS")]),a("th",[t._v("DOMÉSTICOS")]),a("th",[t._v("MUNICIPAL")]),a("th",[t._v("PÚBLICO")]),a("th",[t._v("COMERCIAL")]),a("th",[t._v("INDUSTRIAL")]),a("th",{staticClass:"text-right"},[t._v("TOTAL")])]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Total de clientes existentes")])]),a("td",{staticClass:"text-right"},[t._v(t._s(t.fountainTotal))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.domesticTotal))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.municipalTotal))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.publicTotal))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.commercialTotal))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.industrialTotal))]),a("th",{staticClass:"text-right"},[t._v(t._s(t.customers.length))])]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Total de clientes activos")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.fountainTotal-t.fountainDeactivated)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.domesticTotal-t.domesticDeactivated)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.municipalTotal-t.municipalDeactivated)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.publicTotal-t.publicDeactivated)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.commercialTotal-t.commercialDeactivated)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.industrialTotal-t.industrialDeactivated)+" ")]),a("th",{staticClass:"text-right"},[t._v(" "+t._s(t.customers.length-t.totalDeactivated)+" ")])]),a("tr",{staticClass:"text-danger"},[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Total de clientes desactivados")])]),a("td",{staticClass:"text-right"},[t._v(t._s(t.fountainDeactivated))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.domesticDeactivated))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.municipalDeactivated))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.publicDeactivated))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.commercialDeactivated))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.industrialDeactivated))]),a("th",{staticClass:"text-right"},[t._v(t._s(t.totalDeactivated))])]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Total de clientes facturados")])]),a("td",{staticClass:"text-right"},[t._v(t._s(t.fountainReadingsTotal))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.domesticReadingsTotal))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.municipalReadingsTotal))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.publicReadingsTotal))]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.commercialReadingsTotal)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.industrialReadingsTotal)+" ")]),a("th",{staticClass:"text-right"},[t._v(t._s(t.readings.length))])]),a("tr",{staticClass:"text-danger"},[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Total de clientes não facturados")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.fountainTotal-t.fountainDeactivated-t.fountainReadingsTotal)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.domesticTotal-t.domesticDeactivated-t.domesticReadingsTotal)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.municipalTotal-t.municipalDeactivated-t.municipalReadingsTotal)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.publicTotal-t.publicDeactivated-t.publicReadingsTotal)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.commercialTotal-t.commercialDeactivated-t.commercialReadingsTotal)+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.industrialTotal-t.industrialDeactivated-t.industrialReadingsTotal)+" ")]),a("th",{staticClass:"text-right"},[t._v(" "+t._s(t.customers.length-t.totalDeactivated-t.readings.length)+" ")])]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Volume de água facturada")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.fountainVolumeBilled)+" m "),a("sup",[t._v("3")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.domesticVolumeBilled)+" m "),a("sup",[t._v("3")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.municipalVolumeBilled)+" m "),a("sup",[t._v("3")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.publicVolumeBilled)+" m "),a("sup",[t._v("3")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.commercialVolumeBilled)+" m "),a("sup",[t._v("3")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.industrialVolumeBilled)+" m "),a("sup",[t._v("3")])]),a("th",{staticClass:"text-right"},[t._v(" "+t._s(t.totalVolumeBilled)+" m "),a("sup",[t._v("3")])])]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Facturação sem IVA")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.fountainWithoutVat.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.domesticWithoutVat.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.municipalWithoutVat.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.publicWithoutVat.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.commercialWithoutVat.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.industrialWithoutVat.toFixed(2))+" ")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.totalInvoicedWithoutVat,expression:"totalInvoicedWithoutVat"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Valor de IVA (12%)")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.calculateVat(t.fountainWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.calculateVat(t.domesticWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.calculateVat(t.municipalWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.calculateVat(t.publicWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.calculateVat(t.commercialWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.calculateVat(t.industrialWithoutVat).toFixed(2))+" ")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.calculateVat(t.totalInvoicedWithoutVat),expression:"calculateVat(totalInvoicedWithoutVat)"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Facturação com IVA")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.billWithVat(t.fountainWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.billWithVat(t.domesticWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.billWithVat(t.municipalWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.billWithVat(t.publicWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.billWithVat(t.commercialWithoutVat).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.billWithVat(t.industrialWithoutVat).toFixed(2))+" ")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.billWithVat(t.totalInvoicedWithoutVat),expression:"billWithVat(totalInvoicedWithoutVat)"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Taxas, outros serviços e multas")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.fountainDebts.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.domesticDebts.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.municipalDebts.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(t._s(t.publicDebts.toFixed(2)))]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.commercialDebts.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.industrialDebts.toFixed(2))+" ")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.totalDebts,expression:"totalDebts"}],staticClass:"text-right"})]),a("tr",[a("td",{attrs:{colspan:"2"}},[a("b",[t._v("Total facturado")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s((t.billWithVat(t.fountainWithoutVat)+t.fountainDebts).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s((t.billWithVat(t.domesticWithoutVat)+t.domesticDebts).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s((t.billWithVat(t.municipalWithoutVat)+t.municipalDebts).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s((t.billWithVat(t.publicWithoutVat)+t.publicDebts).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s((t.billWithVat(t.commercialWithoutVat)+t.commercialDebts).toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s((t.billWithVat(t.industrialWithoutVat)+t.industrialDebts).toFixed(2))+" ")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.totalDebts+t.billWithVat(t.totalInvoicedWithoutVat),expression:"\n                          totalDebts + billWithVat(totalInvoicedWithoutVat)\n                        "}],staticClass:"text-right"})]),a("tr",[a("th",{attrs:{colspan:"2"}},[a("b",[t._v("Valor recebido")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.fountainTotalPaid.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.domesticTotalPaid.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.municipalTotalPaid.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.publicTotalPaid.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.commercialTotalPaid.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.industrialTotalPaid.toFixed(2))+" ")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.totalPaid,expression:"totalPaid"}],staticClass:"text-right"})]),a("tr",[a("th",{attrs:{colspan:"2"}},[a("b",[t._v("Valor em dívida durante o mês")])]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.fountainUnpaidPaidDuringMonth.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.domesticUnpaidPaidDuringMonth.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.municipalUnpaidPaidDuringMonth.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.publicUnpaidPaidDuringMonth.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.comercialUnpaidPaidDuringMonth.toFixed(2))+" ")]),a("td",{staticClass:"text-right"},[t._v(" "+t._s(t.industrialUnpaidPaidDuringMonth.toFixed(2))+" ")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.totalUnpaidPaidDuringMonth,expression:"totalUnpaidPaidDuringMonth"}],staticClass:"text-right"})]),a("tr",[a("th",{attrs:{colspan:"8"}},[a("b",[t._v("TAXA DO CEDENTE - 12% DE FACTURAÇÃO SEM IVA")])]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.calculateTaxaCedente(t.totalInvoicedWithoutVat),expression:"\n                          calculateTaxaCedente(totalInvoicedWithoutVat)\n                        "}],staticClass:"text-right"})]),a("tr",[a("th",{staticClass:"text-center text-white bg-dark",attrs:{colspan:"12"}},[a("b",[t._v("DÍVIDAS ACOMULADAS")])])]),a("tr",[a("th",{attrs:{colspan:"2"}},[a("b",[t._v("TOTAL EM DÍVIDA")])]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getDebtByCat(1),expression:"getDebtByCat(1)"}],staticClass:"text-right"}),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getDebtByCat(2),expression:"getDebtByCat(2)"}],staticClass:"text-right"}),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getDebtByCat(3),expression:"getDebtByCat(3)"}],staticClass:"text-right"}),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getDebtByCat(4),expression:"getDebtByCat(4)"}],staticClass:"text-right"}),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getDebtByCat(5),expression:"getDebtByCat(5)"}],staticClass:"text-right"}),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getDebtByCat(6),expression:"getDebtByCat(6)"}],staticClass:"text-right"}),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getTotalDebt(),expression:"getTotalDebt()"}],staticClass:"text-right"})])])])],1),a("b-col",[a("b-row",[a("b-col",[a("b",[t._v("Notas importantes")])]),a("b-col",{staticClass:"text-right"},[a("b-button",{attrs:{disabled:t.isLoading||!t.readings,block:"",size:"sm",variant:"success"},on:{click:function(e){return t.insertReportNote()}}},[a("b-icon",{attrs:{icon:"journal-plus"}}),t._v(" Salvar ")],1)],1)],1),a("b-form-textarea",{staticClass:"mt-1",attrs:{id:"important-notes",size:"sm",placeholder:"Adicionar uma nota ao relatório",rows:"3","max-rows":"8","no-auto-shrink":""},model:{value:t.reportNote,callback:function(e){t.reportNote=e},expression:"reportNote"}}),a("b-list-group",{staticClass:"mt-1"},t._l(t.reportNotesList,(function(e){return a("b-list-group-item",{key:e.id},[a("small",[a("b",[t._v(t._s(e.id))]),t._v(". "+t._s(e.description))])])})),1)],1)],1):a("b-row",[a("b-col",[a("b-list-group",{staticClass:"text-danger"},[a("b-list-group-item",{staticClass:"text-center text-danger"},[a("h5",[t._v("Houve um erro ao gerar o relatório")])])],1)],1)],1)],1)],1)])])])],1)},bn=[],vn=(a("a4d3"),a("e01a"),"api/customerReports"),hn=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getReports",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(vn,"?tarrifTypeId=").concat(t.tarrifTypeId,"&from=").concat(t.from,"&to=").concat(t.to),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"getBills",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(vn,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"deleteBill",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(vn,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),gn=hn,_n="api/reportNotes",yn=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllService",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(_n,"?month=").concat(t.month,"&year=").concat(t.year),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"deleteReportNote",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("".concat(_n,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertReportNote",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(_n,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"getDebtsByCategory",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put(_n,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),xn=yn;gt.a.locale("pt-br"),Rt.a.vfs=St.a.pdfMake.vfs;var wn=r["default"].extend({name:"Relatorios",created:function(){this.searchPayments(),this.getAcomulatedDebtsByCategory()},mounted:function(){},components:{NavBar:pt},data:function(){return{isLoading:!1,serverError:!1,fromDate:gt()().format("YYYY-MM-01"),toDate:gt()().format("YYYY-MM-")+gt()().daysInMonth(),month:(new Date).getMonth(),reportType:0,consumptionPeriod:gt()().format("YYYY-MM-01"),customers:[],payments:[],totalPaid:0,readings:[],debts:[],accomulatedDebts:[],reportNote:"",reportNotesList:[],noteId:1,fountainTotal:0,domesticTotal:0,municipalTotal:0,publicTotal:0,commercialTotal:0,industrialTotal:0,totalDeactivated:0,fountainDeactivated:0,domesticDeactivated:0,municipalDeactivated:0,publicDeactivated:0,commercialDeactivated:0,industrialDeactivated:0,fountainReadingsTotal:0,domesticReadingsTotal:0,municipalReadingsTotal:0,publicReadingsTotal:0,commercialReadingsTotal:0,industrialReadingsTotal:0,fountainVolumeBilled:0,domesticVolumeBilled:0,municipalVolumeBilled:0,publicVolumeBilled:0,commercialVolumeBilled:0,industrialVolumeBilled:0,totalVolumeBilled:0,totalInvoicedWithoutVat:0,fountainWithoutVat:0,domesticWithoutVat:0,municipalWithoutVat:0,publicWithoutVat:0,commercialWithoutVat:0,industrialWithoutVat:0,totalDebts:0,fountainDebts:0,domesticDebts:0,municipalDebts:0,publicDebts:0,commercialDebts:0,industrialDebts:0,fountainTotalPaid:0,domesticTotalPaid:0,municipalTotalPaid:0,publicTotalPaid:0,commercialTotalPaid:0,industrialTotalPaid:0,fountainUnpaidPaidDuringMonth:0,domesticUnpaidPaidDuringMonth:0,municipalUnpaidPaidDuringMonth:0,publicUnpaidPaidDuringMonth:0,comercialUnpaidPaidDuringMonth:0,industrialUnpaidPaidDuringMonth:0,totalUnpaidPaidDuringMonth:0,totaUnpaidBillsAndBillsPaidPartially:0}},computed:Object(_["a"])({},Object(f["b"])(["user","token","user","company"])),watch:{reportType:function(){1==this.reportType&&this.generateComercialFinancialReport()}},methods:{getAcomulatedDebtsByCategory:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=[1,2,3,4,5,6,7],a.forEach(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(a){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={tariffId:a},e.prev=1,e.next=4,xn.getDebtsByCategory(r,t.token);case 4:n=e.sent,1==n.success?t.accomulatedDebts.push({cat:a,debt:n.result}):console.log(n),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))()},getDebtByCat:function(t){var e=this.accomulatedDebts.filter((function(e){return e.cat==t}));return console.log(e[0]),e[0].debt},getTotalDebt:function(){return this.accomulatedDebts.reduce((function(t,e){return t+e.debt}),0)},getAllReportNotes:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={month:t.readings?t.readings[0].month:0,year:t.readings?t.readings[0].year:0},e.prev=2,e.next=5,xn.getAllService(a,t.token);case 5:r=e.sent,1==r.success?t.reportNotesList=r.result:t.reportNotesList=[],t.isLoading=!1,e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0}),t.reportNotesList=[],t.isLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[2,10]])})))()},insertReportNote:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a={description:t.reportNote,staffName:t.user[0].name,month:t.readings[0].month,year:t.readings[0].year},!(t.reportNote.length<50)){e.next=4;break}return t.$bvToast.toast("A sua nota deve conter pelo menos 50 carateres.",{title:"Erro!",variant:"warning",solid:!0}),e.abrupt("return");case 4:return t.isLoading=!0,e.prev=5,e.next=8,xn.insertReportNote(a,t.token);case 8:r=e.sent,1==r.success?(t.$bvToast.toast(r.message,{title:"Sucesso!",variant:"success",solid:!0}),t.getAllReportNotes()):t.$bvToast.toast(r.message,{title:"Erro!",variant:"danger",solid:!0}),t.isLoading=!1,e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](5),console.log(e.t0),t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0}),t.isLoading=!1;case 18:t.reportNote="",t.noteId=t.noteId++;case 20:case"end":return e.stop()}}),e,null,[[5,13]])})))()},calculateTaxaCedente:function(t){return.12*t},calculateVat:function(t){return.12*t},billWithVat:function(t){return 1.12*t},filterCustomersByCategoryAndStatus:function(){var t=this.customers.filter((function(t){return 2==t.status}));this.totalDeactivated=t.length;var e=this.customers.filter((function(t){return 1==t.tarrifTypeId&&2==t.status}));this.fountainDeactivated=e.length;var a=this.customers.filter((function(t){return 2==t.tarrifTypeId&&2==t.status}));this.domesticDeactivated=a.length;var r=this.customers.filter((function(t){return 3==t.tarrifTypeId&&2==t.status}));this.municipalDeactivated=r.length;var n=this.customers.filter((function(t){return 5==t.tarrifTypeId&&2==t.status}));this.publicDeactivated=n.length;var s=this.customers.filter((function(t){return 4==t.tarrifTypeId&&2==t.status}));this.commercialDeactivated=s.length;var i=this.customers.filter((function(t){return 6==t.tarrifTypeId&&2==t.status}));this.industrialDeactivated=i.length},filterCustomersByCategory:function(){var t=this.customers.filter((function(t){return 1==t.tarrifTypeId}));this.fountainTotal=t.length;var e=this.customers.filter((function(t){return 2==t.tarrifTypeId}));this.domesticTotal=e.length;var a=this.customers.filter((function(t){return 3==t.tarrifTypeId}));this.municipalTotal=a.length;var r=this.customers.filter((function(t){return 5==t.tarrifTypeId}));this.publicTotal=r.length;var n=this.customers.filter((function(t){return 4==t.tarrifTypeId}));this.commercialTotal=n.length;var s=this.customers.filter((function(t){return 6==t.tarrifTypeId}));this.industrialTotal=s.length},filterTotalReadingsByCategory:function(){var t=this.readings.filter((function(t){return 1==t.tarrifTypeId}));this.fountainReadingsTotal=t.length;var e=this.readings.filter((function(t){return 2==t.tarrifTypeId}));this.domesticReadingsTotal=e.length;var a=this.readings.filter((function(t){return 3==t.tarrifTypeId}));this.municipalReadingsTotal=a.length;var r=this.readings.filter((function(t){return 5==t.tarrifTypeId}));this.publicReadingsTotal=r.length;var n=this.readings.filter((function(t){return 4==t.tarrifTypeId}));this.commercialReadingsTotal=n.length;var s=this.readings.filter((function(t){return 6==t.tarrifTypeId}));this.industrialReadingsTotal=s.length},getBilledVolumeOfWaterByCategory:function(){this.totalVolumeBilled=this.readings.reduce((function(t,e){return t+e.consumoFacturado}),0);var t=this.readings.filter((function(t){return 1==t.tarrifTypeId}));this.fountainVolumeBilled=t.reduce((function(t,e){return t+e.consumoFacturado}),0);var e=this.readings.filter((function(t){return 2==t.tarrifTypeId}));this.domesticVolumeBilled=e.reduce((function(t,e){return t+e.consumoFacturado}),0);var a=this.readings.filter((function(t){return 3==t.tarrifTypeId}));this.municipalVolumeBilled=a.reduce((function(t,e){return t+e.consumoFacturado}),0);var r=this.readings.filter((function(t){return 5==t.tarrifTypeId}));this.publicVolumeBilled=r.reduce((function(t,e){return t+e.consumoFacturado}),0);var n=this.readings.filter((function(t){return 4==t.tarrifTypeId}));this.commercialVolumeBilled=n.reduce((function(t,e){return t+e.consumoFacturado}),0);var s=this.readings.filter((function(t){return 6==t.tarrifTypeId}));this.industrialVolumeBilled=s.reduce((function(t,e){return t+e.consumoFacturado}),0)},getInvoiceWithoutVatByCategory:function(){this.totalInvoicedWithoutVat=this.readings.reduce((function(t,e){return t+e.subTotal}),0);var t=this.readings.filter((function(t){return 1==t.tarrifTypeId}));this.fountainWithoutVat=t.reduce((function(t,e){return t+e.subTotal}),0);var e=this.readings.filter((function(t){return 2==t.tarrifTypeId}));this.domesticWithoutVat=e.reduce((function(t,e){return t+e.subTotal}),0);var a=this.readings.filter((function(t){return 3==t.tarrifTypeId}));this.municipalWithoutVat=a.reduce((function(t,e){return t+e.subTotal}),0);var r=this.readings.filter((function(t){return 5==t.tarrifTypeId}));this.publicWithoutVat=r.reduce((function(t,e){return t+e.subTotal}),0);var n=this.readings.filter((function(t){return 4==t.tarrifTypeId}));this.commercialWithoutVat=n.reduce((function(t,e){return t+e.subTotal}),0);var s=this.readings.filter((function(t){return 6==t.tarrifTypeId}));this.industrialTotalPaid=s.reduce((function(t,e){return t+e.subTotal}),0)},getPaymentsByCategory:function(){var t=this.payments.filter((function(t){return 1==t.tarrifTypeId}));this.fountainTotalPaid=t.reduce((function(t,e){return t+e.totalPaid}),0);var e=this.payments.filter((function(t){return 2==t.tarrifTypeId}));this.domesticTotalPaid=e.reduce((function(t,e){return t+e.totalPaid}),0);var a=this.payments.filter((function(t){return 3==t.tarrifTypeId}));this.municipalTotalPaid=a.reduce((function(t,e){return t+e.totalPaid}),0);var r=this.payments.filter((function(t){return 5==t.tarrifTypeId}));this.publicTotalPaid=r.reduce((function(t,e){return t+e.totalPaid}),0);var n=this.payments.filter((function(t){return 4==t.tarrifTypeId}));this.commercialTotalPaid=n.reduce((function(t,e){return t+e.totalPaid}),0);var s=this.payments.filter((function(t){return 6==t.tarrifTypeId}));this.industrialTotalPaid=s.reduce((function(t,e){return t+e.totalPaid}),0)},getDebtsByCategory:function(){this.totalDebts=this.debts.reduce((function(t,e){return t+e.amount}),0);var t=this.debts.filter((function(t){return 1==t.tarrifTypeId}));this.fountainDebts=t.reduce((function(t,e){return t+e.amount}),0);var e=this.debts.filter((function(t){return 2==t.tarrifTypeId}));this.domesticDebts=e.reduce((function(t,e){return t+e.amount}),0);var a=this.debts.filter((function(t){return 3==t.tarrifTypeId}));this.municipalDebts=a.reduce((function(t,e){return t+e.amount}),0);var r=this.debts.filter((function(t){return 5==t.tarrifTypeId}));this.publicDebts=r.reduce((function(t,e){return t+e.amount}),0);var n=this.debts.filter((function(t){return 4==t.tarrifTypeId}));this.commercialDebts=n.reduce((function(t,e){return t+e.amount}),0);var s=this.debts.filter((function(t){return 6==t.tarrifTypeId}));this.industrialDebts=s.reduce((function(t,e){return t+e.amount}),0)},searchPayments:function(){this.getReports(),this.getPayments()},getPayments:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={from:t.fromDate,to:t.toDate,paymentMethod:0},e.prev=2,e.next=5,Da.getAllPayments(a,t.token);case 5:r=e.sent,1==r.success?(t.payments=r.result,t.totalPaid=r.totalRecebido,t.serverError=!0):(t.payments=[],t.totalPaid=0,t.$bvToast.toast(r.message,{title:"Erro:",variant:"info",solid:!0}),t.serverError=!1),t.isLoading=!1,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"Erro:",variant:"info",solid:!0}),t.isLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))()},getReports:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={from:t.fromDate,to:t.toDate,month:t.month},t.isLoading=!0,e.prev=2,e.next=5,gn.getReports(a,t.token);case 5:r=e.sent,1==r.success?(t.customers=r.customers,t.readings=r.readings,t.debts=r.debts,t.getAllReportNotes(),t.populateData(),t.serverError=!0):(t.customers=[],t.debts=[],t.readings=[],t.$bvToast.toast(r.message,{title:"Erro:",variant:"info",solid:!0}),t.serverError=!1,t.isLoading=!1),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),t.$bvToast.toast(e.t0.message,{title:"Error:",variant:"danger",solid:!0}),t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))()},getTotalUnpaidByCategory:function(){var t=this.readings.filter((function(t){return 1==t.tarrifTypeId&&0==t.status}));this.fountainUnpaidPaidDuringMonth=t.reduce((function(t,e){return t+e.totalOfBill}),0);var e=this.readings.filter((function(t){return 2==t.tarrifTypeId&&0==t.status}));this.domesticUnpaidPaidDuringMonth=e.reduce((function(t,e){return t+e.totalOfBill}),0);var a=this.readings.filter((function(t){return 3==t.tarrifTypeId&&0==t.status}));this.municipalUnpaidPaidDuringMonth=a.reduce((function(t,e){return t+e.totalOfBill}),0);var r=this.readings.filter((function(t){return 5==t.tarrifTypeId&&0==t.status}));this.publicUnpaidPaidDuringMonth=r.reduce((function(t,e){return t+e.totalOfBill}),0);var n=this.readings.filter((function(t){return 4==t.tarrifTypeId&&0==t.status}));this.comercialUnpaidPaidDuringMonth=n.reduce((function(t,e){return t+e.totalOfBill}),0);var s=this.readings.filter((function(t){return 6==t.tarrifTypeId&&0==t.status}));this.industrialUnpaidPaidDuringMonth=s.reduce((function(t,e){return t+e.totalOfBill}),0);var i=this.readings.filter((function(t){return 0==t.status}));this.totalUnpaidPaidDuringMonth=i.reduce((function(t,e){return t+e.totalOfBill}),0)},populateData:function(){this.consumptionPeriod=gt()(this.readings[0].consumptionPeriod).format("MMMM YYYY").toUpperCase(),this.filterCustomersByCategory(),this.filterCustomersByCategoryAndStatus(),this.filterTotalReadingsByCategory(),this.getBilledVolumeOfWaterByCategory(),this.getInvoiceWithoutVatByCategory(),this.getDebtsByCategory(),this.getPaymentsByCategory(),this.getTotalUnpaidByCategory(),this.isLoading=!1},reportNoteItems:function(){var t=[];return this.reportNotesList.forEach((function(e){t.push({text:e.description,fontSize:9})})),t},generateComercialFinancialReport:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.next=3,t.getBase64ImageFromURL("https://saaf-tsenane.herokuapp.com/img/logo_12.2b7a27d2.jpeg");case 3:e.t0=e.sent,e.t1=[30,0,0,0],e.t2={image:e.t0,width:250,height:150,margin:e.t1},e.t3=[e.t2],e.t4={columns:[{text:"Documento processado por computador",alignment:"left",fontSize:8,margin:[30,0,0,0]},{text:"TSENANE Software",alignment:"right",fontSize:8,margin:[0,0,30,0]}]},e.t5=[{text:"\n\n\n\n\n\n\n\n"},{columns:[[[{text:"RELATÓRIO COMERCIAL E FINANCEIRO",bold:!0,fontSize:12,alignment:"left"},{text:"\nPERÍODO DE FACTURAÇÃO: ".concat(gt()(t.readings[0].consumptionPeriod).format("MMMM YYYY").toUpperCase()),bold:!1,fontSize:9},{text:"DATA DE IMPRESSÃO: ".concat(gt()().format("DD MMMM YYYY HH:mm").toUpperCase()),bold:!1,fontSize:9}]]]},{text:"\n"},{table:{widths:["*","auto","auto","auto","auto","auto","auto","auto"],body:[[{text:"DESCRIÇÃO",style:"headerRow"},{text:"FONTANÁRIOS",style:"headerRow"},{text:"DOMÉSTICOS",style:"headerRow"},{text:"MUNICIPAL",style:"headerRow"},{text:"PÚBLICO",style:"headerRow"},{text:"COMERCIAL",style:"headerRow"},{text:"INDUSTRIAL",style:"headerRow"},{text:"TOTAL",style:"headerRow",alignment:"right"}],[{text:"Total de clientes existentes",style:"headerRow"},{text:t.fountainTotal,style:"bodyRow"},{text:t.domesticTotal,style:"bodyRow"},{text:t.municipalTotal,style:"bodyRow"},{text:t.publicTotal,style:"bodyRow"},{text:t.commercialTotal,style:"bodyRow"},{text:t.industrialTotal,style:"bodyRow"},{text:t.customers.length,style:"bodyRow"}],[{text:"Total de clientes activos",style:"headerRow"},{text:t.fountainTotal-t.fountainDeactivated,style:"bodyRow"},{text:t.domesticTotal-t.domesticDeactivated,style:"bodyRow"},{text:t.municipalTotal-t.municipalDeactivated,style:"bodyRow"},{text:t.publicTotal-t.publicDeactivated,style:"bodyRow"},{text:t.commercialTotal-t.commercialDeactivated,style:"bodyRow"},{text:t.industrialTotal-t.industrialDeactivated,style:"bodyRow"},{text:t.customers.length-t.totalDeactivated,style:"bodyRow"}],[{text:"Total de clientes desactivados",style:"headerRow"},{text:t.fountainDeactivated,style:"bodyRow"},{text:t.domesticDeactivated,style:"bodyRow"},{text:t.municipalDeactivated,style:"bodyRow"},{text:t.publicDeactivated,style:"bodyRow"},{text:t.commercialDeactivated,style:"bodyRow"},{text:t.industrialDeactivated,style:"bodyRow"},{text:t.totalDeactivated,style:"bodyRow"}],[{text:"Total de clientes facturados",style:"headerRow"},{text:t.fountainReadingsTotal,style:"bodyRow"},{text:t.domesticReadingsTotal,style:"bodyRow"},{text:t.municipalReadingsTotal,style:"bodyRow"},{text:t.publicReadingsTotal,style:"bodyRow"},{text:t.commercialReadingsTotal,style:"bodyRow"},{text:t.industrialReadingsTotal,style:"bodyRow"},{text:t.readings.length,style:"bodyRow"}],[{text:"Total de clientes não facturados",style:"headerRow"},{text:t.fountainTotal-t.fountainDeactivated-t.fountainReadingsTotal,style:"bodyRow"},{text:t.domesticTotal-t.domesticDeactivated-t.domesticReadingsTotal,style:"bodyRow"},{text:t.municipalTotal-t.municipalDeactivated-t.municipalReadingsTotal,style:"bodyRow"},{text:t.publicTotal-t.publicDeactivated-t.publicReadingsTotal,style:"bodyRow"},{text:t.commercialTotal-t.commercialDeactivated-t.commercialReadingsTotal,style:"bodyRow"},{text:t.industrialTotal-t.industrialDeactivated-t.industrialReadingsTotal,style:"bodyRow"},{text:t.customers.length-t.totalDeactivated-t.readings.length,style:"bodyRow"}],[{text:"Volume de água facturada",style:"headerRow"},{text:t.fountainVolumeBilled,style:"bodyRow"},{text:t.domesticVolumeBilled,style:"bodyRow"},{text:t.municipalVolumeBilled,style:"bodyRow"},{text:t.publicVolumeBilled,style:"bodyRow"},{text:t.commercialVolumeBilled,style:"bodyRow"},{text:t.industrialVolumeBilled,style:"bodyRow"},{text:t.totalVolumeBilled,style:"bodyRow"}],[{text:"Facturação sem IVA",style:"headerRow"},{text:ra.formatMoney(t.fountainWithoutVat),style:"bodyRow"},{text:ra.formatMoney(t.domesticWithoutVat),style:"bodyRow"},{text:ra.formatMoney(t.municipalWithoutVat),style:"bodyRow"},{text:ra.formatMoney(t.publicWithoutVat),style:"bodyRow"},{text:ra.formatMoney(t.commercialWithoutVat),style:"bodyRow"},{text:ra.formatMoney(t.industrialWithoutVat),style:"bodyRow"},{text:ra.formatMoney(t.totalInvoicedWithoutVat),style:"bodyRow"}],[{text:"Valor do IVA (12%)",style:"headerRow"},{text:ra.formatMoney(t.calculateVat(t.fountainWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.calculateVat(t.domesticWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.calculateVat(t.municipalWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.calculateVat(t.publicWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.calculateVat(t.commercialWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.calculateVat(t.industrialWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.calculateVat(t.totalInvoicedWithoutVat)),style:"bodyRow"}],[{text:"Facturação com IVA",style:"headerRow"},{text:ra.formatMoney(t.billWithVat(t.fountainWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.billWithVat(t.domesticWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.billWithVat(t.municipalWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.billWithVat(t.publicWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.billWithVat(t.commercialWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.billWithVat(t.industrialWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.billWithVat(t.totalInvoicedWithoutVat)),style:"bodyRow"}],[{text:"Taxas, outros serviços e multas",style:"headerRow"},{text:ra.formatMoney(t.fountainDebts),style:"bodyRow"},{text:ra.formatMoney(t.domesticDebts),style:"bodyRow"},{text:ra.formatMoney(t.municipalDebts),style:"bodyRow"},{text:ra.formatMoney(t.publicDebts),style:"bodyRow"},{text:ra.formatMoney(t.commercialDebts),style:"bodyRow"},{text:ra.formatMoney(t.industrialDebts),style:"bodyRow"},{text:ra.formatMoney(t.totalDebts),style:"bodyRow"}],[{text:"Total facturado",style:"headerRow"},{text:ra.formatMoney(t.fountainDebts+t.billWithVat(t.fountainWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.domesticDebts+t.billWithVat(t.domesticWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.municipalDebts+t.billWithVat(t.municipalWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.publicDebts+t.billWithVat(t.publicWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.commercialDebts+t.billWithVat(t.commercialWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.industrialDebts+t.billWithVat(t.industrialWithoutVat)),style:"bodyRow"},{text:ra.formatMoney(t.totalDebts+ +t.billWithVat(t.totalInvoicedWithoutVat)),style:"bodyRow"}],[{text:"Valor recebido",style:"headerRow"},{text:ra.formatMoney(t.fountainTotalPaid),style:"bodyRow"},{text:ra.formatMoney(t.domesticTotalPaid),style:"bodyRow"},{text:ra.formatMoney(t.municipalTotalPaid),style:"bodyRow"},{text:ra.formatMoney(t.publicTotalPaid),style:"bodyRow"},{text:ra.formatMoney(t.commercialTotalPaid),style:"bodyRow"},{text:ra.formatMoney(t.industrialTotalPaid),style:"bodyRow"},{text:ra.formatMoney(t.totalPaid),style:"bodyRow"}],[{text:"Valor em dívida durante o mês",style:"headerRow"},{text:ra.formatMoney(t.fountainUnpaidPaidDuringMonth),style:"bodyRow"},{text:ra.formatMoney(t.domesticUnpaidPaidDuringMonth),style:"bodyRow"},{text:ra.formatMoney(t.municipalUnpaidPaidDuringMonth),style:"bodyRow"},{text:ra.formatMoney(t.publicUnpaidPaidDuringMonth),style:"bodyRow"},{text:ra.formatMoney(t.comercialUnpaidPaidDuringMonth),style:"bodyRow"},{text:ra.formatMoney(t.industrialUnpaidPaidDuringMonth),style:"bodyRow"},{text:ra.formatMoney(t.totalUnpaidPaidDuringMonth),style:"bodyRow"}],[{text:"DÍVIDAS ACOMULADA",style:"headerRow"},{text:ra.formatMoney(t.getDebtByCat(1)),style:"bodyRow"},{text:ra.formatMoney(t.getDebtByCat(2)),style:"bodyRow"},{text:ra.formatMoney(t.getDebtByCat(3)),style:"bodyRow"},{text:ra.formatMoney(t.getDebtByCat(4)),style:"bodyRow"},{text:ra.formatMoney(t.getDebtByCat(5)),style:"bodyRow"},{text:ra.formatMoney(t.getDebtByCat(6)),style:"bodyRow"},{text:ra.formatMoney(t.getTotalDebt()),style:"bodyRow"}]]},layout:"lightHorizontalLines"},{text:t.reportNoteItems().length>0?"\nNota: ":"",fontSize:11,bold:!0},{ul:t.reportNoteItems().length>0?t.reportNoteItems():[]}],e.t6={headerRow:{bold:!0,fontSize:10},bodyRow:{fontSize:8,alignment:"right"}},a={pageOrientation:"landscape",header:e.t3,footer:e.t4,content:e.t5,styles:e.t6},Rt.a.createPdf(a).open(),t.isLoading=!1;case 13:case"end":return e.stop()}}),e)})))()},getBase64ImageFromURL:function(t){var e=this;return new Promise((function(a,r){var n=new Image;n.setAttribute("crossOrigin","anonymous"),n.onload=function(){var t=document.createElement("canvas");t.width=n.width,t.height=n.height;var e=t.getContext("2d");e.drawImage(n,0,0);var r=t.toDataURL("image/png");a(r)},n.onerror=function(t){e.isLoading=!1,r(t)},n.src=t}))}}}),Cn=wn,kn=(a("2a88"),Object(u["a"])(Cn,fn,bn,!1,null,"4155f3fc",null)),Tn=kn.exports,Rn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{name:"new-cashier"}},[a("nav-bar-cashier"),a("b-container",{staticClass:"bv-example-row mt-2",attrs:{fluid:""}},[a("b-col",[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body"},[a("b-row",[a("b-col",{attrs:{lg:"3"}},[a("b-input-group",{staticClass:"mb-2",attrs:{size:"md"}},[a("b-input-group-prepend",{attrs:{"is-text":""}},[a("b-icon",{attrs:{icon:"search"}})],1),a("b-form-input",{attrs:{type:"text",size:"md",placeholder:"Pesquisar clientes"},on:{keyup:function(e){return t.searchCustomer()}},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}})],1),a("b-row",{staticClass:"mt-1"},[a("b-col",[a("b-overlay",{staticClass:"bg-white",attrs:{show:t.isLoading,rounded:"sm"}},[t.customers.length>0?a("b-list-group",t._l(t.customers,(function(e){return a("b-list-group-item",{key:e.id,staticClass:"flex-column align-items-start",staticStyle:{cursor:"pointer","font-size":"10pt"},on:{click:function(a){return t.openVendingPanel(e)}}},[a("div",{staticClass:"d-flex w-100 justify-content-between text-secondary"},[a("h2",{staticClass:"mb-0",staticStyle:{"font-size":"10pt"}},[1==e.status?a("b-icon",{attrs:{icon:"person-fill"}}):a("b-icon",{attrs:{icon:"person-fill",variant:"danger"}}),t._v("    "),a("small",[a("b",[t._v(t._s(e.name))])])],1),a("small",{staticClass:"text-muted"},[t._v(t._s(t.tariffId(e.tarrifTypeId)))])]),a("p",{staticClass:"mb-0"},[a("small",{staticClass:"text-muted"},[t._v(t._s(e.address)+" - "+t._s(e.barcode)+" "),a("br"),a("b",[a("em",[t._v(t._s(t.getMeterType(e.meeter_type)))])])])])])})),1):t._e(),t.error?a("b-list-group",{staticClass:"text-danger"},[a("b-list-group-item",{staticClass:"text-center text-danger"},[a("h5",[t._v("Sem nenhum resultado")])])],1):t._e()],1)],1)],1)],1),a("b-col",[t.clickedCustomer?a("ValidationComponent"):a("b-alert",{attrs:{variant:"success",show:""}},[a("b-icon",{attrs:{icon:"exclamation-circle-fill",variant:"info","font-scale":"1.5"}}),t._v(" Seleccione um cliente por favor ")],1)],1)],1)],1)])])],1)],1)},Pn=[],Sn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"validation-component"},[a("b-row",[a("b-col",{staticClass:"d-flex w-100 justify-content-between text-secondary"},[a("b",[a("b-icon",{attrs:{icon:"person-fill","font-scale":"1.5"}}),t._v(" "+t._s(t.currentCustomer.name))],1),a("b",[a("b-icon",{attrs:{icon:"speedometer2","font-scale":"1.5"}}),t._v(" "+t._s(t.currentCustomer.barcode))],1)]),a("b-col",{staticClass:"text-right text-secondary",staticStyle:{cursor:"pointer"},attrs:{lg:"2"}},[a("b-icon",{attrs:{icon:"whatsapp",variant:"success","font-scale":"1"}})],1)],1),a("hr",{staticClass:"bg-dark mb-0 mt-0"}),a("b-row",[a("b-col",{attrs:{cols:"4"}},[a("table",{staticClass:"table table-sm table-bordered mt-1",staticStyle:{"font-size":"10pt"}},[a("thead",[a("tr",{staticClass:"text-danger"},[a("th",[t._v("TOTAL DA DÍVIDA")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.saldoDivida,expression:"saldoDivida"}],staticClass:"text-right"})])])]),a("small",[t._v("Valor recebido")]),a("b-form-group",{attrs:{id:"value","label-for":"value"}},[a("b-form-input",{attrs:{id:"value",type:"number",min:"180.40",max:"10000",step:"any",required:"",size:"sm",placeholder:"Montante a pagar"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),a("small",[t._v("Percentagem da dívida (%)")]),a("b-form-group",{attrs:{id:"debtPercentage","label-for":"debtPercentage"}},[a("b-form-input",{attrs:{id:"debtPercentage",type:"number",min:"0",max:"100",required:"",size:"sm",placeholder:"Percentagem da dívida"},model:{value:t.debtPercentage,callback:function(e){t.debtPercentage=e},expression:"debtPercentage"}})],1),a("table",{staticClass:"table table-sm table-bordered",staticStyle:{"font-size":"10pt"}},[a("thead",[t.debtRefunded>0?a("tr",[a("td",[t._v("Reembolso da dívida:")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.debtRefunded,expression:"debtRefunded"}],staticClass:"text-right"})]):t._e(),t.debtAfterPurchase>0?a("tr",[a("td",[t._v("Dívida após a compra:")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.debtAfterPurchase,expression:"debtAfterPurchase"}],staticClass:"text-right"})]):t._e(),t.amountValue>0?a("tr",[a("td",[t._v("Valor de compra de água")]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.amountValue,expression:"amountValue"}],staticClass:"text-right"})]):t._e()])]),a("b-button",{staticClass:"mt-2 mb-2 sm",attrs:{disabled:t.value<=0||1==t.isLoading,block:"",variant:"success",size:"sm"},on:{click:function(e){return t.previewPurchase()}}},[t.isLoading?[t._v(" "+t._s(t.$t("submiting"))+" "),a("b-spinner",{attrs:{small:"",type:"grow"}})]:[t._v(t._s(t.$t("submit")))]],2)],1),a("b-col",[a("h5",{staticClass:"text-dark mb-1 mt-1"},[t._v("Histórico de compras")]),a("b-overlay",{attrs:{show:t.isLoading,rounded:"sm"}},[0==t.purchases.length?a("b-alert",{attrs:{variant:"danger",show:""}},[a("b-icon",{attrs:{icon:"exclamation-circle-fill",variant:"warning","font-scale":"1.5"}}),a("b",{staticClass:"text-danger"},[t._v("   "),a("small",[t._v("Sem nenhum registo de compra para este cliente.")])])],1):a("table",{staticClass:"table table-sm mt-1",staticStyle:{"font-size":"10pt"}},[a("thead",[a("tr",{staticClass:"text-dark",staticStyle:{"font-size":"8pt"}},[a("th",[t._v("Recibo")]),a("th",[t._v("Montante")]),a("th",[t._v("Volume")]),a("th",[t._v("Recarga")]),a("th",[t._v("Acções")])]),t._l(t.purchases,(function(e){return a("tr",{key:e.id,staticClass:"text-dark",staticStyle:{"font-size":"8pt"}},[a("td",[t._v(t._s(e.receiptNumber))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:t.convertMoney(e.totalPaid),expression:"convertMoney(bill.totalPaid)"}]}),a("td",[t._v(t._s(e.totalUnities)+" m "),a("sup",[t._v("3")])]),a("td",[t._v(t._s(e.token))]),a("td")])}))],2)])],1)],1)],1),a("b-modal",{ref:"show-error-message",attrs:{"hide-footer":"",title:t.messageInfo}},[t.errorMessage?a("p",{staticClass:"text-danger",staticStyle:{"font-size":"12pt"}},[t._v(" "+t._s(t.errorMessage)+" ")]):a("div",{staticClass:"mt-1"},[a("b-row",{staticStyle:{"font-size":"10pt"}},[a("b-col",[t._v("TOTAL PAGO: "),a("b",{directives:[{name:"money-format",rawName:"v-money-format",value:t.value,expression:"value"}]})]),a("b-col",[t._v("VOLUME: "),a("b",[t._v(t._s(t.purchasePreview.totalUnities)+" m"),a("sup",[t._v("3")])])])],1),a("hr",{staticClass:"bg-dark mt-1 mb-1"}),a("b-row",[a("b-col",[a("small",[t._v("Pagamento da dívida "),a("b",[t._v(t._s(t.debtPercentage/100*100)+"%")])]),a("b-form-group",{attrs:{"label-for":"debit_balance"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",disabled:""},model:{value:t.debtRefunded,callback:function(e){t.debtRefunded=e},expression:"debtRefunded"}})],1)],1),a("b-col",[a("small",[t._v("Valor da compra")]),a("b-form-group",{attrs:{"label-for":"amount_received"}},[a("b-form-input",{attrs:{type:"number",size:"sm",step:"any",disabled:"",min:0},model:{value:t.amountValue,callback:function(e){t.amountValue=e},expression:"amountValue"}})],1)],1)],1),a("b-row",[a("b-col",[a("small",[t._v(t._s(t.$t("payment_method")))]),a("b-form-select",{attrs:{options:t.options,size:"sm"},model:{value:t.paymentMethod,callback:function(e){t.paymentMethod=e},expression:"paymentMethod"}})],1),a("b-col",[a("small",[t._v(t._s(t.$t("payment_reference")))]),a("b-form-group",{attrs:{"label-for":"payment_reference"}},[a("b-form-input",{attrs:{type:"text",size:"sm",disabled:1==t.paymentMethod||7==t.paymentMethod},model:{value:t.paymentReference,callback:function(e){t.paymentReference=e},expression:"paymentReference"}})],1)],1)],1),a("b-row",[7==t.paymentMethod?a("b-col",[a("b-form-group",{attrs:{"label-for":"notificationNumber"}},[a("b-form-input",{attrs:{type:"number",size:"sm",placeholder:"Telemóvel a debitar"},model:{value:t.notificationNumber,callback:function(e){t.notificationNumber=e},expression:"notificationNumber"}})],1)],1):t._e(),a("b-col",[a("b-button",{attrs:{disabled:t.isLoading,block:"",size:"sm",variant:"success"},on:{click:function(e){return t.makePurchase()}}},[t._v(t._s(t.$t("pay_now")))])],1)],1)],1)])],1)},Dn=[],$n="api/prepayVending",An=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllCustomers",value:function(t,e){var a="".concat($n),r="Bearer "+e;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(e,n){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(a,{headers:{Authorization:r}});case 3:s=t.sent,i=s.data,e(i),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getPurchases",value:function(t,e){var a="".concat($n,"/").concat(t),r="Bearer "+e;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(e,n){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(a,{headers:{Authorization:r}});case 3:s=t.sent,i=s.data,e(i),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"previewPurchase",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post($n,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),In=An;gt.a.locale("pt-br");var On={name:"Validation-component",components:{},data:function(){return{messageInfo:"Previsualização da compra",isLoading:!1,filteredBills:[],value:0,debtPercentage:20,saldoDivida:0,debtAfterPurchase:0,purchases:[],payments:[],errorMessage:"",purchasePreview:{},paymentMethod:"",paymentReference:null,amountValue:0,debtRefunded:0,notificationNumber:258,options:[{value:1,text:"Boca do Caixa"},{value:2,text:"Depósito Bancário"},{value:3,text:"Transferência Bancária"},{value:4,text:"POS"},{value:5,text:"Cheque"},{value:6,text:"SISTAFE"},{value:7,text:"MPESA Open API"},{value:8,text:"E-Mola"}]}},computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","company","currentCustomer"])),watch:{currentCustomer:function(){this.getDebts(),this.getPurchases()},paymentMethod:function(){7==this.paymentMethod&&console.log("Hello from mpesa payment")},value:function(){this.processPurchase()},debtPercentage:function(){this.processPurchase()}},created:function(){this.getDebts(),this.getPurchases()},methods:{getPurchases:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,In.getPurchases(t.currentCustomer.barcode,t.token);case 4:a=e.sent,1==a.success?(t.purchases=a.result,t.isLoading=!1):(t.purchases=[],t.isLoading=!1),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0),t.purchases=[],t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))()},processPurchase:function(){this.saldoDivida>0?(this.debtRefunded=this.value*(this.debtPercentage/100),this.amountValue=this.value-this.debtRefunded,this.debtAfterPurchase=this.saldoDivida-this.debtRefunded):(this.debtRefunded=0,this.amountValue=this.value,this.debtAfterPurchase=this.saldoDivida-this.debtRefunded)},previewPurchase:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={valueOfWater:t.amountValue,meter_id:t.currentCustomer.barcode,preview:1},e.prev=2,e.next=5,In.previewPurchase(a,t.token);case 5:r=e.sent,1==r.success?(n=r.result.result_code,"03"==n?(t.messageInfo="Erro!",t.errorMessage="O valor da compra é menor que o mínimo!"):"02"==n?(t.messageInfo="Erro de servidor!",t.errorMessage="Houve um erro, volte a tentar mais tarde!"):"00"==n&&(t.messageInfo="Previsualização da compra",t.purchasePreview={value:r.result.result.value,totalUnities:r.result.result.unit}),t.$refs["show-error-message"].show()):t.$refs["show-error-message"].show(),t.isLoading=!1,e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](2),t.messageInfo="Erro!",console.log(e.t0),t.isLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[2,10]])})))()},makePurchase:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,a={debtRefunded:t.debtRefunded,debtAfterPurchase:t.debtAfterPurchase,debtBeforePurchase:t.saldoDivida,notificationNumber:t.notificationNumber,paymentMethod:t.paymentMethod,paymentReference:t.paymentReference,staffName:t.user[0].name,valueOfWater:t.amountValue,totalPaid:t.value,meter_id:t.currentCustomer.barcode,preview:2},e.prev=2,e.next=5,In.previewPurchase(a,t.token);case 5:r=e.sent,1==r.success?(console.log(r),t.getPurchases(),t.$refs["show-receipt-modal"].show()):(console.log(r),t.messageInfo="Erro!",t.errorMessage=r.message,t.$refs["show-error-message"].show()),t.isLoading=!1,e.next=16;break;case 10:e.prev=10,e.t0=e["catch"](2),t.messageInfo="Erro!",t.errorMessage=e.t0.message,t.$refs["show-error-message"].show(),t.isLoading=!1;case 16:case"end":return e.stop()}}),e,null,[[2,10]])})))()},convertMonthToString:function(t){return gt()(t).format("MMMM Y").toUpperCase()},convertMoney:function(t){return parseFloat(t)},getDebts:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Ue.getDebtByCustomerId(t.currentCustomer.barcode,t.token);case 4:a=e.sent,1==a.success?(t.saldoDivida=null==a.totalDues?0:a.totalDues,t.payments=a.payments):t.saldoDivida=0,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:t.isLoading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))()}}},Nn=On,Mn=Object(u["a"])(Nn,Sn,Dn,!1,null,null,null),zn=Mn.exports,Bn={name:"CashierView",components:{NavBarCashier:ba,ValidationComponent:zn},computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","company","currentCustomer"])),created:function(){this.getCustomers()},data:function(){return{isLoading:!1,clickedCustomer:!1,error:"",paymentOptions:[{value:1,text:"Boca do Caixa"},{value:2,text:"Depósito Bancário"},{value:3,text:"Transferência Bancária"},{value:4,text:"POS"},{value:5,text:"Cheque"},{value:6,text:"SISTAFE"},{value:7,text:"MPESA Open API"},{value:8,text:"E-Mola"}],searchValue:"",customers:[],today:gt()().format("DD-MM-YYYY")}},methods:{searchCustomer:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.clickedCustomer=!1,0!=t.searchValue.length){e.next=5;break}return t.customers=[],t.$store.commit("SET_CURRENT_CUSTOMER",[]),e.abrupt("return");case 5:return t.isLoading=!0,e.prev=6,e.next=9,Mt.searchCustomers(t.searchValue,t.token);case 9:a=e.sent,1==a.success?(t.customers=a.result,t.isLoading=!1,t.error=!1):(t.isLoading=!1,t.customers=[],t.error=!0),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](6),t.clickedCustomer=!1,t.$bvToast.toast(""+e.t0.message,{title:"Erro",variant:"danger",solid:!0}),t.customers=[];case 18:case"end":return e.stop()}}),e,null,[[6,13]])})))()},getCustomers:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Mt.getCustomers(t.token);case 4:a=e.sent,1==a.success?(t.customers=a.result,t.isLoading=!1,t.error=!1):(t.isLoading=!1,t.customers=[],t.error=!0),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](1),t.$bvToast.toast(""+e.t0.message,{title:"Erro",variant:"danger",solid:!0}),t.isLoading=!1,t.customers=[];case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))()},tariffId:function(t){return 1==t?(this.quantityMinTariff=0,"Fontenária"):2==t?(this.quantityMinTariff=5,"Doméstica"):3==t?(this.quantityMinTariff=0,"Municipal"):4==t?(this.quantityMinTariff=15,"Comercial"):5==t?(this.quantityMinTariff=15,"Público"):6==t?(this.quantityMinTariff=15,"Industrial"):void 0},openVendingPanel:function(t){this.clickedCustomer=!0,this.$store.commit("SET_CURRENT_CUSTOMER",t)},getMeterType:function(t){return 1==t?"Contador pós-pago":"Contador pré-pago"}}},jn=Bn,En=(a("e2c7"),Object(u["a"])(jn,Rn,Pn,!1,null,"3462e850",null)),Ln=En.exports,Vn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("nav-bar"),a("b-row",[a("b-col",[a("b-card",{attrs:{"header-tag":"header"}},[a("b-row",[a("b-col",{},[a("b-overlay",{staticClass:"mb-2 bg-white",attrs:{show:t.isLoading,rounded:"lg"}},[t.proformas.length>0?a("table",{staticClass:"table table-sm table-hover table-stripped"},[a("thead",[a("tr",{staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"7"}},[t._v("FACTURAS PROFORMA")]),a("th",{staticClass:"text-right",attrs:{colspan:"3"}},[t._v(" "+t._s(t.proformas.length)+" ")])])]),a("thead",[a("tr",{staticClass:"bg-dark text-white",attrs:{id:"reportList"}},[a("th",[t._v("F/P NR")]),a("th",[t._v("Data de emissão")]),a("th",[t._v("Nome do cliente")]),a("th",[t._v("Telemóvel")]),a("th",[t._v("Morada")]),a("th",[t._v("Estado")]),a("th",{staticClass:"text-right"},[t._v("Montante")]),a("th",{staticClass:"text-center"},[t._v("Ver")])])]),a("tbody",t._l(t.proformas,(function(e){return a("tr",{key:e.id,class:{"text-primary":-1==e.status,"text-success":1==e.status,"bg-warning":e.id==t.currentProforma.id}},[a("td",{staticClass:"align-middle"},[t._v(" "+t._s(t.processInvoiceYear(e))+" ")]),a("td",{directives:[{name:"date-format",rawName:"v-date-format",value:e.createdAt,expression:"proforma.createdAt"}],staticClass:"align-middle"},[t._v(" } ")]),a("td",{staticClass:"align-middle"},[t._v(t._s(e.customerName))]),a("td",{staticClass:"align-middle"},[t._v(" "+t._s(e.customerPhoneNumber)+" ")]),a("td",{staticClass:"align-middle"},[t._v(" "+t._s(e.customerAddress)+" ")]),a("td",{staticClass:"align-middle"},[t._v(" "+t._s(t.getProformaStatus(e.status))+" ")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.getTotalOfBill(e),expression:"getTotalOfBill(proforma)"}],staticClass:"align-middle text-right"}),a("td",{staticClass:"align-middle text-center",on:{click:function(a){return t.previewProforma(e)}}},[a("span",{staticClass:"h6"},[a("b-icon",{attrs:{variant:"primary",icon:"eye-fill"}})],1)])])})),0)]):a("b-alert",{staticClass:"text-center",attrs:{variant:"danger",show:"",dismissible:""}},[a("i",{staticClass:"fas fa-info"}),t._v(" Proforma indisponíveis! ")])],1)],1)],1)],1)],1)],1),a("b-modal",{ref:"preview-proforma",attrs:{"hide-footer":"",size:"xl",title:"Factura Proforma Nº: "+t.processInvoiceYear(t.currentProforma)}},[a("QuotationPreview",{attrs:{currentProforma:t.currentProforma}})],1)],1)},Fn=[],Un=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"quotation"},[a("b-overlay",{attrs:{show:t.isLoading,rounded:"sm"}},[a("b-row",[a("b-col",{attrs:{lg:"4"}},[a("small",[a("b",[t._v("Nome do cliente")])]),a("b-form-group",{attrs:{"label-for":"name"}},[a("b-form-input",{attrs:{id:"name",type:"text",disabled:"",required:"",size:"sm",placeholder:"Nome do cliente"},model:{value:t.customerName,callback:function(e){t.customerName=e},expression:"customerName"}})],1),a("small",[a("b",[t._v("Endereço")])]),a("b-form-group",{attrs:{"label-for":"address"}},[a("b-form-input",{attrs:{id:"address",type:"text",disabled:"",required:"",size:"sm",placeholder:"Endereço"},model:{value:t.customerAddress,callback:function(e){t.customerAddress=e},expression:"customerAddress"}})],1),a("small",[a("b",[t._v("Telemóvel")])]),a("b-form-group",{attrs:{"label-for":"phone"}},[a("b-form-input",{attrs:{id:"phone",type:"number",disabled:"",required:"",size:"sm",placeholder:"Telemóvel"},model:{value:t.customerPhoneNumber,callback:function(e){t.customerPhoneNumber=e},expression:"customerPhoneNumber"}})],1),a("small",[a("b",[t._v("NUIT")])]),a("b-form-group",{attrs:{"label-for":"nuit"}},[a("b-form-input",{attrs:{id:"nuit",type:"number",disabled:"",required:"",size:"sm",placeholder:"NUIT"},model:{value:t.customerNuit,callback:function(e){t.customerNuit=e},expression:"customerNuit"}})],1)],1),a("b-col",[a("b-row",[a("b-col",[a("b",[t._v("Dados da factura")])]),a("b-col",{staticClass:"text-right"},[a("b",[t._v("Data de emissão: "+t._s(t.dateOfQuote))])]),a("b-col",{attrs:{cols:"2"}},[a("b-button",{staticClass:"mb-2",attrs:{disabled:t.isLoading||t.itemsList.length<=0,block:"",size:"sm",variant:"secondary"},on:{click:function(e){return t.saveProforma()}}},[a("span",[t._v("Baixar ")]),a("b-icon",{attrs:{icon:"file-pdf-fill"}})],1)],1)],1),a("table",{staticClass:"table table-sm table-hover"},[a("thead",[a("tr",{staticStyle:{"font-size":"9pt"}},[a("th",{staticClass:"text-center"},[t._v("Ordem")]),a("th",{attrs:{colspan:"2"}},[t._v("Descrição do Produto")]),a("th",[t._v("Preço Unitário")]),a("th",[t._v("Quantidade")]),a("th",{staticClass:"text-right"},[t._v("Subtotal")])]),t._l(t.itemsList,(function(e,r){return a("tr",{key:r,staticStyle:{"font-size":"9pt"}},[a("td",{staticClass:"text-center"},[t._v(" "+t._s(r+1)+" ")]),a("td",{attrs:{colspan:"2"}},[t._v(t._s(e.item))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:e.price,expression:"item.price"}]}),a("td",[t._v(t._s(e.quantity))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:e.price*e.quantity,expression:"item.price * item.quantity"}],staticClass:"text-right"})])}))],2),a("tbody",[a("tr",[a("td",{attrs:{colspan:"6"}},[a("br"),a("br")])]),a("tr",{staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"3"}},[t._v("Subtotal")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.calculateSubTotal(),expression:"calculateSubTotal()"}],staticClass:"text-right",attrs:{colspan:"3"}})]),a("tr",{staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"3"}},[t._v("IVA - "+t._s(100*t.vat)+"%")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.vat*t.calculateSubTotal(),expression:"vat * calculateSubTotal()"}],staticClass:"text-right",attrs:{colspan:"3"}})]),a("tr",{staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"3"}},[t._v("TOTAL A PAGAR")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.calculateSubTotal()+t.calculateSubTotal()*t.vat,expression:"\n                  calculateSubTotal() + calculateSubTotal() * vat\n                "}],staticClass:"text-right",attrs:{colspan:"3"}})]),a("tr",{staticClass:"text-danger",staticStyle:{"font-size":"10pt"}},[a("th",{attrs:{colspan:"3"}},[t._v("DÍVIDA")]),a("th",{directives:[{name:"money-format",rawName:"v-money-format",value:t.saldoDevedor,expression:"saldoDevedor"}],staticClass:"text-right",attrs:{colspan:"3"}})])])])],1)],1),a("hr",{staticClass:"bg-dark mt-0 mb-1"}),a("h6",{staticClass:"text-dark",staticStyle:{"font-size":"10pt"}},[a("b",[t._v("Adicionar pagamento")])]),a("b-row",[a("b-col",[a("b-form-select",{attrs:{disabled:1==t.currentProforma.status,options:t.options,size:"sm"},model:{value:t.paymentMethod,callback:function(e){t.paymentMethod=e},expression:"paymentMethod"}})],1),a("b-col",[a("b-form-group",{attrs:{"label-for":"amountPaid"}},[a("b-form-input",{attrs:{id:"amountPaid",type:"number",step:"any",disabled:1==t.currentProforma.status,required:"",min:"10",size:"sm",placeholder:"Valor a pagar"},model:{value:t.amount2Paid,callback:function(e){t.amount2Paid=e},expression:"amount2Paid"}})],1)],1),a("b-col",[a("b-form-group",{attrs:{"label-for":"reference"}},[a("b-form-input",{attrs:{id:"paymentReference",type:"text",disabled:1==t.currentProforma.status,required:"",size:"sm",placeholder:"Referência de pagamento"},model:{value:t.paymentReference,callback:function(e){t.paymentReference=e},expression:"paymentReference"}})],1)],1),a("b-col",{staticClass:"text-right"},[a("b-button",{attrs:{disabled:1==t.currentProforma.status,pill:"",variant:"success",block:"",size:"sm"},on:{click:function(e){return t.addPayment()}}},[a("span",[t._v("Submeter pagamento ")]),a("b-icon",{attrs:{variant:"light",icon:"telegram"}})],1)],1)],1),a("h6",{staticClass:"text-dark",staticStyle:{"font-size":"10pt"}},[a("b",[t._v("Pagamentos relacionados")])]),t.currentProformaTransactions.length>0?a("table",{staticClass:"table table-sm table-hover table-stripped"},[a("thead",[a("tr",{staticClass:"bg-secondary text-light",staticStyle:{"font-size":"9pt"}},[a("th",[t._v("Data de pagamento")]),a("th",[t._v("Referência")]),a("th",[t._v("Método de pagamento")]),a("th",[t._v("Telemóvel")]),a("th",[t._v("Valor pago")]),a("th",[t._v("Técnico")])]),t._l(t.currentProformaTransactions,(function(e){return a("tr",{key:e.id,staticStyle:{"font-size":"9pt"}},[a("td",{directives:[{name:"date-format",rawName:"v-date-format",value:e.createdAt,expression:"transaction.createdAt"}]}),a("td",[t._v(t._s(e.paymentReference))]),a("td",[t._v(t._s(t.getPaymentMethod(e.paymentMethod)))]),a("td",[t._v(t._s(e.phoneNumber))]),a("td",{directives:[{name:"money-format",rawName:"v-money-format",value:e.amountPaid,expression:"transaction.amountPaid"}]}),a("td",[t._v(t._s(e.staffId))])])}))],2)]):t._e(),a("p",{staticClass:"text-left",staticStyle:{"font-size":"9pt"}},[a("b",[t._v("Técnico:")]),t._v(" "),a("em",[t._v(t._s(t.currentProforma.staffName))])])],1)],1)},qn=[],Wn="api/proformaPayment",Yn=function(){function t(){Object($["a"])(this,t)}return Object(A["a"])(t,null,[{key:"getAllProformaPayments",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(e,r){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get(Wn,{headers:{Authorization:a}});case 3:n=t.sent,s=n.data,e(s),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),r(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a){return t.apply(this,arguments)}}())}},{key:"getPaymentsById",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("".concat(Wn,"/").concat(t),{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"updatePaymentStatus",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put(Wn,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}},{key:"insertPayment",value:function(t,e){var a="Bearer "+e;return new Promise(function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(r,n){var s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.post(Wn,t,{headers:{Authorization:a}});case 3:s=e.sent,i=s.data,r(i),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),n(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}())}}]),t}(),Gn=Yn;gt.a.locale("pt-br"),Rt.a.vfs=St.a.pdfMake.vfs;var Hn=r["default"].extend({name:"QuotationPreview",props:["currentProforma"],data:function(){return{isLoading:!1,itemsList:[],productId:0,item:"",productName:0,price:0,quantity:1,total:0,vat:0,subTotalVat:0,dateOfQuote:"",customerName:"",customerPhoneNumber:"",customerAddress:"",customerNuit:"",termsAndConditions:"Todos os materiais e equipamentos fornecidos pela TSENANE, LDA observam os melhores padrões de qualidade, tem garantia de 12 meses contra defeito de fabrico e se a observarem as  recomendações  de Instalação e do transporte.",options:[{value:null,text:"Método de pagamento"},{value:2,text:"Depósito Bancário"},{value:3,text:"Transferência Bancária"},{value:4,text:"POS"},{value:5,text:"Cheque"},{value:6,text:"SISTAFE"},{value:7,text:"MPESA Open API"},{value:8,text:"E-Mola"}],paymentMethod:null,amount2Paid:0,paymentReference:"",currentProformaTransactions:[],paymentCleared:!1,saldoDevedor:0}},created:function(){this.populateDataInFields(),this.itemsList=JSON.parse(this.currentProforma.itemsDetails),this.processInvoiceYear(),this.dateOfQuote=gt()(this.currentProforma.createdAt).format("DD-MM-YYYY")},watch:{amount2Paid:function(){0!=this.amount2Paid.length&&this.saldoDevedorOperations()}},computed:Object(_["a"])({},Object(f["b"])(["user","token","currentUser","company"])),methods:{getProformaTransactions:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,Gn.getPaymentsById(t.currentProforma.invoiceId,t.token);case 4:a=e.sent,!0===a.success?(t.currentProformaTransactions=a.result,t.saldoDevedorOperations()):t.currentProformaTransactions=[],t.isLoading=!1,e.next=14;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log(e.t0),t.currentProformaTransactions=[],t.isLoading=!1;case 14:case"end":return e.stop()}}),e,null,[[1,9]])})))()},populateDataInFields:function(){this.customerName=this.currentProforma.customerName,this.customerPhoneNumber=this.currentProforma.customerPhoneNumber,this.customerAddress=this.currentProforma.customerAddress,this.customerNuit=this.currentProforma.customerNuit,this.getProformaTransactions()},processInvoiceYear:function(){var t=gt()(this.currentProforma.createdAt).year();this.vat=t<=2022?.17:.16},calculateSubTotal:function(){var t=this.itemsList.reduce((function(t,e){return t+e.quantity*e.price}),0);return this.subTotalVat=t*this.vat,t},saldoDevedorOperations:function(){var t=this.currentProformaTransactions.reduce((function(t,e){return t+e.amountPaid}),0),e=this.calculateSubTotal()*this.vat+this.calculateSubTotal();this.saldoDevedor=e-t-parseFloat(this.amount2Paid),this.paymentCleared=parseInt(this.saldoDevedor)<=0},getPaymentMethod:function(t){return 1==t?"Boca do Caixa":2==t?"Depósito Bancário":3==t?"Transferência Bancária":4==t?"POS":5==t?"Cheque":6==t?"SISTAFE":7==t?"M-Pesa Open API":8==t?"E-Mola":void 0},updateProformaStatus:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={status:!0===t.paymentCleared?1:-1,invoiceId:t.currentProforma.invoiceId},t.isLoading=!0,e.prev=2,e.next=5,Gn.updatePaymentStatus(a,t.token);case 5:r=e.sent,!0===r.success?(t.getAllProforma(),t.getProformaTransactions()):(console.log(r.message),t.isLoading=!1),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),console.log(e.t0.message),t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[2,9]])})))()},getAllProforma:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,kt.getAllProforma(t.token);case 4:a=e.sent,!0===a.success?(t.$store.commit("SET_PROFORMAS",a.result),t.isLoading=!1):(t.$bvToast.toast(a.message,{title:"Error!",variant:"info",solid:!0}),t.isLoading=!1,t.$store.commit("SET_PROFORMAS",[])),e.next=13;break;case 8:e.prev=8,e.t0=e["catch"](1),t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0}),t.$store.commit("SET_PROFORMAS",[]),t.isLoading=!1;case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))()},addPayment:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=t.paymentMethod){e.next=3;break}return t.$bvToast.toast("Seleccione o modo de pagamento por favor!",{title:"Aviso!",variant:"warning",solid:!0}),e.abrupt("return");case 3:if(!(t.amount2Paid<10)){e.next=6;break}return t.$bvToast.toast("Digite um montante válido",{title:"Aviso!",variant:"warning",solid:!0}),e.abrupt("return");case 6:if(!(t.paymentReference.length<=4)){e.next=9;break}return t.$bvToast.toast("Digite uma referência válida.",{title:"Aviso!",variant:"warning",solid:!0}),e.abrupt("return");case 9:return t.isLoading=!0,a={invoiceId:t.currentProforma.invoiceId,paymentMethod:t.paymentMethod,paymentReference:t.paymentReference,phoneNumber:"N/A",amountPaid:t.amount2Paid,staffId:t.user[0].name},e.prev=11,e.next=14,Gn.insertPayment(a,t.token);case 14:r=e.sent,!0===r.success?(t.$bvToast.toast(r.message,{title:"Sucesso!",variant:"success",solid:!0}),t.updateProformaStatus()):t.$bvToast.toast(r.message,{title:"Erro!",variant:"warning",solid:!0}),t.isLoading=!1,e.next=23;break;case 19:e.prev=19,e.t0=e["catch"](11),t.$bvToast.toast(e.t0.message,{title:"Erro!",variant:"danger",solid:!0}),t.isLoading=!1;case 23:case"end":return e.stop()}}),e,null,[[11,19]])})))()},processInvoiceId:function(t){var e=gt()(t.createdAt).year();return"".concat(t.invoiceId,"/SAAF/").concat(e)},saveProforma:function(){var t=this;return Object(g["a"])(regeneratorRuntime.mark((function e(){var a,r,n,s,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=[],r=Object(vt["a"])(t.itemsList);try{for(r.s();!(n=r.n()).done;)s=n.value,i=[],i.push({text:s.item,fontSize:9}),i.push({text:parseFloat(s.price).toFixed(2),fontSize:9,alignment:"right"}),i.push({text:s.quantity,fontSize:9,alignment:"right"}),i.push({text:s.quantity*s.price,fontSize:9,alignment:"right"}),a.push(i)}catch(c){r.e(c)}finally{r.f()}return e.next=5,t.getBase64ImageFromURL("https://saaf-tsenane.herokuapp.com/img/logo_12.2b7a27d2.jpeg");case 5:e.t0=e.sent,e.t1=[30,0,0,0],e.t2={image:e.t0,width:300,height:200,margin:e.t1},e.t3=[e.t2],e.t4={columns:[{text:"Documento processado por computador",alignment:"left",fontSize:8,margin:[30,0,0,0]},{text:"TSENANE Software",alignment:"right",fontSize:8,margin:[0,0,30,0]}]},e.t5=[{columns:[[{text:"Factura Proforma Nº: "+t.processInvoiceId(t.currentProforma),fontSize:10,bold:!0,alignment:"right"},{text:"\nData de emissão: ".concat(gt()(t.currentProforma.createdAt).format("DD-MM-YYYY")),fontSize:8,alignment:"right"},{text:"Validade da proposta: 14 dias",fontSize:8,alignment:"right"}]]},{text:"\n\n\n\n\n\n\n\n\n\n"},{text:"Exmo(s) Sr(s): ".concat(t.customerName),bold:!0,fontSize:12},{text:"Endereço: ".concat(t.customerAddress),style:"customerStyle"},{text:"Telefone: ".concat(t.customerPhoneNumber),style:"customerStyle"},{text:"NUIT: ".concat(t.customerNuit),style:"customerStyle"},{text:"\n\n"},{table:{widths:["*","auto","auto","auto"],body:[[{text:"Descrição do produto",style:"columnsTitle"},{text:"Preço unitário",style:"columnsTitle",alignment:"center"},{text:"Qtd",style:"columnsTitle",alignment:"center"},{text:"Subtotal",style:"columnsTitle",alignment:"right"}]].concat(a,[[{text:"\n\n\n\n\n\n\n",colSpan:4},{},{},{}],[{text:"Subtotal",colSpan:3,style:"columnsSubTotals"},{},{},{text:t.calculateSubTotal().toFixed(2),style:"columnsSubTotals",alignment:"right"}],[{text:"IVA - "+100*t.vat+"%",colSpan:3,style:"columnsSubTotals"},{},{},{text:(t.calculateSubTotal()*t.vat).toFixed(2),style:"columnsSubTotals",alignment:"right"}],[{text:"Total a pagar",colSpan:3,style:"columnsTotal"},{},{},{text:(t.calculateSubTotal()*t.vat+t.calculateSubTotal()).toFixed(2)+" MZN",style:"columnsTotal",alignment:"right"}]])},layout:"lightHorizontalLines"},{text:"\n"},{text:"Detalhes sobre meio de pagamentos:\n",style:"paymentMethodStyle"},{ul:[{text:"BANCO: BCI",fontSize:9},{text:"TITULAR: "+t.company[0].name,fontSize:9},{text:t.company[0].bankAccount2,fontSize:9},{text:t.company[0].nib2,fontSize:9}]},{text:"\n"},{text:"Termos comerciais da proposta:\n",style:"paymentMethodStyle"},{ul:[{text:t.termsAndConditions,fontSize:9,italics:"Courier-Oblique"},{text:"A empresa reserva-se o direito de efectuar o débito de juros caso este documento não seja liquidado até ao seu vencimento.",fontSize:9,alignment:"left",italics:"Courier-Oblique"}]}],e.t6={paymentMethodStyle:{bold:!0,fontSize:10},sectionHeader:{bold:!0,fontSize:10,margin:[0,15,0,15]},columnsTitle:{fontSize:10,bold:!0,color:"#000000"},columnsSubTotals:{fontSize:10,bold:!0,color:"#000000"},columnsTotal:{fontSize:12,bold:!0,color:"#000000"},companyDetailsStyle:{fontSize:9,bold:!0,color:"#000000"},customerStyle:{fontSize:10,bold:!1}},o={header:e.t3,footer:e.t4,content:e.t5,styles:e.t6},Rt.a.createPdf(o).open();case 14:case"end":return e.stop()}}),e)})))()},getBase64ImageFromURL:function(t){return new Promise((function(e,a){var r=new Image;r.setAttribute("crossOrigin","anonymous"),r.onload=function(){var t=document.createElement("canvas");t.width=r.width,t.height=r.height;var a=t.getContext("2d");a.drawImage(r,0,0);var n=t.toDataURL("image/png");e(n)},r.onerror=function(t){a(t)},r.src=t}))}}}),Qn=Hn,Zn=Object(u["a"])(Qn,Un,qn,!1,null,null,null),Jn=Zn.exports,Kn={name:"ProformaView",computed:Object(_["a"])({},Object(f["b"])(["user","token","proformas"])),created:function(){},components:{NavBar:pt,QuotationPreview:Jn},data:function(){return{isLoading:!1,currentProforma:{},vat:0}},methods:{processInvoiceYear:function(t){var e=gt()(t.createdAt).year();return"".concat(t.invoiceId,"/SAAF/").concat(e)},getProformaStatus:function(t){return 0==t?"Pendente":1==t?"Pago":-1==t?"Parcelado":void 0},previewProforma:function(t){this.currentProforma=t,this.$refs["preview-proforma"].show()},getTotalOfBill:function(t){var e=gt()(t.createdAt).year(),a=e<=2022?.17:.16,r=JSON.parse(t.itemsDetails),n=r.reduce((function(t,e){return t+e.quantity*e.price}),0),s=n*a+n;return s}}},Xn=Kn,ts=(a("d517"),Object(u["a"])(Xn,Vn,Fn,!1,null,"24c53793",null)),es=ts.exports;r["default"].use(p["a"]);var as=new p["a"]({mode:"history",routes:[{path:"/simulator",name:"Simulator",component:cr},{path:"/pre_registration",name:"PreRegistration",component:Za},{path:"/",name:"Login",component:nt},{path:"/register",name:"Register",component:function(){return a.e("register").then(a.bind(null,"73cf"))}},{path:"/dashboard",name:"Dashboard",component:Ht,meta:{requiresAuth:!0}},{path:"/relatorios",name:"Relatorios",component:Tn,meta:{requiresAuth:!0}},{path:"/settings",name:"Settings",component:Pe,meta:{requiresAuth:!0}},{path:"/customerview",name:"CustomerView",component:oa,meta:{requiresAuth:!0}},{path:"/support",name:"Support",component:qa,meta:{requiresAuth:!0}},{path:"/cashier",name:"Cashier",component:Ma,meta:{requiresAuth:!0}},{path:"/cashierview",name:"CashierNew",component:Ln,meta:{requiresAuth:!0}},{path:"/payments",name:"Payments",component:xr,meta:{requiresAuth:!0}},{path:"/profile",name:"Profile",component:fr,meta:{requiresAuth:!0}},{path:"/branch",name:"BranchPanel",component:zr,meta:{requiresAuth:!0}},{path:"/branchPanel",name:"BranchPanelNew",component:Wr,meta:{requiresAuth:!0}},{path:"/tarrifs",name:"Tarrifs",component:rn,meta:{requiresAuth:!0}},{path:"/products",name:"Products",component:pn,meta:{requiresAuth:!0}},{path:"/proforma",name:"Proforma",component:es,meta:{requiresAuth:!0}}]});as.beforeEach((function(t,e,a){t.matched.some((function(t){return t.meta.requiresAuth}))?b.state.user?a():a({path:"/",query:{redirect:t.fullPath}}):a()}));var rs=as;a("7e7d");r["default"].directive("money-format",(function(t,e){var a=e.value;t.innerHTML=new Intl.NumberFormat("pt-PT",{currency:"MZN",style:"currency",minimumFractionDigits:2}).format(a||0)})),r["default"].directive("date-format",(function(t,e){var a=e.value;t.innerHTML=gt()(a).format("DD/MM/YYYY [às] HH:mm:ss")}));var ns=a("d61f");r["default"].use(ns["a"]),r["default"].config.productionTip=!1,new r["default"]({i18n:T,router:rs,store:b,beforeCreate:function(){b.commit("initializeStore")},render:function(t){return t(m)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";a("9c0c")},"67a0":function(t,e,a){},7178:function(t,e,a){},"7c4f":function(t,e,a){},"7e7d":function(t,e,a){},"7f77":function(t,e,a){"use strict";a("8bfa")},"85c0":function(t,e,a){},"887d":function(t,e,a){"use strict";a("3fe1")},"8bfa":function(t,e,a){},"9c0c":function(t,e,a){},a91a:function(t,e,a){"use strict";a("0187")},ac2b:function(t,e,a){t.exports=a.p+"img/logo_12.2b7a27d2.jpeg"},ad07:function(t,e,a){},aef8:function(t,e,a){"use strict";a("7c4f")},b36a:function(t,e,a){},c303:function(t,e,a){"use strict";a("b36a")},c6f3:function(t,e,a){t.exports=a.p+"img/logo.ff6fa381.jpeg"},c86f:function(t,e,a){},cd5b:function(t,e,a){"use strict";a("1b91")},cee2:function(t,e,a){},cf84:function(t,e,a){},d517:function(t,e,a){"use strict";a("cf84")},d7a2:function(t,e,a){"use strict";a("1664")},e2c7:function(t,e,a){"use strict";a("ad07")},e8de:function(t,e,a){"use strict";a("7178")},ee63:function(t,e,a){},f714:function(t,e,a){"use strict";a("ee63")},fe25:function(t,e,a){"use strict";a("c86f")}});
//# sourceMappingURL=app.c7781b9d.js.map